import{a as _e}from"./chunk-ZMG4XZKB.js";import{a as we}from"./chunk-O7NFD47E.js";import"./chunk-OOMXTPNP.js";import{a as Te}from"./chunk-DPLKIUJQ.js";import{b as ge}from"./chunk-I6IL5RWO.js";import{a as he}from"./chunk-O3SRXZ6G.js";import{d as be,e as Ce,f as ve,g as Re}from"./chunk-7TNYY5WH.js";import{B as me,C as ce,E as de,r as le,u as ae,x as se,y as pe}from"./chunk-ZWE3YAKD.js";import"./chunk-24EOINCO.js";import{a as Se}from"./chunk-4EMWHUSH.js";import{c as z,d as J,e as Y}from"./chunk-PWXSQGX5.js";import{b as ue,c as fe}from"./chunk-BTRQCZZF.js";import{c as Z,d as $,k as ee,l as te}from"./chunk-CVJAGL52.js";import{m as M}from"./chunk-XJ7XG5EY.js";import{Ha as A,Ia as O,Ka as W,La as j,Ma as H,Na as V,Pa as q,Sa as U,Ta as K,Wa as Q,Xa as X,ob as ie,pb as oe,rb as re,sb as ne}from"./chunk-6GUNNAMA.js";import{$ as w,$a as T,Ab as m,Db as k,Jb as r,Kb as n,Lb as d,Pb as E,Rb as b,Sb as v,_a as l,bc as G,cc as g,dc as R,dd as P,ec as h,gc as x,hc as I,ic as L,kc as S,lb as B,mb as y,na as u,oa as f,sb as D,uc as a,vc as s,yc as C}from"./chunk-X5E3IHQQ.js";var xe=()=>["roleName"],Ie=()=>({"min-width":"75rem"}),Le=()=>[10,20,30],Pe=()=>({width:"450px"});function Ne(o,e){if(o&1){let t=E();r(0,"div",22)(1,"p-button",23),a(2,"translate"),b("onClick",function(){u(t);let c=v();return f(c.openNew())}),n(),r(3,"p-button",24),a(4,"translate"),b("onClick",function(){u(t);let c=v();return f(c.deleteSelectedRoles())}),n()()}if(o&2){let t=v();l(),m("label",s(2,3,"ADD")),l(2),m("label",s(4,5,"DELETE"))("disabled",!t.selectedRoles||!t.selectedRoles.length)}}function Fe(o,e){o&1&&(d(0,"p-button",25),a(1,"translate")),o&2&&m("label",s(1,1,"EXPORT"))}function De(o,e){if(o&1){let t=E();r(0,"div",26)(1,"h5",27),g(2),a(3,"translate"),n(),r(4,"p-iconfield"),d(5,"p-inputicon",28),r(6,"input",29),a(7,"translate"),b("input",function(c){u(t);let _=v(),p=G(6);return f(_.onGlobalFilter(p,c))}),n()()()}o&2&&(l(2),R(s(3,2,"ROLES")),l(4),m("placeholder",s(7,4,"SEARCH_PACEHOLDER")))}function Me(o,e){o&1&&(r(0,"tr")(1,"th",30),d(2,"p-tableHeaderCheckbox"),n(),r(3,"th",31),g(4),a(5,"translate"),d(6,"p-sortIcon",32),n(),r(7,"th",33),g(8),a(9,"translate"),d(10,"p-sortIcon",34),n()()),o&2&&(l(4),h(" ",s(5,2,"TITLE")," "),l(4),h(" ",s(9,4,"DESCRIPTION")," "))}function Ve(o,e){if(o&1&&(r(0,"tr")(1,"td",30),d(2,"p-tableCheckbox",35),n(),r(3,"td"),g(4),n(),r(5,"td"),g(6),n()()),o&2){let t=e.$implicit;l(2),m("value",t),l(2),h(" ",t.roleName," "),l(2),h(" ",t.description," ")}}var N=class o{constructor(e,t,i){this.roleService=e;this.toast=t;this.translate=i}roleDialog=!1;dialogHeader="Create Role";loading=!1;saveLoading=!1;pageReq=new he(0,10);pageDetails;roleList=[];role;selectedRoles;cols;roleForm;permList=[];selectedPerms=[];mode;ngOnInit(){this.getRoles(),this.getPermissions(),this.initRoleForm()}getRoles(){this.roleService.getAllRoles().subscribe(e=>{e.success&&(this.roleList=e.data)})}getPermissions(){this.roleService.getPermissionGroups().subscribe(e=>{e.success&&(this.permList=this.mapPermissionsToTreeData(e.data))})}initRoleForm(){this.roleForm=new H({roleName:new V(null,[O.required]),description:new V(null)})}onSaveRole(){if(this.saveLoading=!0,this.roleForm.invalid){this.toast.showWarn(this.translate.instant("REQUIRED_FIELDS_MSG"));return}this.roleService.createRole({roleName:this.roleForm.value.roleName,description:this.roleForm.value.description,permissionsIDs:this.selectedPerms.filter(e=>e.data!="group").map(e=>e.data)}).subscribe(e=>{e.success?(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.getRoles(),this.roleForm.reset(),this.selectedPerms=[],this.roleDialog=!1):this.toast.showError(e.message),this.saveLoading=!1})}mapPermissionsToTreeData(e){return e.map(t=>({label:this.translate.instant(t.group),data:"group",children:t.permissions.map(i=>({label:this.translate.instant(i.permName),data:i.permId,expanded:!1}))}))}openNew(){this.roleDialog=!0}deleteSelectedRoles(){}onGlobalFilter(e,t){e.filterGlobal(t.target.value,"contains")}static \u0275fac=function(t){return new(t||o)(T(Te),T(Se),T(z))};static \u0275cmp=B({type:o,selectors:[["app-role-list"]],decls:37,vars:40,consts:[["start",""],["end",""],["dt",""],["caption",""],["header",""],["body",""],["styleClass","mb-6"],["dataKey","roleId","paginator","true","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} roles",3,"selectionChange","value","rows","columns","loading","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","rowsPerPageOptions"],[3,"visibleChange","visible","header","modal"],[3,"ngSubmit","formGroup"],[1,"flex","items-center","gap-4","mb-4"],["for","roleName",1,"font-semibold","w-24"],["formControlName","roleName","pInputText","","id","roleName","autocomplete","off",1,"flex-auto"],[1,"flex","items-center","gap-4","mb-6"],["for","description",1,"font-semibold","w-24"],["formControlName","description","pInputText","","id","description","autocomplete","off",1,"flex-auto"],[1,"mb-4"],[1,"font-semibold","w-24"],["selectionMode","checkbox","styleClass","w-full md:w-[30rem]",3,"selectionChange","value","selection"],[1,"flex","justify-end","gap-2"],["severity","secondary",3,"click","label"],["type","submit",3,"label","loading"],[1,"flex","items-center","gap-2"],["icon","pi pi-plus","severity","secondary",1,"mr-2",3,"onClick","label"],["severity","secondary","icon","pi pi-trash","outlined","",3,"onClick","label","disabled"],["icon","pi pi-upload","severity","secondary",3,"label"],[1,"flex","items-center","justify-between"],[1,"m-0"],["styleClass","pi pi-search"],["pInputText","","type","text",3,"input","placeholder"],[2,"width","3rem"],["pSortableColumn","roleName"],["field","roleName"],["pSortableColumn","description"],["field","description"],[3,"value"]],template:function(t,i){if(t&1){let c=E();r(0,"p-toolbar",6),D(1,Ne,5,7,"ng-template",null,0,C)(3,Fe,2,3,"ng-template",null,1,C),n(),r(5,"p-table",7,2),L("selectionChange",function(p){return u(c),I(i.selectedRoles,p)||(i.selectedRoles=p),f(p)}),D(7,De,8,6,"ng-template",null,3,C)(9,Me,11,6,"ng-template",null,4,C)(11,Ve,7,3,"ng-template",null,5,C),n(),r(13,"p-dialog",8),a(14,"translate"),L("visibleChange",function(p){return u(c),I(i.roleDialog,p)||(i.roleDialog=p),f(p)}),r(15,"form",9),b("ngSubmit",function(){return u(c),f(i.onSaveRole())}),r(16,"div",10)(17,"label",11),g(18),a(19,"translate"),n(),d(20,"input",12),n(),r(21,"div",13)(22,"label",14),g(23),a(24,"translate"),n(),d(25,"input",15),n(),r(26,"div",16)(27,"label",17),g(28),a(29,"translate"),n(),r(30,"p-tree",18),L("selectionChange",function(p){return u(c),I(i.selectedPerms,p)||(i.selectedPerms=p),f(p)}),n()(),r(31,"div",19)(32,"p-button",20),a(33,"translate"),b("click",function(){return u(c),f(i.roleDialog=!1)}),n(),d(34,"p-button",21),a(35,"translate"),n()()(),d(36,"p-toast")}t&2&&(l(5),m("value",i.roleList)("rows",10)("columns",i.cols)("loading",i.loading)("globalFilterFields",S(36,xe))("tableStyle",S(37,Ie)),x("selection",i.selectedRoles),m("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",S(38,Le)),l(8),k(S(39,Pe)),x("visible",i.roleDialog),m("header",s(14,24,"ADD_ROLE"))("modal",!0),l(2),m("formGroup",i.roleForm),l(3),R(s(19,26,"TITLE")),l(5),R(s(24,28,"DESCRIPTION")),l(5),R(s(29,30,"PERMISSIONS")),l(2),m("value",i.permList),x("selection",i.selectedPerms),l(2),m("label",s(33,32,"CANCEL")),l(2),m("label",s(35,34,"SAVE"))("loading",i.saveLoading))},dependencies:[P,de,ae,se,pe,me,ce,Q,q,A,W,j,X,U,K,ne,re,fe,ue,Ce,be,oe,ie,ge,Re,ve,te,ee,$,Z,Y,J,le,_e],encapsulation:2})};var Be=[{path:"",component:N,canActivate:[we],data:{perms:["perm.access.role"]}}],F=class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=y({type:o});static \u0275inj=w({imports:[M.forChild(Be),M]})};var Ee=class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=y({type:o});static \u0275inj=w({imports:[P,F]})};export{Ee as RolesModule};
