import{a as oe,b as ce,c as pe,d as se,e as de}from"./chunk-LZG6A5QF.js";import{a as Ne}from"./chunk-MN5LVCU7.js";import{a as be}from"./chunk-DFQMA4IP.js";import{a as Ve}from"./chunk-AMELEMFQ.js";import{a as ae}from"./chunk-BGLM7VYL.js";import{a as P}from"./chunk-DLZLUNEY.js";import{a as ee}from"./chunk-LV7F5CKA.js";import"./chunk-DANA6GBI.js";import{a as z,c as Y,d as Z,e as J}from"./chunk-TGB364TN.js";import{a as ne}from"./chunk-FB455MTE.js";import"./chunk-N474PGLI.js";import{b as re}from"./chunk-7G2FJQ27.js";import{a as Re}from"./chunk-2ZAHAWY3.js";import{c as ie}from"./chunk-E2WTBZXM.js";import{a as De,c as K,h as X,m as ke}from"./chunk-XBK3DIBG.js";import{m as _e}from"./chunk-RL6IEZWP.js";import{Ia as L,Ja as j,La as Q,Ma as Ie,Pa as W,Qa as Ee,Ta as Me,Ua as Pe,Wa as Te,Xa as H,Ya as G,b as q,ob as $,rb as te}from"./chunk-AQJP2JMO.js";import{Db as n,Eb as o,Fb as f,Jb as h,Lb as C,Mb as u,Pa as V,Pc as we,Qc as O,Sb as Se,Tb as ye,U as D,Ua as i,Ub as Be,V as k,Va as x,Xb as U,Yb as s,Z as R,Zb as g,Zc as M,_b as b,ac as y,bc as B,cc as w,ec as I,fb as N,gb as A,ha as v,ia as _,ja as he,ka as Ce,mb as S,oc as l,pc as m,sc as F,ub as p,xb as E}from"./chunk-HRECHPDI.js";import"./chunk-EQDQRRRY.js";var He=()=>["code_128","ean","upc"],Ge=()=>({width:"100%"});function ze(r,t){if(r&1){let e=h();n(0,"div",7),s(1),l(2,"translate"),o(),n(3,"div",8)(4,"p-iconfield"),f(5,"p-inputicon",9),n(6,"input",10,1),l(8,"translate"),C("keydown.enter",function(){v(e);let a=U(7),d=u();return _(d.onSearch(a.value))}),w("ngModelChange",function(a){v(e);let d=u();return B(d.barcode,a)||(d.barcode=a),_(a)}),o()()()}if(r&2){let e=u();i(),b(" ",m(2,3,"PRICE_AND_QUANTITY_UPDATE")," "),i(5),p("placeholder",m(8,5,"SEARCH_PACEHOLDER")),y("ngModel",e.barcode)}}function Ye(r,t){r&1&&(n(0,"div")(1,"div",11),he(),n(2,"svg",12)(3,"g",13),f(4,"path",14)(5,"path",15),o()()(),Ce(),n(6,"p",16),s(7),l(8,"translate"),o()()),r&2&&(i(7),g(m(8,1,"SCAN_BARCODE_SEARCH_HINT")))}function Ze(r,t){if(r&1&&(n(0,"div",32),f(1,"i",33),n(2,"span"),s(3),o()()),r&2){let e=u(2);i(3),g(e.product.basicDetails.productCategory.name)}}function Je(r,t){if(r&1&&(n(0,"div",32),f(1,"i",34),n(2,"span"),s(3),o()()),r&2){let e=u(2);i(3),g(e.product.basicDetails.productBrand.name)}}function Ke(r,t){if(r&1&&(n(0,"div",32),f(1,"i",35),n(2,"span"),s(3),o()()),r&2){let e=u(2);i(3),g(e.product.basicDetails.unitOfMeasure.name)}}function Xe(r,t){if(r&1&&(n(0,"div",17)(1,"div",18)(2,"div",19),f(3,"div",20),n(4,"div",21),s(5),o(),n(6,"div",22),S(7,Ze,4,1,"div",23)(8,Je,4,1,"div",23)(9,Ke,4,1,"div",23),o(),n(10,"div",24)(11,"span"),s(12),l(13,"translate"),o(),f(14,"p-tag",25),o(),n(15,"div",24)(16,"span"),s(17),l(18,"translate"),o(),n(19,"span"),s(20),l(21,"sCurrency"),o()(),n(22,"div",24)(23,"span"),s(24),l(25,"translate"),o(),n(26,"span"),s(27),l(28,"sCurrency"),o()(),n(29,"div",26),f(30,"span",27),n(31,"span"),s(32),o()(),n(33,"div",28),f(34,"ngx-barcode6",29),o()(),n(35,"div",30),f(36,"img",31),o()()()),r&2){let e=u();i(5),b(" ",e.product.basicDetails.productName," "),i(2),p("ngIf",e.product.basicDetails.productCategory),i(),p("ngIf",e.product.basicDetails.productBrand),i(),p("ngIf",e.product.basicDetails.unitOfMeasure),i(3),b("",m(13,17,"QUANTITY"),":"),i(2),p("value",e.product.basicDetails.quantity+"")("severity",e.getQuantitySeverity()),i(3),b("",m(18,19,"COST"),":"),i(3),g(m(21,21,e.product.priceDetails.costPrice)),i(4),b("",m(25,23,"PRICE"),":"),i(3),g(m(28,25,e.product.priceDetails.sellingPrice)),i(5),g(e.product.basicDetails.barcode),i(2),p("bc-width",2)("bc-height",30)("bc-format","CODE128")("bc-value",e.product.basicDetails.barcode),i(2),p("src",e.getPrimaryImageSrc(e.product),V)}}function $e(r,t){if(r&1){let e=h();n(0,"form",36)(1,"div",37)(2,"div",38)(3,"label",39),s(4),l(5,"translate"),o(),f(6,"p-inputnumber",40),o(),n(7,"div",38)(8,"label",41),s(9),l(10,"translate"),o(),f(11,"p-inputnumber",42),o(),n(12,"div",38)(13,"label",43),s(14),l(15,"translate"),o(),f(16,"p-inputnumber",44),o()(),n(17,"div",45)(18,"p-button",46),l(19,"translate"),C("onClick",function(){v(e);let a=u();return _(a.save())}),o()()()}if(r&2){let e=u();p("formGroup",e.form),i(4),g(m(5,8,"COST")),i(5),g(m(10,10,"SELLING_PRICE")),i(5),g(m(15,12,"QUANTITY")),i(4),E(I(16,Ge)),p("loading",e.saveLoading)("label",m(19,14,"SAVE"))}}var le=class r{constructor(t,e,c,a){this.productService=t;this.translate=e;this.formBuilder=c;this.toast=a}loading=!1;saveLoading=!1;product;barcode;form;barcodeScanner;ngOnInit(){this.form=this.formBuilder.group({cost:[null,j.required],price:[null,j.required],quantity:[null,j.required]})}ngAfterViewInit(){}onScanBarcodeChanges(t){if(this.loading)return;this.loading=!0;let e=t.codeResult.code.trim();this.findProductByBarcode(e)}findProductByBarcode(t){this.productService.getProductByBarcode(t).subscribe(e=>{e.success?(this.product=e.data,this.form.patchValue({cost:this.product.priceDetails.costPrice,price:this.product.priceDetails.sellingPrice,quantity:this.product.basicDetails.quantity})):(this.toast.showError(this.translate.instant("PRODUCT_NOT_FOUND")),this.loading=!1)})}onSearch(t){!t||!t.length||this.findProductByBarcode(t)}getQuantitySeverity(){return P.getQuantitySeverity(this.product)}getPrimaryImageSrc(t){return P.getFirstImageSrc(t)}save(){if(this.saveLoading=!0,!this.form.valid||!this.product){this.toast.showWarn(this.translate.instant("REQUIRED_FIELDS_MSG"));return}this.productService.updateProductStock({productId:this.product.productId,quantity:this.form.value.quantity,cost:this.form.value.cost,price:this.form.value.price}).subscribe(t=>{t.success?(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.findProductByBarcode(this.product.basicDetails.barcode)):this.toast.showError(t.message),this.saveLoading=!1})}static \u0275fac=function(e){return new(e||r)(x(oe),x(Y),x(Te),x(ae))};static \u0275cmp=N({type:r,selectors:[["app-quick-stock-update"]],viewQuery:function(e,c){if(e&1&&Se(ce,5),e&2){let a;ye(a=Be())&&(c.barcodeScanner=a.first)}},decls:8,vars:5,consts:[["header",""],["barcodeIn",""],["styleClass","p-4"],[4,"ngIf"],["class","product-details w-full mb-4",4,"ngIf"],[3,"formGroup",4,"ngIf"],[3,"valueChanges","type"],[1,"mb-4","font-bold","text-xl"],[1,"mb-4","w-full","flex","justify-center"],["styleClass","pi pi-barcode"],["pInputText","","id","barcode","type","text","autofocus","",3,"keydown.enter","ngModelChange","placeholder","ngModel"],[1,"flex","w-full","justify-center","text-muted-color"],["xmlns","http://www.w3.org/2000/svg","width","12em","height","12em","viewBox","0 0 256 256"],["fill","currentColor"],["d","M224 48v160H32V48Z","opacity","0.2"],["d","M232 48v40a8 8 0 0 1-16 0V56h-32a8 8 0 0 1 0-16h40a8 8 0 0 1 8 8M72 200H40v-32a8 8 0 0 0-16 0v40a8 8 0 0 0 8 8h40a8 8 0 0 0 0-16m152-40a8 8 0 0 0-8 8v32h-32a8 8 0 0 0 0 16h40a8 8 0 0 0 8-8v-40a8 8 0 0 0-8-8M32 96a8 8 0 0 0 8-8V56h32a8 8 0 0 0 0-16H32a8 8 0 0 0-8 8v40a8 8 0 0 0 8 8m48-16a8 8 0 0 0-8 8v80a8 8 0 0 0 16 0V88a8 8 0 0 0-8-8m104 88V88a8 8 0 0 0-16 0v80a8 8 0 0 0 16 0m-40-88a8 8 0 0 0-8 8v80a8 8 0 0 0 16 0V88a8 8 0 0 0-8-8m-32 0a8 8 0 0 0-8 8v80a8 8 0 0 0 16 0V88a8 8 0 0 0-8-8"],[1,"w-full","text-center","text-muted-color"],[1,"product-details","w-full","mb-4"],[1,"flex","gap-4"],[1,"basic",2,"width","50%"],[1,"actions","flex","items-center","justify-between"],[1,"text-lg","font-bold"],[1,"flex","gap-6","mb-4"],["class","ml-2 text-surface-500 text-sm flex gap-2 items-center",4,"ngIf"],[1,"flex","gap-2","items-center","mb-2"],[3,"value","severity"],[1,"flex","gap-2","items-center","mb-2","mt-6"],[1,"pi","pi-barcode"],[1,"barcode"],[3,"bc-width","bc-height","bc-format","bc-value"],[1,"image-slider",2,"width","50%"],["width","50%","alt","",1,"rounded",3,"src"],[1,"ml-2","text-surface-500","text-sm","flex","gap-2","items-center"],[1,"pi","pi-clone"],[1,"pi","pi-tags"],[1,"pi","pi-gauge"],[3,"formGroup"],[1,"flex","flex-col","md:flex-row","gap-6","mb-4"],[1,"flex","flex-wrap","gap-2","w-full"],["for","costPrice"],["id","costPrice","formControlName","cost","mode","currency","currency","USD","showButtons",""],["for","sellingPrice"],["id","sellingPrice","formControlName","price","mode","currency","currency","USD","showButtons",""],["for","quantity"],["autofocus","true","id","quantity","formControlName","quantity","mode","decimal","showButtons",""],[1,"flex","justify-center","w-full"],["type","submit",3,"onClick","loading","label"]],template:function(e,c){if(e&1){let a=h();n(0,"p-card",2),S(1,ze,9,7,"ng-template",null,0,F)(3,Ye,9,3,"div",3)(4,Xe,37,27,"div",4)(5,$e,20,17,"form",5),o(),f(6,"p-toast"),n(7,"barcode-scanner-livestream",6),C("valueChanges",function(xe){return v(a),_(c.onScanBarcodeChanges(xe))}),o()}e&2&&(i(3),p("ngIf",!c.product),i(),p("ngIf",c.product&&!c.loading),i(),p("ngIf",c.product&&c.form),i(2),p("type",I(4,He)))},dependencies:[M,O,H,Ee,L,Q,Ie,W,G,Me,Pe,X,$,K,ie,te,ne,Re,re,J,Z,pe,ce,de,se,ee],encapsulation:2})};var me=class{printer;barcodes;barcodeFormat;copies;size;constructor(){this.barcodes=[],this.barcodeFormat="CODE_128",this.copies=1,this.size=100}};var ue=class r{constructor(t){this.http=t}baseUrl=z.apiBaseUrl+"/printer";getAllPrinters(){return this.http.get(`${this.baseUrl}`)}static \u0275fac=function(e){return new(e||r)(R(q))};static \u0275prov=D({token:r,factory:r.\u0275fac,providedIn:"root"})};var fe=class r{constructor(t){this.http=t}baseUrl=z.apiBaseUrl+"/barcode";getBarcodeFormats(){return this.http.get(`${this.baseUrl}/format`)}printBarcode(t){return this.http.post(`${this.baseUrl}/print`,t)}static \u0275fac=function(e){return new(e||r)(R(q))};static \u0275prov=D({token:r,factory:r.\u0275fac,providedIn:"root"})};var rt=()=>({width:"450px"}),Ae=()=>({width:"50%"}),nt=()=>({width:"100%"});function ot(r,t){if(r&1){let e=h();n(0,"div",8),s(1),l(2,"translate"),o(),n(3,"div",9),f(4,"i",10),s(5),l(6,"translate"),o(),n(7,"div",11)(8,"p-iconfield"),f(9,"p-inputicon",12),n(10,"input",13,1),l(12,"translate"),C("keydown.enter",function(){v(e);let a=U(11),d=u();return _(d.onSearch(a.value))}),w("ngModelChange",function(a){v(e);let d=u();return B(d.barcode,a)||(d.barcode=a),_(a)}),o()()()}if(r&2){let e=u();i(),b(" ",m(2,4,"BARCODE_PRINTING")," "),i(4),b(" ",m(6,6,"SCAN_ADD_BARCODE_HINT"),""),i(5),p("placeholder",m(12,8,"SEARCH_PACEHOLDER")),y("ngModel",e.barcode)}}function at(r,t){if(r&1){let e=h();n(0,"p-button",14),l(1,"translate"),C("onClick",function(){v(e);let a=u();return _(a.removeAll())}),o()}r&2&&p("label",m(1,2,"REMOVE_ALL"))("text",!0)}function ct(r,t){if(r&1){let e=h();n(0,"div",15),f(1,"img",16),n(2,"div",17)(3,"div",18)(4,"div",19),s(5),o(),n(6,"span",20),s(7),l(8,"sCurrency"),o()()(),n(9,"div",21)(10,"div",20),s(11),o(),f(12,"ngx-barcode6",22),o(),n(13,"p-button",23),C("onClick",function(){let a=v(e).$implicit,d=u();return _(d.removeItem(a))}),o()()}if(r&2){let e=t.$implicit,c=u();i(),p("src",c.getProductImageSrc(e),V)("alt",e.basicDetails.productName),i(3),p("pTooltip",e.basicDetails.productName),i(),b(" ",e.basicDetails.productName," "),i(2),g(m(8,12,e.priceDetails.priceWithDiscount)),i(4),b(" ",e.basicDetails.barcode," "),i(),p("bc-width",2)("bc-height",30)("bc-format","CODE128")("bc-value",e.basicDetails.barcode),i(),p("rounded",!0)("text",!0)}}function pt(r,t){if(r&1){let e=h();n(0,"div",15)(1,"div",17),s(2),l(3,"translate"),o(),n(4,"div",21)(5,"div",20),s(6),o(),f(7,"ngx-barcode6",22),o(),n(8,"p-button",23),C("onClick",function(){let a=v(e).$implicit,d=u();return _(d.removeCustomBarcode(a))}),o()()}if(r&2){let e=t.$implicit;i(2),b(" ",m(3,8,"CUSTOM_BARCODE")," "),i(4),b(" ",e," "),i(),p("bc-width",2)("bc-height",30)("bc-format","CODE128")("bc-value",e),i(),p("rounded",!0)("text",!0)}}function st(r,t){if(r&1){let e=h();n(0,"div",24)(1,"div",25)(2,"label",26),s(3),l(4,"translate"),o(),n(5,"p-select",27),w("ngModelChange",function(a){v(e);let d=u();return B(d.printReq.printer,a)||(d.printReq.printer=a),_(a)}),o()(),n(6,"div",25)(7,"label",28),s(8),l(9,"translate"),o(),n(10,"p-select",29),w("ngModelChange",function(a){v(e);let d=u();return B(d.printReq.barcodeFormat,a)||(d.printReq.barcodeFormat=a),_(a)}),o()(),n(11,"div",25)(12,"label",30),s(13),l(14,"translate"),o(),n(15,"p-inputnumber",31),w("ngModelChange",function(a){v(e);let d=u();return B(d.printReq.size,a)||(d.printReq.size=a),_(a)}),o()(),n(16,"div",25)(17,"label",32),s(18),l(19,"translate"),o(),n(20,"p-inputnumber",33),w("ngModelChange",function(a){v(e);let d=u();return B(d.printReq.copies,a)||(d.printReq.copies=a),_(a)}),o()(),n(21,"p-button",34),l(22,"translate"),C("onClick",function(){v(e);let a=u();return _(a.printBarcodes())}),o()()}if(r&2){let e=u();i(3),g(m(4,23,"SELECT_PRINTER")),i(2),E(I(33,Ae)),p("options",e.printers),y("ngModel",e.printReq.printer),i(3),g(m(9,25,"BARCODE_TYPE")),i(2),E(I(34,Ae)),p("options",e.formats),y("ngModel",e.printReq.barcodeFormat),i(3),g(m(14,27,"BARCODE_SIZE")),i(2),p("allowEmpty",!1)("min",100)("max",500),y("ngModel",e.printReq.size),i(3),g(m(19,29,"COPIES_COUNT")),i(2),p("allowEmpty",!1)("min",1),y("ngModel",e.printReq.copies),i(),E(I(35,nt)),p("loading",e.saveLoading)("label",m(22,31,"PRINT"))}}var ge=class r{constructor(t,e,c,a,d,xe){this.productService=t;this.translate=e;this.printService=c;this.barcodeService=a;this.toast=d;this.confirm=xe}loading=!1;saveLoading=!1;products=[];customBarcodes=[];barcode;printers=[];formats=[];printReq=new me;ngOnInit(){this.getPrinters(),this.getBarcodeFormats()}getPrinters(){this.printService.getAllPrinters().subscribe(t=>this.printers=t)}getBarcodeFormats(){this.barcodeService.getBarcodeFormats().subscribe(t=>this.formats=t)}findProductByBarcode(t){this.loading=!0,this.productService.getProductByBarcode(t).subscribe(e=>{if(e.success)this.addProduct(e.data),this.barcode="";else{let c=this.translate.instant("PRINT_CUSTOM_BARCODE_ALERT");this.confirm.dialogAlert(c,()=>{this.addCustomBarcode(t)})}this.loading=!1})}addProduct(t){this.products.some(c=>c.productId===t.productId)?this.toast.showWarn(this.translate.instant("BARCODE_ALREADEY_ADDED")):this.products.push(t)}addCustomBarcode(t){this.customBarcodes.some(c=>c===t)?this.toast.showWarn(this.translate.instant("BARCODE_ALREADEY_ADDED")):this.customBarcodes.push(t)}onSearch(t){!t||!t.length||this.findProductByBarcode(t)}getProductImageSrc(t){return P.getFirstImageSrc(t)}removeItem(t){this.products=this.products.filter(e=>e.productId!==t.productId)}removeCustomBarcode(t){this.customBarcodes=this.customBarcodes.filter(e=>e!==t)}printBarcodes(){this.saveLoading=!0,this.printReq.barcodes=[...this.products.map(t=>t.basicDetails.barcode),...this.customBarcodes],console.log(this.printReq),this.barcodeService.printBarcode(this.printReq).subscribe(t=>{t.success?this.toast.showSuccess(this.translate.instant("PRINT_SUCCESS")):this.toast.showError(t.message),this.saveLoading=!1},t=>{this.toast.showError(t.error?.message),this.saveLoading=!1})}removeAll(){this.products=[],this.customBarcodes=[]}static \u0275fac=function(e){return new(e||r)(x(oe),x(Y),x(ue),x(fe),x(ae),x(Ne))};static \u0275cmp=N({type:r,selectors:[["app-manage-barcode"]],decls:11,vars:7,consts:[["header",""],["barcodeIn",""],["styleClass","p-4"],[1,"mb-4"],[1,"flex","justify-end","mb-4"],["severity","danger","icon","pi pi-times","class","mr-2",3,"label","text","onClick",4,"ngIf"],["class","mb-4 flex gap-4 items-center justify-between",4,"ngFor","ngForOf"],["class","print-options mb-4",4,"ngIf"],[1,"mb-4","font-bold","text-xl"],[1,"text-muted-color","mb-2"],[1,"pi","pi-lightbulb"],[1,"mb-4","w-full","flex","justify-center"],["styleClass","pi pi-barcode"],["pInputText","","id","barcode","type","text","autofocus","",3,"keydown.enter","ngModelChange","placeholder","ngModel"],["severity","danger","icon","pi pi-times",1,"mr-2",3,"onClick","label","text"],[1,"mb-4","flex","gap-4","items-center","justify-between"],[1,"rounded","w-full",2,"width","4rem","height","4rem","object-fit","cover",3,"src","alt"],[1,"flex","items-center","gap-2","w-full"],[1,"flex","flex-col"],["tooltipPosition","top",1,"mb-2","text-max-lines-1",2,"width","12rem",3,"pTooltip"],[1,"text-primary"],[1,"barcode","flex","gap-2","items-center"],[3,"bc-width","bc-height","bc-format","bc-value"],["icon","pi pi-times","severity","danger",3,"onClick","rounded","text"],[1,"print-options","mb-4"],[1,"mb-4","flex","items-center","gap-2"],["for","printer"],["id","printer","optionLabel","name","optionValue","name",3,"ngModelChange","options","ngModel"],["for","format"],["id","format",3,"ngModelChange","options","ngModel"],["for","size"],["id","size","showButtons","","mode","decimal",3,"ngModelChange","allowEmpty","min","max","ngModel"],["for","count"],["id","count","showButtons","","mode","decimal",3,"ngModelChange","allowEmpty","min","ngModel"],["type","submit",3,"onClick","loading","label"]],template:function(e,c){e&1&&(n(0,"p-card",2),S(1,ot,13,10,"ng-template",null,0,F),n(3,"div",3)(4,"div",4),S(5,at,2,4,"p-button",5),o(),S(6,ct,14,14,"div",6)(7,pt,9,10,"div",6),o(),S(8,st,23,36,"div",7),o(),f(9,"p-toast")(10,"p-confirmdialog")),e&2&&(i(5),p("ngIf",c.products.length||c.customBarcodes.length),i(),p("ngForOf",c.products),i(),p("ngForOf",c.customBarcodes),i(),p("ngIf",c.products.length||c.customBarcodes.length),i(2),E(I(6,rt)))},dependencies:[M,we,O,H,L,Q,W,G,X,$,ie,K,ke,De,te,ne,re,Ve,J,Z,pe,de,se,ee],encapsulation:2})};var dt=[{path:"stock-update",component:le,canActivate:[be],data:{perms:[]}},{path:"manage-barcode",component:ge,canActivate:[be],data:{perms:[]}}],ve=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=A({type:r});static \u0275inj=k({imports:[_e.forChild(dt),_e]})};var Ue=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=A({type:r});static \u0275inj=k({imports:[M,ve]})};export{Ue as StockModule};
