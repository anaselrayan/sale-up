import{a as Et}from"./chunk-UKK2UNCZ.js";import{a as Wt,b as Qt,c as lt,d as pt,e as Kt}from"./chunk-YD3HRO6W.js";import{b as $t}from"./chunk-W3IRUMQY.js";import{a as pe,b as Ue,c as ct,d as dt,e as Jt,f as Zt}from"./chunk-WBSWCOYN.js";import{a as U,b as ot}from"./chunk-G4FF2B5M.js";import{a as tt}from"./chunk-FMMZUCLX.js";import{a as Me,b as st}from"./chunk-TOUITQG2.js";import{a as At}from"./chunk-FLAFVX6E.js";import{a as Be,b as Ht}from"./chunk-BRBYF4VY.js";import{a as ce}from"./chunk-O7NFD47E.js";import"./chunk-OOMXTPNP.js";import{a as zt,b as Yt}from"./chunk-TDCQJO2P.js";import"./chunk-APHUFVIH.js";import{a as at,b as le}from"./chunk-I6IL5RWO.js";import{a as Ie}from"./chunk-O3SRXZ6G.js";import{a as xe,b as Xt}from"./chunk-LM2R7CUP.js";import{d as Ce,e as he,f as Se,g as ye}from"./chunk-7TNYY5WH.js";import{B as ve,C as be,E as ae,m as jt,o as it,p as rt,q as qt,r as nt,t as Gt,u as fe,x as ge,y as _e}from"./chunk-ZWE3YAKD.js";import{a as kt}from"./chunk-24EOINCO.js";import{e as Fe,f as Re}from"./chunk-HSP7W57C.js";import{a as z}from"./chunk-4EMWHUSH.js";import{a as re,c as D,d as B,e as F}from"./chunk-PWXSQGX5.js";import{b as Q,c as $}from"./chunk-BTRQCZZF.js";import{a as Je,c as j,d as ne,k as q,l as oe,p as Ze,q as et}from"./chunk-CVJAGL52.js";import{e as Ke,g as Te,h as Vt,m as je}from"./chunk-XJ7XG5EY.js";import{Ha as X,Ia as w,Ka as A,La as J,Ma as De,Na as se,Oa as Ot,Pa as Z,Sa as ee,Ta as te,Va as Xe,Wa as T,Xa as ie,_a as Nt,b as ue,ob as G,pb as H,rb as M,sb as W}from"./chunk-6GUNNAMA.js";import{$ as Qe,$a as h,Ab as s,Db as Y,Jb as r,Kb as i,Lb as m,Pb as I,Rb as b,Sb as f,Uc as Ut,Va as L,Vc as Lt,Wc as we,Yb as Ne,Zb as ke,_ as de,_a as n,_b as Ae,bc as K,cc as d,da as me,dc as g,dd as R,ec as S,fc as Rt,gc as V,hc as O,ic as N,jc as Mt,kc as P,lb as E,lc as ze,mb as $e,na as _,oa as v,sb as x,uc as l,vc as p,wa as Pt,wc as Ye,yc as y}from"./chunk-X5E3IHQQ.js";var mt=class{productId;discountActive;discountType;discountAmount;discountStartDate;discountEndDate};var si=()=>({width:"40rem"}),ci=()=>({width:"100%"});function di(o,e){if(o&1&&(r(0,"div",15)(1,"div",16),d(2),l(3,"translate"),i(),r(4,"span"),d(5),l(6,"substring"),i()()),o&2){let t=f();n(2),g(p(3,2,"ADD_DISCOUNT")),n(3),g(Ye(6,4,t.product.basicDetails.productName,"short"))}}var ut=class o{constructor(e,t,a){this.productService=e;this.formBuilder=t;this.translate=a}form;product;discountTypes=["FIXED","PERCENT"];loading=!1;dialogHeader="Product Discount: ";visibleChange=new Pt;success=new Pt;ngOnInit(){this.initForm(),this.product&&(this.dialogHeader+=this.product.basicDetails.productName,this.form.patchValue({active:!this.product.priceDetails.discountDisabled,type:this.product.priceDetails.discountType,amount:this.product.priceDetails.discountAmount,range:this.product.priceDetails.discountStartDate&&this.product.priceDetails.discountEndDate?[new Date(this.product.priceDetails.discountStartDate),new Date(this.product.priceDetails.discountEndDate)]:[]}))}submit(){if(this.product&&this.form.valid&&this.form.value.range[0]&&this.form.value.range[1]){this.loading=!0,this.productService.createProductDiscount(this.getDiscountRequest()).subscribe(e=>{e.success&&this.success.emit(!0),this.success.emit(!1),this.loading=!1});return}}initForm(){this.form=this.formBuilder.group({active:[!1],type:[this.discountTypes[0],w.required],amount:[0,w.required],range:[null,w.required]})}getDiscountRequest(){let e=new mt;return e.productId=this.product.productId,e.discountActive=!!this.form.value.active,e.discountType=this.form.value.type,e.discountAmount=this.form.value.amount,e.discountStartDate=Et.getZonedDate(this.form.value.range[0]),e.discountEndDate=Et.getZonedDate(this.form.value.range[1]),e}onVisibleChange(e){this.visibleChange.emit(e)}static \u0275fac=function(t){return new(t||o)(h(pe),h(Xe),h(D))};static \u0275cmp=E({type:o,selectors:[["app-product-discount-create"]],inputs:{product:"product"},outputs:{visibleChange:"visibleChange",success:"success"},decls:29,vars:36,consts:[["header",""],[3,"visibleChange","visible","modal"],[3,"ngSubmit","formGroup"],[1,"flex","justify-between","items-center","gap-2","mb-4"],["formControlName","active","styleClass","w-36","ariaLabel","Do you confirm",3,"onLabel","offLabel","onIcon","offIcon"],[1,"flex","flex-col","justify-center","gap-2","mb-4"],["for","type"],["formControlName","type",3,"options"],["for","amount"],["id","amount","formControlName","amount","mode","currency","currency","USD","showButtons",""],["for","range"],["id","range","formControlName","range","appendTo","body","selectionMode","range",3,"showTime"],[1,"flex","justify-end","gap-2"],["severity","secondary",3,"onClick","label"],["type","submit",3,"label","disabled","loading"],[1,"header","font-semibold"],[1,"text-primary","mb-2"]],template:function(t,a){if(t&1){let c=I();r(0,"p-dialog",1),b("visibleChange",function(C){return _(c),v(a.onVisibleChange(C))}),x(1,di,7,7,"ng-template",null,0,y),r(3,"form",2),b("ngSubmit",function(){return _(c),v(a.submit())}),r(4,"div",3),m(5,"span")(6,"p-togglebutton",4),l(7,"translate"),l(8,"translate"),i(),r(9,"div",5)(10,"label",6),d(11),l(12,"translate"),i(),m(13,"p-select",7),i(),r(14,"div",5)(15,"label",8),d(16),l(17,"translate"),i(),m(18,"p-inputnumber",9),i(),r(19,"div",5)(20,"label",10),d(21),l(22,"translate"),i(),m(23,"p-datePicker",11),i(),r(24,"div",12)(25,"p-button",13),l(26,"translate"),b("onClick",function(){return _(c),v(a.onVisibleChange(!1))}),i(),m(27,"p-button",14),l(28,"translate"),i()()()}t&2&&(Y(P(34,si)),s("visible",!0)("modal",!0),n(3),s("formGroup",a.form),n(3),s("onLabel",p(7,20,"ENABLED"))("offLabel",p(8,22,"DISABLED"))("onIcon","pi pi-check")("offIcon","pi pi-times"),n(5),g(p(12,24,"DISCOUNT_TYPE")),n(2),s("options",a.discountTypes),n(3),g(p(17,26,"DISCOUNT_AMOUNT")),n(5),g(p(22,28,"ACTIVE_RANGE")),n(2),Y(P(35,ci)),s("showTime",!0),n(2),s("label",p(26,30,"CANCEL")),n(2),s("label",p(28,32,"SAVE"))("disabled",a.form.invalid)("loading",a.loading))},dependencies:[R,T,Z,A,J,ie,ee,te,F,B,Se,M,it,Ze,$,jt,kt,ot],encapsulation:2})};var ui=["dt"],fi=["filter"],gi=()=>["basicDetails.productName"],_i=()=>({"min-width":"75rem"}),vi=()=>[10,20,30],bi=()=>[10,20,50],Ci=()=>({width:"450px"}),hi=o=>({"line-through text-surface-500":o});function Si(o,e){if(o&1){let t=I();r(0,"div",10)(1,"p-button",11),l(2,"translate"),b("onClick",function(){_(t);let c=f();return v(c.newProduct())}),i(),r(3,"p-button",12),l(4,"translate"),b("onClick",function(){_(t);let c=f();return v(c.deleteSelectedProducts())}),i()()}if(o&2){let t=f();n(),s("label",p(2,3,"ADD")),n(2),s("label",p(4,5,"DELETE"))("disabled",!t.selectedProducts||!t.selectedProducts.length)}}function yi(o,e){o&1&&(m(0,"p-button",13),l(1,"translate")),o&2&&s("label",p(1,1,"EXPORT"))}function xi(o,e){if(o&1){let t=I();r(0,"div",14)(1,"h5",15),d(2),l(3,"translate"),i(),r(4,"p-iconfield"),m(5,"p-inputicon",16),r(6,"input",17),l(7,"translate"),b("input",function(c){_(t);let u=f(),C=K(7);return v(u.onGlobalFilter(C,c))}),i()()()}o&2&&(n(2),g(p(3,2,"PRODUCT_LIST")),n(4),s("placeholder",p(7,4,"SEARCH_PACEHOLDER")))}function Ii(o,e){o&1&&(r(0,"tr")(1,"th",18),m(2,"p-tableHeaderCheckbox"),i(),r(3,"th",19),d(4),l(5,"translate"),m(6,"p-sortIcon",20),i(),r(7,"th",21),d(8),l(9,"translate"),m(10,"p-sortIcon",22),i(),r(11,"th"),d(12),l(13,"translate"),i(),r(14,"th",23),d(15),l(16,"translate"),m(17,"p-sortIcon",24),i(),r(18,"th",25),d(19),l(20,"translate"),m(21,"p-sortIcon",24),i(),r(22,"th",26),d(23),l(24,"translate"),m(25,"p-sortIcon",27),i(),r(26,"th",28),d(27),l(28,"translate"),m(29,"p-sortIcon",29),i(),r(30,"th",30),d(31),l(32,"translate"),i(),r(33,"th",30),d(34),l(35,"translate"),i(),r(36,"th",31),d(37),l(38,"translate"),m(39,"p-sortIcon",32),i(),m(40,"th",33),i()),o&2&&(n(4),S(" ",p(5,10,"BARCODE")," "),n(4),S(" ",p(9,12,"NAME")," "),n(4),S(" ",p(13,14,"IMAGE")," "),n(3),S(" ",p(16,16,"CATEGORY")," "),n(4),S(" ",p(20,18,"BRAND")," "),n(4),S(" ",p(24,20,"COST")," "),n(4),S(" ",p(28,22,"PRICE")," "),n(4),S(" ",p(32,24,"DISCOUNT")," "),n(3),S(" ",p(35,26,"PRICE_AFTER_DISCOUNT")," "),n(3),S(" ",p(38,28,"QUANTITY")," "))}function Pi(o,e){if(o&1){let t=I();r(0,"div")(1,"p-button",44),l(2,"translate"),b("onClick",function(){_(t);let c=f().$implicit,u=f();return v(u.editProductDiscount(c))}),i()()}o&2&&(n(),s("pTooltip",p(2,3,"SHOW_DISCOUNT"))("rounded",!0)("text",!0))}function Ei(o,e){if(o&1){let t=I();r(0,"div")(1,"p-button",45),l(2,"translate"),b("onClick",function(){_(t);let c=f().$implicit,u=f();return v(u.editProductDiscount(c))}),i()()}o&2&&(n(),s("pTooltip",p(2,3,"ADD_DISCOUNT"))("rounded",!0)("text",!0))}function wi(o,e){if(o&1){let t=I();r(0,"tr")(1,"td",18),m(2,"p-tableCheckbox",34),i(),r(3,"td",35),b("click",function(){let c=_(t).$implicit,u=f();return v(u.productDetails(c))}),d(4),i(),r(5,"td",36),b("click",function(){let c=_(t).$implicit,u=f();return v(u.productDetails(c))}),d(6),l(7,"substring"),i(),r(8,"td"),m(9,"img",37),i(),r(10,"td"),d(11),i(),r(12,"td"),d(13),i(),r(14,"td"),d(15),l(16,"sCurrency"),i(),r(17,"td"),d(18),l(19,"sCurrency"),i(),r(20,"td")(21,"div",10)(22,"div",38),d(23),l(24,"translate"),i(),x(25,Pi,3,5,"div",39)(26,Ei,3,5,"div",39),i()(),r(27,"td"),d(28),l(29,"sCurrency"),i(),r(30,"td"),m(31,"p-tag",40),i(),r(32,"td")(33,"div",41)(34,"p-button",42),b("onClick",function(){let c=_(t).$implicit,u=f();return v(u.onEditProduct(c))}),i(),r(35,"p-button",43),b("click",function(){let c=_(t).$implicit,u=f();return v(u.deleteProduct(c))}),i()()()()}if(o&2){let t=e.$implicit,a=f();n(2),s("value",t),n(2),S(" ",t.basicDetails.barcode," "),n(),s("pTooltip",t.basicDetails.productName),n(),S(" ",Ye(7,21,t.basicDetails.productName,"medium")," "),n(3),s("src",a.getProductImageSrc(t),L)("alt",t.basicDetails==null?null:t.basicDetails.productName),n(2),g(t.basicDetails.productCategory==null?null:t.basicDetails.productCategory.name),n(2),g(t.basicDetails.productBrand==null?null:t.basicDetails.productBrand.name),n(2),g(p(16,24,t.priceDetails.costPrice)),n(3),g(p(19,26,t.priceDetails.sellingPrice)),n(4),s("ngClass",ze(32,hi,!t.priceDetails.discountDisabled&&!t.priceDetails.discountRangeActive)),n(),S(" ",a.getDiscountLabel(t)||p(24,28,"NO_EXIST")," "),n(2),s("ngIf",!t.priceDetails.discountDisabled),n(),s("ngIf",t.priceDetails.discountDisabled),n(2),g(p(29,30,t.priceDetails.priceWithDiscount)),n(3),s("value",t.basicDetails.quantity)("severity",a.getQuantitySeverity(t)),n(3),s("rounded",!0)("outlined",!0),n(),s("rounded",!0)("outlined",!0)}}function Ti(o,e){if(o&1){let t=I();r(0,"app-product-discount-create",46),b("success",function(c){_(t);let u=f();return v(u.discountSuccess(c))})("visibleChange",function(c){_(t);let u=f();return v(u.discountDialogToggle(c))}),i()}if(o&2){let t=f();s("product",t.product)}}var gt=class o{constructor(e,t,a,c,u){this.productService=e;this.confirmService=t;this.translate=a;this.toast=c;this.router=u}loading=!1;pageReq=new Ie(0,10);pageDetails;products=[];selectedProducts;product;discountDialog=!1;statuses;cols;dt;filter;ngOnInit(){this.getProducts()}getProducts(){this.loading=!0,this.productService.getProductsPage(this.pageReq).subscribe(e=>{e.success&&(this.products=e.data.content,this.pageDetails=e.data.page),this.loading=!1})}onGlobalFilter(e,t){e.filterGlobal(t.target.value,"contains")}deleteSelectedProducts(){}deleteProduct(e){let t=this.translate.instant("DELETE_ALERT",{name:e.basicDetails.productName});this.confirmService.dialogAlert(t,()=>{this.productService.deleteProduct(e.productId).subscribe(a=>{a.success&&(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.getProducts())})})}onEditProduct(e){this.router.navigate(["products/edit",e.productId])}onPageChange(e){this.pageReq.page=e.page,this.pageReq.size=e.rows,this.getProducts()}getSeverity(e){switch(e){case"INSTOCK":return"success";case"LOWSTOCK":return"warn";case"OUTOFSTOCK":return"danger";default:return"info"}}getQuantitySeverity(e){return e.basicDetails.quantity>e.basicDetails.lowStockPoint?"success":e.basicDetails.quantity<=e.basicDetails.lowStockPoint?"warn":e.basicDetails.quantity==0?"danger":"info"}getProductImageSrc(e){return U.getFirstImageSrc(e)}editProductDiscount(e){this.product=e,this.discountDialog=!0}getDiscountLabel(e){return U.getDiscountLabel(e)}discountDialogToggle(e){this.discountDialog=e}discountSuccess(e){e&&(this.discountDialog=!1,this.getProducts())}newProduct(){this.router.navigate(["products/new"])}productDetails(e){this.router.navigate(["products/detail",e.productId])}static \u0275fac=function(t){return new(t||o)(h(pe),h(Ue),h(D),h(z),h(Te))};static \u0275cmp=E({type:o,selectors:[["app-product-list"]],viewQuery:function(t,a){if(t&1&&(Ne(ui,5),Ne(fi,5)),t&2){let c;ke(c=Ae())&&(a.dt=c.first),ke(c=Ae())&&(a.filter=c.first)}},features:[Mt([])],decls:18,vars:24,consts:[["start",""],["end",""],["dt",""],["caption",""],["header",""],["body",""],["styleClass","mb-6"],["dataKey","productId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} products",3,"selectionChange","value","rows","columns","loading","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","rowsPerPageOptions"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords}",3,"onPageChange","first","rows","totalRecords","showCurrentPageReport","showJumpToPageDropdown","rowsPerPageOptions"],[3,"product","success","visibleChange",4,"ngIf"],[1,"flex","items-center","gap-2"],["icon","pi pi-plus","severity","secondary",1,"mr-2",3,"onClick","label"],["severity","secondary","icon","pi pi-trash","outlined","",3,"onClick","label","disabled"],["icon","pi pi-upload","severity","secondary",3,"label"],[1,"flex","items-center","justify-between"],[1,"m-0"],["styleClass","pi pi-search"],["pInputText","","type","text",3,"input","placeholder"],[2,"width","3rem"],["pSortableColumn","basicDetails.barcode",2,"min-width","10rem"],["field","barcode"],["pSortableColumn","basicDetails.productName",2,"min-width","16rem"],["field","productName"],["pSortableColumn","basicDetails.productCategory.name",2,"min-width","8rem"],["field","productBrand"],["pSortableColumn","basicDetails.productBrand?.name",2,"min-width","8rem"],["pSortableColumn","priceDetails.costPrice",2,"min-width","8rem"],["field","costPrice"],["pSortableColumn","priceDetails.sellingPrice",2,"min-width","8rem"],["field","sellingPrice"],[2,"min-width","8rem"],["pSortableColumn","basicDetails.quantity"],["field","quantity"],[2,"min-width","12rem"],[3,"value"],[1,"hover:text-primary","hover:underline","cursor-pointer","min-w-12rem",3,"click"],["tooltipPosition","top",1,"hover:underline","cursor-pointer",3,"click","pTooltip"],[1,"rounded","w-full",2,"width","6rem","height","4rem","object-fit","cover",3,"src","alt"],[1,"text-sm",3,"ngClass"],[4,"ngIf"],[3,"value","severity"],[1,"flex","gap-2","items-center"],["icon","pi pi-pencil",3,"onClick","rounded","outlined"],["icon","pi pi-trash","severity","danger",3,"click","rounded","outlined"],["icon","pi pi-eye",1,"mr-2",3,"onClick","pTooltip","rounded","text"],["icon","pi pi-percentage",1,"mr-2",3,"onClick","pTooltip","rounded","text"],[3,"success","visibleChange","product"]],template:function(t,a){if(t&1){let c=I();r(0,"p-toolbar",6),x(1,Si,5,7,"ng-template",null,0,y)(3,yi,2,3,"ng-template",null,1,y),i(),r(5,"p-card")(6,"p-table",7,2),N("selectionChange",function(C){return _(c),O(a.selectedProducts,C)||(a.selectedProducts=C),v(C)}),x(8,xi,8,6,"ng-template",null,3,y)(10,Ii,41,30,"ng-template",null,4,y)(12,wi,36,34,"ng-template",null,5,y),i(),r(14,"p-paginator",8),b("onPageChange",function(C){return _(c),v(a.onPageChange(C))}),i()(),m(15,"p-confirmdialog")(16,"p-toast"),x(17,Ti,1,1,"app-product-discount-create",9)}t&2&&(n(6),s("value",a.products)("rows",10)("columns",a.cols)("loading",a.loading)("globalFilterFields",P(19,gi))("tableStyle",P(20,_i)),V("selection",a.selectedProducts),s("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",P(21,vi)),n(8),s("first",a.pageReq.page*a.pageReq.size)("rows",a.pageReq.size)("totalRecords",(a.pageDetails==null?null:a.pageDetails.totalElements)||0)("showCurrentPageReport",!0)("showJumpToPageDropdown",!1)("rowsPerPageOptions",P(22,bi)),n(),Y(P(23,Ci)),n(2),s("ngIf",a.discountDialog))},dependencies:[R,Ut,we,ae,fe,ge,_e,ve,be,T,W,M,Nt,$,Q,he,Ce,$t,H,G,le,et,Gt,rt,F,B,ye,Ht,Be,oe,q,ne,j,Xt,xe,nt,qt,st,Me,Je,tt,ut,ot],encapsulation:2})};var bt=class o{constructor(e){this.http=e}baseUrl=re.apiBaseUrl+"/product-image";deleteProductImage(e){return this.http.delete(`${this.baseUrl}/${e}`)}setPrimaryImage(e){return this.http.put(`${this.baseUrl}/primary/${e}`,{})}static \u0275fac=function(t){return new(t||o)(me(ue))};static \u0275prov=de({token:o,factory:o.\u0275fac,providedIn:"root"})};var Le=class o{constructor(e){this.http=e}baseUrl=re.apiBaseUrl;getAllCategories(){return this.http.get(`${this.baseUrl}/product-category/all`)}getCategoriesPage(e){return this.http.get(`${this.baseUrl}/product-category?page=${e.page}&size=${e.size}`)}createProductCategory(e){return this.http.post(`${this.baseUrl}/product-category`,e)}updateProductCategory(e){return this.http.put(`${this.baseUrl}/product-category`,e)}deleteCategory(e){return this.http.delete(`${this.baseUrl}/product-category/${e}`)}static \u0275fac=function(t){return new(t||o)(me(ue))};static \u0275prov=de({token:o,factory:o.\u0275fac,providedIn:"root"})};var Ve=class o{constructor(e){this.http=e}baseUrl=re.apiBaseUrl;getAllBrands(){return this.http.get(`${this.baseUrl}/product-brand/all`)}getBrandsPage(e){return this.http.get(`${this.baseUrl}/product-brand?page=${e.page}&size=${e.size}`)}createBrand(e){return this.http.post(`${this.baseUrl}/product-brand`,e)}updateBrand(e){return this.http.put(`${this.baseUrl}/product-brand`,e)}static \u0275fac=function(t){return new(t||o)(me(ue))};static \u0275prov=de({token:o,factory:o.\u0275fac,providedIn:"root"})};var Oe=class o{constructor(e){this.http=e}baseUrl=re.apiBaseUrl+"/product-unit";getAllUnits(){return this.http.get(this.baseUrl)}createProductUnit(e){return this.http.post(this.baseUrl,e)}updateProductUnit(e){return this.http.put(this.baseUrl,e)}static \u0275fac=function(t){return new(t||o)(me(ue))};static \u0275prov=de({token:o,factory:o.\u0275fac,providedIn:"root"})};var Mi=["imageUpload"],Ui=()=>[];function Li(o,e){if(o&1&&m(0,"img",40),o&2){let t=e.$implicit,a=f(2);s("src",a.getProductImageSrc(a.product.productId,t),L)}}function Vi(o,e){if(o&1&&m(0,"img",41),o&2){let t=e.$implicit,a=f(2);s("src",a.getProductImageSrc(a.product.productId,t),L)}}function Oi(o,e){if(o&1){let t=I();r(0,"p-button",46),l(1,"translate"),b("onClick",function(){_(t);let c=f().$implicit,u=f(2);return v(u.setImageAsPrimary(c))}),i()}o&2&&s("label",p(1,1,"SET_IMAGE_PRIMARY"))}function Ni(o,e){o&1&&(m(0,"p-tag",47),l(1,"translate")),o&2&&s("value",p(1,1,"PRIMARY_IMAGE"))}function ki(o,e){if(o&1){let t=I();r(0,"div",42),x(1,Oi,2,3,"p-button",43)(2,Ni,2,3,"p-tag",44),r(3,"p-button",45),b("onClick",function(c){let u=_(t).$implicit,C=f(2);return v(C.deleteImage(c,u))}),i()()}if(o&2){let t=e.$implicit;n(),s("ngIf",!t.isPrimary),n(),s("ngIf",t.isPrimary)}}function Ai(o,e){o&1&&(r(0,"div"),d(1),l(2,"translate"),i()),o&2&&(n(),g(p(2,1,"NO_SELECTED_FILE")))}function ji(o,e){if(o&1&&(r(0,"li"),d(1),i()),o&2){let t=e.$implicit;n(),Rt("",t.name," - ",t.size," bytes")}}function qi(o,e){if(o&1&&(r(0,"ul"),x(1,ji,2,2,"li",49),i()),o&2){let t=f(3);n(),s("ngForOf",t.uploadedFiles)}}function Gi(o,e){if(o&1&&x(0,qi,2,1,"ul",48),o&2){let t=f(2);s("ngIf",t.uploadedFiles.length)}}function Hi(o,e){if(o&1){let t=I();r(0,"div",37)(1,"p-galleria",38),x(2,Li,1,1,"ng-template",null,0,y)(4,Vi,1,1,"ng-template",null,1,y)(6,ki,4,2,"ng-template",null,2,y),i(),r(8,"p-fileupload",39),l(9,"translate"),l(10,"translate"),l(11,"translate"),b("onUpload",function(c){_(t);let u=f();return v(u.onUpload(c))}),x(12,Ai,3,3,"ng-template",null,3,y)(14,Gi,1,1,"ng-template",null,4,y),i()()}if(o&2){let t=f();n(),s("value",t.product.basicDetails.productImages)("responsiveOptions",P(13,Ui)),n(7),s("url",t.getUploadPath())("chooseLabel",p(9,7,"CHOOSE_FILE"))("cancelLabel",p(10,9,"CANCEL"))("uploadLabel",p(11,11,"UPLOAD"))("multiple",!0)}}function Wi(o,e){o&1&&(r(0,"div"),d(1),l(2,"translate"),i()),o&2&&(n(),g(p(2,1,"NO_SELECTED_FILE")))}function Qi(o,e){if(o&1){let t=I();r(0,"div",19)(1,"label",50),d(2),l(3,"translate"),i(),r(4,"p-fileupload",51),l(5,"translate"),l(6,"translate"),b("onSelect",function(c){_(t);let u=f();return v(u.handleImageSelection(c))}),x(7,Wi,3,3,"ng-template",null,3,y),i()()}o&2&&(n(2),g(p(3,6,"PRODUCT_IMAGES")),n(2),s("fileLimit",5)("showUploadButton",!1)("chooseLabel",p(5,8,"CHOOSE_FILE"))("cancelLabel",p(6,10,"CANCEL"))("multiple",!0))}var We=class o{constructor(e,t,a,c,u,C,Ur,Lr,Vr,Or,Nr){this.productService=e;this.productImageService=t;this.categoryService=a;this.brandService=c;this.unitService=u;this.toast=C;this.confirm=Ur;this.formBuilder=Lr;this.route=Vr;this.router=Or;this.translate=Nr}mode="new";productForm;loading;categoryList=[];brandList=[];unitList=[];imagesFiles=[];uploadedFiles=[];imageUpload;product;ngOnInit(){this.fetchProductToEdit(),this.buildFormBasic(),this.getCategories(),this.getBrands(),this.getUnits()}fetchProductToEdit(){let e=this.route.snapshot.paramMap.get("productId");if(e){let t=Number.parseInt(e);t&&Number.isInteger(t)&&this.productService.getProductById(t).subscribe(a=>{a.success?(this.product=a.data,this.mode="edit",this.patchFormValue()):this.router.navigate(["/notfound"])})}}patchFormValue(){this.productForm.patchValue({productName:this.product.basicDetails.productName,barcode:this.product.basicDetails.barcode,productCategoryId:this.product.basicDetails.productCategory?[this.product.basicDetails.productCategory?.productCategoryId]:[],unitOfMeasureId:this.product.basicDetails.unitOfMeasure?[this.product.basicDetails.unitOfMeasure?.unitOfMeasureId]:[],productBrandId:this.product.basicDetails.productBrand?[this.product.basicDetails.productBrand?.productBrandId]:[],productStatusId:this.product.basicDetails.productStatus?[this.product.basicDetails.productStatus?.productStatusId]:[],description:this.product.basicDetails.description,quantity:this.product.basicDetails.quantity,costPrice:this.product.priceDetails.costPrice,sellingPrice:this.product.priceDetails.sellingPrice,lowStockPoint:this.product.basicDetails.lowStockPoint})}getCategories(){this.categoryService.getAllCategories().subscribe(e=>this.categoryList=e.data)}getBrands(){this.brandService.getAllBrands().subscribe(e=>this.brandList=e.data)}getUnits(){this.unitService.getAllUnits().subscribe(e=>this.unitList=e.data)}buildFormBasic(){this.productForm=this.formBuilder.group({productName:[null,w.required],barcode:[null,w.required],productCategoryId:[null],unitOfMeasureId:[null],productBrandId:[null],productStatusId:[null],description:[null],quantity:[0,w.required],costPrice:[0,w.required],sellingPrice:[0,w.required],lowStockPoint:[0]})}getProductRequest(){let e=this.productForm.value,t=new FormData;return this.product&&t.append("productId",this.product.productId+""),t.append("productName",e.productName),t.append("barcode",e.barcode),e.productCategoryId&&t.append("productCategoryId",e.productCategoryId),e.unitOfMeasureId&&t.append("unitOfMeasureId",e.unitOfMeasureId),e.productBrandId&&t.append("productBrandId",e.productBrandId),e.productStatusId&&t.append("productStatusId",e.productStatusId),t.append("description",e.description),t.append("quantity",e.quantity),t.append("costPrice",e.costPrice),t.append("quantity",e.quantity),t.append("sellingPrice",e.sellingPrice),t.append("lowStockPoint","0"),this.imagesFiles.forEach(a=>{t.append("imageFiles",a,a.name)}),t}onScanBarcodeChanges(e){if(this.loading)return;this.loading=!0;let t=e.codeResult.code.trim();this.productService.getProductByBarcode(t).subscribe(a=>{a.success?this.productForm.patchValue({barcode:a.data.basicDetails.barcode}):(console.log(t,e),this.toast.showError(this.translate.instant("PRODUCT_NOT_FOUND")),this.loading=!1)})}submit(){if(!this.productForm.valid){this.toast.showError("Make sure to enter all the required fields");return}this.mode=="new"?this.createProduct():this.mode=="edit"&&this.editProduct()}createProduct(){this.loading=!0,this.productService.createProduct(this.getProductRequest()).subscribe(e=>{e.success&&(this.loading=!1,this.toast.showSuccess("Saved successfully"),this.productForm.reset())},e=>{this.loading=!1,this.toast.showError(e.error?.message)})}editProduct(){this.loading=!0,this.productService.editProduct(this.getProductRequest()).subscribe(e=>{e.success&&(this.loading=!1,this.toast.showSuccess("Saved successfully"))},e=>{this.loading=!1,this.toast.showError(e.error?.message)})}handleImageSelection(e){this.imagesFiles=[...e.currentFiles]}getHeader(){return this.mode=="edit"?this.translate.instant("EDIT_PRODUCT"):this.translate.instant("ADD_PRODUCTS")}getProductImageSrc(e,t){return U.getImageSrc(e,t)}deleteImage(e,t){this.confirm.alert(e,()=>{this.productImageService.deleteProductImage(t.productImageId).subscribe(a=>{a.success&&(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.fetchProductToEdit())})})}setImageAsPrimary(e){this.productImageService.setPrimaryImage(e.productImageId).subscribe(t=>{t.success&&(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.fetchProductToEdit())})}onUpload(e){e.originalEvent.body?.success?(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.fetchProductToEdit()):this.toast.showWarn(e.originalEvent.body?.message)}getUploadPath(){return re.apiBaseUrl+"/product-image/"+this.product.productId}static \u0275fac=function(t){return new(t||o)(h(pe),h(bt),h(Le),h(Ve),h(Oe),h(z),h(Ue),h(Xe),h(Ke),h(Te),h(D))};static \u0275cmp=E({type:o,selectors:[["app-product-create"]],viewQuery:function(t,a){if(t&1&&Ne(Mi,5),t&2){let c;ke(c=Ae())&&(a.imageUpload=c.first)}},decls:76,vars:62,consts:[["item",""],["thumbnail",""],["caption",""],["empty",""],["content",""],[3,"ngSubmit","formGroup"],[1,"flex","mt-8"],[1,"card","flex","flex-col","gap-6","w-full"],[1,"font-semibold","text-xl"],["class","flex justify-center gap-2 w-full",4,"ngIf"],[1,"flex","flex-col","md:flex-row","gap-6"],[1,"flex","flex-wrap","gap-2","w-full"],["for","productName"],["pInputText","","id","productName","type","text","formControlName","productName"],["for","barcode"],[1,"text-muted-color"],[1,"w-full"],["styleClass","pi pi-barcode"],["pInputText","","id","barcode","type","text","formControlName","barcode"],[1,"flex","flex-col","flex-wrap","gap-2","w-full"],["for","category"],["id","category","optionLabel","name","optionValue","productCategoryId","selectionLimit","1","formControlName","productCategoryId",3,"options","filter","emptyMessage","placeholder"],["for","brand"],["id","brand","optionLabel","name","optionValue","productBrandId","selectionLimit","1","formControlName","productBrandId",3,"options","filter","emptyMessage","placeholder"],["for","costPrice"],["id","costPrice","formControlName","costPrice","mode","currency","currency","USD","showButtons",""],["for","sellingPrice"],["id","sellingPrice","formControlName","sellingPrice","mode","currency","currency","USD","showButtons",""],["for","productUnit"],["id","productUnit","optionLabel","name","optionValue","unitOfMeasureId","selectionLimit","1","formControlName","unitOfMeasureId",3,"options","filter","emptyMessage","placeholder"],["for","quantity"],["id","quantity","formControlName","quantity","showButtons","","mode","decimal"],["for","desc"],["formControlName","description","pTextarea","","id","desc","rows","5"],["class","flex flex-col flex-wrap gap-2 w-full",4,"ngIf"],["type","submit","icon","pi pi-check",3,"loading","label"],["type","code_128",3,"valueChanges"],[1,"flex","justify-center","gap-2","w-full"],[2,"width","40%",3,"value","responsiveOptions"],["name","files[]","accept","image/*","maxFileSize","10000000","mode","advanced",3,"onUpload","url","chooseLabel","cancelLabel","uploadLabel","multiple"],[2,"width","20rem","display","block",3,"src"],[2,"width","60px","display","block",3,"src"],[1,"flex","justify-between"],["text","",3,"label","onClick",4,"ngIf"],["severity","success",3,"value",4,"ngIf"],["icon","pi pi-trash","severity","danger","rounded","",3,"onClick"],["text","",3,"onClick","label"],["severity","success",3,"value"],[4,"ngIf"],[4,"ngFor","ngForOf"],["for","productImages"],["accept","image/*","maxFileSize","10000000","mode","advanced",3,"onSelect","fileLimit","showUploadButton","chooseLabel","cancelLabel","multiple"]],template:function(t,a){t&1&&(r(0,"p-fluid")(1,"form",5),b("ngSubmit",function(){return a.submit()}),r(2,"div",6)(3,"div",7)(4,"div",8),d(5),i(),x(6,Hi,16,14,"div",9),r(7,"div",10)(8,"div",11)(9,"label",12),d(10),l(11,"translate"),i(),m(12,"input",13),i(),r(13,"div",11)(14,"label",14),d(15),l(16,"translate"),i(),r(17,"span",15),d(18),l(19,"translate"),i(),r(20,"div",16)(21,"p-iconfield"),m(22,"p-inputicon",17)(23,"input",18),i()()()(),r(24,"div",10)(25,"div",19)(26,"label",20),d(27),l(28,"translate"),i(),m(29,"p-multiselect",21),l(30,"translate"),l(31,"translate"),i(),r(32,"div",19)(33,"label",22),d(34),l(35,"translate"),i(),m(36,"p-multiselect",23),l(37,"translate"),l(38,"translate"),i()(),r(39,"div",10)(40,"div",11)(41,"label",24),d(42),l(43,"translate"),i(),m(44,"p-inputnumber",25),i(),r(45,"div",11)(46,"label",26),d(47),l(48,"translate"),i(),m(49,"p-inputnumber",27),i()(),r(50,"div",10)(51,"div",19)(52,"label",28),d(53),l(54,"translate"),i(),m(55,"p-multiselect",29),l(56,"translate"),l(57,"translate"),i(),r(58,"div",11)(59,"label",30),d(60),l(61,"translate"),i(),m(62,"p-inputnumber",31),i()(),r(63,"div",10)(64,"div",19)(65,"label",32),d(66),l(67,"translate"),i(),m(68,"textarea",33),i(),x(69,Qi,9,12,"div",34),i(),r(70,"div",10),m(71,"p-button",35),l(72,"translate"),i()()()()(),m(73,"p-toast")(74,"p-confirmpopup"),r(75,"barcode-scanner-livestream",36),b("valueChanges",function(u){return a.onScanBarcodeChanges(u)}),i()),t&2&&(n(),s("formGroup",a.productForm),n(4),g(a.getHeader()),n(),s("ngIf",a.mode==="edit"),n(4),g(p(11,28,"PRODUCT_NAME")),n(5),g(p(16,30,"BARCODE")),n(3),S("(",p(19,32,"SCAN_BARCODE_HINT"),")"),n(9),g(p(28,34,"CATEGORY")),n(2),s("options",a.categoryList)("filter",!0)("emptyMessage",p(30,36,"NO_DATA"))("placeholder",p(31,38,"SELECT_FROM_LIST")),n(5),g(p(35,40,"BRAND")),n(2),s("options",a.brandList)("filter",!0)("emptyMessage",p(37,42,"NO_DATA"))("placeholder",p(38,44,"SELECT_FROM_LIST")),n(6),g(p(43,46,"COST")),n(5),g(p(48,48,"PRICE")),n(6),g(p(54,50,"PRODUCT_UNIT")),n(2),s("options",a.unitList)("filter",!0)("emptyMessage",p(56,52,"NO_DATA"))("placeholder",p(57,54,"SELECT_FROM_LIST")),n(5),g(p(61,56,"QUANTITY")),n(6),g(p(67,58,"DESCRIPTION")),n(3),s("ngIf",a.mode==="new"),n(2),s("loading",a.loading)("label",p(72,60,"SAVE")))},dependencies:[H,G,Qt,Wt,W,M,et,T,Z,X,A,J,rt,it,le,at,Yt,zt,ie,ee,te,Re,Fe,$,Q,Kt,F,B,pt,Lt,we,lt,Be,q,j,dt,ct],encapsulation:2})};var $i=()=>["name","description"],zi=()=>({"min-width":"75rem"}),Yi=()=>[10,20,30],Ki=()=>({width:"450px"});function Xi(o,e){if(o&1){let t=I();r(0,"div",21)(1,"p-button",22),l(2,"translate"),b("onClick",function(){_(t);let c=f();return v(c.openNew())}),i(),r(3,"p-button",23),l(4,"translate"),b("onClick",function(){_(t);let c=f();return v(c.deleteSelectedProducts())}),i()()}if(o&2){let t=f();n(),s("label",p(2,3,"ADD")),n(2),s("label",p(4,5,"DELETE"))("disabled",!t.selectedCategories||!t.selectedCategories.length)}}function Ji(o,e){o&1&&(m(0,"p-button",24),l(1,"translate")),o&2&&s("label",p(1,1,"EXPORT"))}function Zi(o,e){if(o&1){let t=I();r(0,"div",25)(1,"h5",26),d(2),l(3,"translate"),i(),r(4,"p-iconfield"),m(5,"p-inputicon",27),r(6,"input",28),l(7,"translate"),b("input",function(c){_(t);let u=f(),C=K(6);return v(u.onGlobalFilter(C,c))}),i()()()}o&2&&(n(2),g(p(3,2,"CATEGORIES")),n(4),s("placeholder",p(7,4,"SEARCH_PACEHOLDER")))}function er(o,e){o&1&&(r(0,"tr")(1,"th",29),m(2,"p-tableHeaderCheckbox"),i(),r(3,"th"),d(4),l(5,"translate"),i(),r(6,"th",30),d(7),l(8,"translate"),m(9,"p-sortIcon",31),i(),r(10,"th",32),d(11),l(12,"translate"),m(13,"p-sortIcon",33),i(),m(14,"th"),i()),o&2&&(n(4),g(p(5,3,"IMAGE")),n(3),S(" ",p(8,5,"NAME")," "),n(4),S(" ",p(12,7,"DESCRIPTION")," "))}function tr(o,e){if(o&1){let t=I();r(0,"tr")(1,"td",29),m(2,"p-tableCheckbox",34),i(),r(3,"td"),m(4,"img",35),i(),r(5,"td",36),d(6),i(),r(7,"td",37),d(8),i(),r(9,"td")(10,"div",38)(11,"p-button",39),b("click",function(){let c=_(t).$implicit,u=f();return v(u.editCategory(c))}),i(),r(12,"p-button",40),b("click",function(){let c=_(t).$implicit,u=f();return v(u.deleteCategory(c))}),i()()()()}if(o&2){let t=e.$implicit,a=f();n(2),s("value",t),n(2),s("src",a.getCatImageSrc(t),L)("alt",t.name),n(2),g(t.name),n(2),g(t.description),n(3),s("rounded",!0)("outlined",!0),n(),s("rounded",!0)("outlined",!0)}}var Ct=class o{constructor(e,t,a,c){this.categoryService=e;this.toast=t;this.confirm=a;this.translate=c}categoryDialog=!1;dialogHeader="";loading=!1;saveLoading=!1;pageReq=new Ie(0,10);categoryList=[];category;selectedCategories;cols;imageFile;mode;catForm;ngOnInit(){this.initCategoryForm(),this.getCategories()}initCategoryForm(){this.catForm=new De({name:new se(null,[w.required]),description:new se(null)})}getCategories(){this.loading=!0,this.categoryService.getAllCategories().subscribe(e=>{e.success&&(this.categoryList=e.data,this.loading=!1)})}openNew(){this.categoryDialog=!0,this.mode="create",this.dialogHeader="Add Category",this.catForm.reset()}onGlobalFilter(e,t){e.filterGlobal(t.target.value,"contains")}editCategory(e){this.category=e,this.mode="update",this.categoryDialog=!0,this.dialogHeader=e.name,this.catForm.patchValue({name:e.name,description:e.description})}deleteCategory(e){this.confirm.dialogAlert("Are you sure you want to proceed?",()=>{this.categoryService.deleteCategory(e.productCategoryId).subscribe(a=>{a.success&&(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.getCategories())})})}deleteSelectedProducts(){}getCategoryRequest(){let e=this.catForm.value,t=new FormData;return this.category&&t.append("productCategoryId",this.category.productCategoryId+""),this.imageFile&&t.append("image",this.imageFile),t.append("name",e.name),t.append("description",e.description||""),t}onSaveCategory(){if(!this.catForm.valid){this.toast.showError(this.translate.instant("REQUIRED_FIELDS_MSG"));return}this.mode==="update"?this.updateProductCategory():this.createProductCategory()}createProductCategory(){this.saveLoading=!0,this.categoryService.createProductCategory(this.getCategoryRequest()).subscribe(e=>{this.saveLoading=!1,e.success&&(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.getCategories(),this.categoryDialog=!1)},e=>{this.toast.showError(e.error?.message),this.saveLoading=!1})}updateProductCategory(){this.saveLoading=!0,this.categoryService.updateProductCategory(this.getCategoryRequest()).subscribe(e=>{this.saveLoading=!1,e.success?(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.getCategories(),this.categoryDialog=!1):this.toast.showError(e.message)},e=>{this.toast.showError(e.error?.message),this.saveLoading=!1})}onSelectImage(e){e.currentFiles&&(this.imageFile=e.currentFiles[0])}getCatImageSrc(e){return U.getCategoryImageSrc(e)}static \u0275fac=function(t){return new(t||o)(h(Le),h(z),h(Ue),h(D))};static \u0275cmp=E({type:o,selectors:[["app-category-list"]],decls:38,vars:40,consts:[["start",""],["end",""],["dt",""],["caption",""],["header",""],["body",""],["styleClass","mb-6"],["dataKey","productCategoryId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} categories",3,"selectionChange","value","rows","columns","loading","paginator","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","rowsPerPageOptions"],[3,"visibleChange","visible","header","modal"],[3,"ngSubmit","formGroup"],[1,"flex","items-center","gap-4","mb-4"],["for","name",1,"font-semibold","w-24"],["formControlName","name","pInputText","","id","name","autocomplete","off",1,"flex-auto"],[1,"flex","items-center","gap-4","mb-8"],["for","description",1,"font-semibold","w-24"],["formControlName","description","pTextarea","","id","description","autocomplete","off",1,"flex-auto"],["for","catImage",1,"font-semibold","w-24"],["mode","basic","chooseIcon","pi pi-upload","name","catImage","accept","image/*","maxFileSize","1000000",3,"onSelect","chooseLabel"],[1,"flex","justify-end","gap-2"],["severity","secondary",3,"click","label"],["type","submit",3,"label","loading"],[1,"flex","items-center","gap-2"],["icon","pi pi-plus","severity","secondary",1,"mr-2",3,"onClick","label"],["severity","secondary","icon","pi pi-trash","outlined","",3,"onClick","label","disabled"],["icon","pi pi-upload","severity","secondary",3,"label"],[1,"flex","items-center","justify-between"],[1,"m-0"],["styleClass","pi pi-search"],["pInputText","","type","text",3,"input","placeholder"],[2,"width","3rem"],["pSortableColumn","name",2,"min-width","16rem"],["field","name"],["pSortableColumn","description",2,"min-width","16rem"],["field","description"],[3,"value"],[1,"rounded","w-full",2,"width","80px","object-fit","cover",3,"src","alt"],[2,"min-width","12rem"],[2,"min-width","16rem"],[1,"flex","gap-2","items-center"],["icon","pi pi-pencil",1,"mr-2",3,"click","rounded","outlined"],["icon","pi pi-trash","severity","danger",3,"click","rounded","outlined"]],template:function(t,a){if(t&1){let c=I();r(0,"p-toolbar",6),x(1,Xi,5,7,"ng-template",null,0,y)(3,Ji,2,3,"ng-template",null,1,y),i(),r(5,"p-table",7,2),N("selectionChange",function(C){return _(c),O(a.selectedCategories,C)||(a.selectedCategories=C),v(C)}),x(7,Zi,8,6,"ng-template",null,3,y)(9,er,15,9,"ng-template",null,4,y)(11,tr,13,9,"ng-template",null,5,y),i(),r(13,"p-dialog",8),N("visibleChange",function(C){return _(c),O(a.categoryDialog,C)||(a.categoryDialog=C),v(C)}),r(14,"form",9),b("ngSubmit",function(){return _(c),v(a.onSaveCategory())}),r(15,"div",10)(16,"label",11),d(17),l(18,"translate"),i(),m(19,"input",12),i(),r(20,"div",13)(21,"label",14),d(22),l(23,"translate"),i(),m(24,"textarea",15),i(),r(25,"div",13)(26,"label",16),d(27),l(28,"translate"),i(),r(29,"p-fileupload",17),l(30,"translate"),b("onSelect",function(C){return _(c),v(a.onSelectImage(C))}),i()(),r(31,"div",18)(32,"p-button",19),l(33,"translate"),b("click",function(){return _(c),v(a.categoryDialog=!1)}),i(),m(34,"p-button",20),l(35,"translate"),i()()(),m(36,"p-toast")(37,"p-confirm-dialog")}t&2&&(n(5),s("value",a.categoryList)("rows",10)("columns",a.cols)("loading",a.loading)("paginator",!0)("globalFilterFields",P(36,$i))("tableStyle",P(37,zi)),V("selection",a.selectedCategories),s("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",P(38,Yi)),n(8),Y(P(39,Ki)),V("visible",a.categoryDialog),s("header",a.dialogHeader)("modal",!0),n(),s("formGroup",a.catForm),n(3),g(p(18,24,"NAME")),n(5),g(p(23,26,"DESCRIPTION")),n(5),g(p(28,28,"IMAGE")),n(2),s("chooseLabel",p(30,30,"CHOOSE_FILE")),n(3),s("label",p(33,32,"CANCEL")),n(2),s("label",p(35,34,"SAVE"))("loading",a.saveLoading))},dependencies:[R,ae,fe,ge,_e,ve,be,T,Z,X,A,J,ie,ee,te,W,M,$,Q,he,Ce,H,G,le,at,ye,Se,oe,q,ne,j,F,B,Re,Fe,xe],encapsulation:2})};var ir=()=>["name","description"],rr=()=>({"min-width":"75rem"}),nr=()=>[10,20,30],or=()=>({width:"450px"});function ar(o,e){if(o&1){let t=I();r(0,"div",22)(1,"p-button",23),l(2,"translate"),b("onClick",function(){_(t);let c=f();return v(c.openNew())}),i(),r(3,"p-button",24),l(4,"translate"),b("onClick",function(){_(t);let c=f();return v(c.deleteSelectedBrands())}),i()()}if(o&2){let t=f();n(),s("label",p(2,3,"ADD")),n(2),s("label",p(4,5,"DELETE"))("disabled",!t.selectedBrands||!t.selectedBrands.length)}}function lr(o,e){o&1&&(m(0,"p-button",25),l(1,"translate")),o&2&&s("label",p(1,1,"EXPORT"))}function pr(o,e){if(o&1){let t=I();r(0,"div",26)(1,"h5",27),d(2),l(3,"translate"),i(),r(4,"p-iconfield"),m(5,"p-inputicon",28),r(6,"input",29),l(7,"translate"),b("input",function(c){_(t);let u=f(),C=K(6);return v(u.onGlobalFilter(C,c))}),i()()()}o&2&&(n(2),g(p(3,2,"PRODUCT_BRANDS")),n(4),s("placeholder",p(7,4,"SEARCH_PACEHOLDER")))}function sr(o,e){o&1&&(r(0,"tr")(1,"th",30),m(2,"p-tableHeaderCheckbox"),i(),r(3,"th"),d(4),l(5,"translate"),i(),r(6,"th",31),d(7),l(8,"translate"),m(9,"p-sortIcon",32),i(),r(10,"th",33),d(11),l(12,"translate"),m(13,"p-sortIcon",34),i(),m(14,"th"),i()),o&2&&(n(4),g(p(5,3,"IMAGE")),n(3),S(" ",p(8,5,"NAME")," "),n(4),S(" ",p(12,7,"DESCRIPTION")," "))}function cr(o,e){if(o&1){let t=I();r(0,"tr")(1,"td",30),m(2,"p-tableCheckbox",35),i(),r(3,"td"),m(4,"img",36),i(),r(5,"td"),d(6),i(),r(7,"td"),d(8),i(),r(9,"td")(10,"div",37)(11,"p-button",38),b("click",function(){let c=_(t).$implicit,u=f();return v(u.editBrand(c))}),i(),r(12,"p-button",39),b("click",function(){let c=_(t).$implicit,u=f();return v(u.deleteBrand(c))}),i()()()()}if(o&2){let t=e.$implicit,a=f();n(2),s("value",t),n(2),s("src",a.getCatImageSrc(t),L)("alt",t.name),n(2),S(" ",t.name," "),n(2),S(" ",t.description," "),n(3),s("rounded",!0)("outlined",!0),n(),s("rounded",!0)("outlined",!0)}}var ht=class o{constructor(e,t,a){this.brandService=e;this.toast=t;this.translate=a}brandDialog=!1;dialogHeader="Create Product Brand";loading=!1;saveLoading=!1;pageReq=new Ie(0,10);brandList=[];brand;selectedBrands;cols;imageFile;brandForm;mode;ngOnInit(){this.getBrands(),this.initbrandForm()}getBrands(){this.brandService.getAllBrands().subscribe(e=>{e.success&&(this.brandList=e.data)})}initbrandForm(){this.brandForm=new De({name:new se(null,[w.required]),description:new se(null)})}onSaveBrand(){if(this.brandForm.invalid){this.toast.showWarn(this.translate.instant("REQUIRED_FIELDS_MSG"));return}this.mode==="update"?this.updateBrand():this.createBrand()}createBrand(){this.saveLoading=!0,this.brandService.createBrand(this.getBrandFormData()).subscribe(e=>{e.success?(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.getBrands(),this.brandForm.reset(),this.brandDialog=!1):this.toast.showError(e.message),this.saveLoading=!1})}updateBrand(){this.saveLoading=!0,this.brandService.updateBrand(this.getBrandFormData()).subscribe(e=>{e.success?(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.getBrands(),this.brandForm.reset(),this.brandDialog=!1):this.toast.showError(e.message),this.saveLoading=!1})}getBrandFormData(){let e=new FormData;return e.append("name",this.brandForm.value.name),e.append("description",this.brandForm.value.description),this.imageFile&&e.append("image",this.imageFile),this.brand&&e.append("productBrandId",this.brand.productBrandId+""),e}editBrand(e){this.brand=e,this.mode="update",this.brandDialog=!0,this.dialogHeader=e.name,this.brandForm.patchValue({name:e.name,description:e.description})}deleteBrand(e){}openNew(){this.brandDialog=!0}deleteSelectedBrands(){}onGlobalFilter(e,t){e.filterGlobal(t.target.value,"contains")}onSelectImage(e){e.currentFiles&&(this.imageFile=e.currentFiles[0])}getCatImageSrc(e){return U.getBrandImageSrc(e)}static \u0275fac=function(t){return new(t||o)(h(Ve),h(z),h(D))};static \u0275cmp=E({type:o,selectors:[["app-product-brands"]],decls:38,vars:39,consts:[["start",""],["end",""],["dt",""],["caption",""],["header",""],["body",""],["styleClass","mb-6"],["dataKey","productBrandId","paginator","true","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} brands",3,"selectionChange","value","rows","columns","loading","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","rowsPerPageOptions"],[3,"visibleChange","visible","header","modal"],[3,"ngSubmit","formGroup"],[1,"flex","items-center","gap-4","mb-4"],["for","name",1,"font-semibold","w-24"],["formControlName","name","pInputText","","id","name","autocomplete","off",1,"flex-auto"],[1,"flex","items-center","gap-4","mb-6"],["for","description",1,"font-semibold","w-24"],["formControlName","description","pInputText","","id","description","autocomplete","off",1,"flex-auto"],[1,"flex","items-center","gap-4","mb-8"],["for","catImage",1,"font-semibold","w-24"],["mode","basic","chooseIcon","pi pi-upload","name","catImage","accept","image/*","maxFileSize","1000000",3,"onSelect","chooseLabel"],[1,"flex","justify-end","gap-2"],["severity","secondary",3,"click","label"],["type","submit",3,"label","loading"],[1,"flex","items-center","gap-2"],["icon","pi pi-plus","severity","secondary",1,"mr-2",3,"onClick","label"],["severity","secondary","icon","pi pi-trash","outlined","",3,"onClick","label","disabled"],["icon","pi pi-upload","severity","secondary",3,"label"],[1,"flex","items-center","justify-between"],[1,"m-0"],["styleClass","pi pi-search"],["pInputText","","type","text",3,"input","placeholder"],[2,"width","3rem"],["pSortableColumn","name"],["field","name"],["pSortableColumn","description"],["field","description"],[3,"value"],[1,"rounded","w-full",2,"width","80px","object-fit","cover",3,"src","alt"],[1,"flex","gap-2","items-center"],["icon","pi pi-pencil",1,"mr-2",3,"click","rounded","outlined"],["icon","pi pi-trash","severity","danger",3,"click","rounded","outlined"]],template:function(t,a){if(t&1){let c=I();r(0,"p-toolbar",6),x(1,ar,5,7,"ng-template",null,0,y)(3,lr,2,3,"ng-template",null,1,y),i(),r(5,"p-table",7,2),N("selectionChange",function(C){return _(c),O(a.selectedBrands,C)||(a.selectedBrands=C),v(C)}),x(7,pr,8,6,"ng-template",null,3,y)(9,sr,15,9,"ng-template",null,4,y)(11,cr,13,9,"ng-template",null,5,y),i(),r(13,"p-dialog",8),N("visibleChange",function(C){return _(c),O(a.brandDialog,C)||(a.brandDialog=C),v(C)}),r(14,"form",9),b("ngSubmit",function(){return _(c),v(a.onSaveBrand())}),r(15,"div",10)(16,"label",11),d(17),l(18,"translate"),i(),m(19,"input",12),i(),r(20,"div",13)(21,"label",14),d(22),l(23,"translate"),i(),m(24,"input",15),i(),r(25,"div",16)(26,"label",17),d(27),l(28,"translate"),i(),r(29,"p-fileupload",18),l(30,"translate"),b("onSelect",function(C){return _(c),v(a.onSelectImage(C))}),i()(),r(31,"div",19)(32,"p-button",20),l(33,"translate"),b("click",function(){return _(c),v(a.brandDialog=!1)}),i(),m(34,"p-button",21),l(35,"translate"),i()()(),m(36,"p-toast")(37,"p-confirm-dialog")}t&2&&(n(5),s("value",a.brandList)("rows",10)("columns",a.cols)("loading",a.loading)("globalFilterFields",P(35,ir))("tableStyle",P(36,rr)),V("selection",a.selectedBrands),s("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",P(37,nr)),n(8),Y(P(38,or)),V("visible",a.brandDialog),s("header",a.dialogHeader)("modal",!0),n(),s("formGroup",a.brandForm),n(3),g(p(18,23,"NAME")),n(5),g(p(23,25,"DESCRIPTION")),n(5),g(p(28,27,"IMAGE")),n(2),s("chooseLabel",p(30,29,"CHOOSE_FILE")),n(3),s("label",p(33,31,"CANCEL")),n(2),s("label",p(35,33,"SAVE"))("loading",a.saveLoading))},dependencies:[R,ae,fe,ge,_e,ve,be,T,Z,X,A,J,ie,ee,te,W,M,$,Q,he,Ce,H,G,le,ye,Se,oe,q,ne,j,F,B,nt,Re,Fe,xe],encapsulation:2})};var dr=()=>["name","description"],mr=()=>({"min-width":"75rem"}),ur=()=>[10,20,30],fr=()=>({width:"450px"});function gr(o,e){if(o&1){let t=I();r(0,"div",18)(1,"p-button",19),l(2,"translate"),b("onClick",function(){_(t);let c=f();return v(c.openNew())}),i(),r(3,"p-button",20),l(4,"translate"),b("onClick",function(){_(t);let c=f();return v(c.deleteSelectedUnits())}),i()()}if(o&2){let t=f();n(),s("label",p(2,3,"ADD")),n(2),s("label",p(4,5,"DELETE"))("disabled",!t.selectedUnits||!t.selectedUnits.length)}}function _r(o,e){o&1&&(m(0,"p-button",21),l(1,"translate")),o&2&&s("label",p(1,1,"EXPORT"))}function vr(o,e){if(o&1){let t=I();r(0,"div",22)(1,"h5",23),d(2),l(3,"translate"),i(),r(4,"p-iconfield"),m(5,"p-inputicon",24),r(6,"input",25),l(7,"translate"),b("input",function(c){_(t);let u=f(),C=K(6);return v(u.onGlobalFilter(C,c))}),i()()()}o&2&&(n(2),g(p(3,2,"PRODUCT_BRANDS")),n(4),s("placeholder",p(7,4,"SEARCH_PACEHOLDER")))}function br(o,e){o&1&&(r(0,"tr")(1,"th",26),m(2,"p-tableHeaderCheckbox"),i(),r(3,"th",27),d(4),l(5,"translate"),m(6,"p-sortIcon",28),i(),r(7,"th",29),d(8),l(9,"translate"),m(10,"p-sortIcon",30),i(),m(11,"th"),i()),o&2&&(n(4),S(" ",p(5,2,"CODE")," "),n(4),S(" ",p(9,4,"NAME")," "))}function Cr(o,e){if(o&1){let t=I();r(0,"tr")(1,"td",26),m(2,"p-tableCheckbox",31),i(),r(3,"td"),d(4),i(),r(5,"td"),d(6),i(),r(7,"td")(8,"div",32)(9,"p-button",33),b("click",function(){let c=_(t).$implicit,u=f();return v(u.editUnit(c))}),i(),r(10,"p-button",34),b("click",function(){let c=_(t).$implicit,u=f();return v(u.deleteUnit(c))}),i()()()()}if(o&2){let t=e.$implicit;n(2),s("value",t),n(2),S(" ",t.code," "),n(2),S(" ",t.name," "),n(3),s("rounded",!0)("outlined",!0),n(),s("rounded",!0)("outlined",!0)}}var St=class o{constructor(e,t,a){this.unitService=e;this.toast=t;this.translate=a}unitDialog=!1;dialogHeader="Create Product Unit";loading=!1;saveLoading=!1;pageReq=new Ie(0,10);unitList=[];unit;selectedUnits;cols;imageFile;unitForm;mode;ngOnInit(){this.getUnits(),this.initunitForm()}getUnits(){this.unitService.getAllUnits().subscribe(e=>{e.success&&(this.unitList=e.data)})}initunitForm(){this.unitForm=new De({code:new se(null,[w.required]),name:new se(null)})}onSaveUnit(){if(this.unitForm.invalid){this.toast.showWarn(this.translate.instant("REQUIRED_FIELDS_MSG"));return}this.mode==="update"?this.updateUnit():this.createUnit()}updateUnit(){this.saveLoading=!0,this.unitService.updateProductUnit({unitOfMeasureId:this.unit.unitOfMeasureId,code:this.unitForm.value.code,name:this.unitForm.value.name}).subscribe(e=>{e.success?(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.getUnits(),this.unitForm.reset(),this.unitDialog=!1):this.toast.showError(e.message),this.saveLoading=!1})}createUnit(){this.saveLoading=!0,this.unitService.createProductUnit({code:this.unitForm.value.code,name:this.unitForm.value.name}).subscribe(e=>{e.success?(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.getUnits(),this.unitForm.reset(),this.unitDialog=!1):this.toast.showError(e.message),this.saveLoading=!1})}editUnit(e){this.unit=e,this.mode="update",this.unitDialog=!0,this.dialogHeader=e.name,this.unitForm.patchValue({code:e.code,name:e.name})}deleteUnit(e){}openNew(){this.unitDialog=!0}deleteSelectedUnits(){}onGlobalFilter(e,t){e.filterGlobal(t.target.value,"contains")}onSelectImage(e){e.currentFiles&&(this.imageFile=e.currentFiles[0])}static \u0275fac=function(t){return new(t||o)(h(Oe),h(z),h(D))};static \u0275cmp=E({type:o,selectors:[["app-product-units"]],decls:32,vars:33,consts:[["start",""],["end",""],["dt",""],["caption",""],["header",""],["body",""],["styleClass","mb-6"],["dataKey","unitOfMeasureId","paginator","true","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} units",3,"selectionChange","value","rows","columns","loading","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","rowsPerPageOptions"],[3,"visibleChange","visible","header","modal"],[3,"ngSubmit","formGroup"],[1,"flex","items-center","gap-4","mb-4"],["for","code",1,"font-semibold","w-24"],["formControlName","code","pInputText","","id","code","autocomplete","off",1,"flex-auto"],["for","name",1,"font-semibold","w-24"],["formControlName","name","pInputText","","id","name","autocomplete","off",1,"flex-auto"],[1,"flex","justify-end","gap-2"],["severity","secondary",3,"click","label"],["type","submit",3,"label","loading"],[1,"flex","items-center","gap-2"],["icon","pi pi-plus","severity","secondary",1,"mr-2",3,"onClick","label"],["severity","secondary","icon","pi pi-trash","outlined","",3,"onClick","label","disabled"],["icon","pi pi-upload","severity","secondary",3,"label"],[1,"flex","items-center","justify-between"],[1,"m-0"],["styleClass","pi pi-search"],["pInputText","","type","text",3,"input","placeholder"],[2,"width","3rem"],["pSortableColumn","code"],["field","code"],["pSortableColumn","name"],["field","name"],[3,"value"],[1,"flex","gap-2","items-center"],["icon","pi pi-pencil",1,"mr-2",3,"click","rounded","outlined"],["icon","pi pi-trash","severity","danger",3,"click","rounded","outlined"]],template:function(t,a){if(t&1){let c=I();r(0,"p-toolbar",6),x(1,gr,5,7,"ng-template",null,0,y)(3,_r,2,3,"ng-template",null,1,y),i(),r(5,"p-table",7,2),N("selectionChange",function(C){return _(c),O(a.selectedUnits,C)||(a.selectedUnits=C),v(C)}),x(7,vr,8,6,"ng-template",null,3,y)(9,br,12,6,"ng-template",null,4,y)(11,Cr,11,7,"ng-template",null,5,y),i(),r(13,"p-dialog",8),N("visibleChange",function(C){return _(c),O(a.unitDialog,C)||(a.unitDialog=C),v(C)}),r(14,"form",9),b("ngSubmit",function(){return _(c),v(a.onSaveUnit())}),r(15,"div",10)(16,"label",11),d(17),l(18,"translate"),i(),m(19,"input",12),i(),r(20,"div",10)(21,"label",13),d(22),l(23,"translate"),i(),m(24,"input",14),i(),r(25,"div",15)(26,"p-button",16),l(27,"translate"),b("click",function(){return _(c),v(a.unitDialog=!1)}),i(),m(28,"p-button",17),l(29,"translate"),i()()(),m(30,"p-toast")(31,"p-confirm-dialog")}t&2&&(n(5),s("value",a.unitList)("rows",10)("columns",a.cols)("loading",a.loading)("globalFilterFields",P(29,dr))("tableStyle",P(30,mr)),V("selection",a.selectedUnits),s("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",P(31,ur)),n(8),Y(P(32,fr)),V("visible",a.unitDialog),s("header",a.dialogHeader)("modal",!0),n(),s("formGroup",a.unitForm),n(3),g(p(18,21,"CODE")),n(5),g(p(23,23,"NAME")),n(4),s("label",p(27,25,"CANCEL")),n(2),s("label",p(29,27,"SAVE"))("loading",a.saveLoading))},dependencies:[R,ae,fe,ge,_e,ve,be,T,Z,X,A,J,ie,ee,te,W,M,$,Q,he,Ce,H,G,le,ye,Se,oe,q,ne,j,F,B,xe],encapsulation:2})};var hr=()=>["/products/list"],Sr=o=>["/products/edit",o];function yr(o,e){o&1&&(r(0,"div",9),m(1,"p-skeleton",10),r(2,"div"),m(3,"p-skeleton",11)(4,"p-skeleton",12)(5,"p-skeleton",13)(6,"p-skeleton",13)(7,"p-skeleton",13)(8,"p-skeleton",14)(9,"p-skeleton",14)(10,"p-skeleton",15),i()())}function xr(o,e){if(o&1&&m(0,"img",37),o&2){let t=f(2);s("src",t.getPrimaryImageSrc(t.product),L)}}function Ir(o,e){if(o&1&&m(0,"img",38),o&2){let t=e.$implicit,a=f(2);s("src",a.getProductImageSrc(a.product.productId,t),L)}}function Pr(o,e){if(o&1&&m(0,"img",39),o&2){let t=e.$implicit,a=f(2);s("src",a.getProductImageSrc(a.product.productId,t),L)}}function Er(o,e){if(o&1&&(r(0,"div",40),m(1,"i",41),r(2,"span"),d(3),i()()),o&2){let t=f(2);n(3),g(t.product.basicDetails.productCategory.name)}}function wr(o,e){if(o&1&&(r(0,"div",40),m(1,"i",42),r(2,"span"),d(3),i()()),o&2){let t=f(2);n(3),g(t.product.basicDetails.productBrand.name)}}function Tr(o,e){if(o&1&&(r(0,"div",40),m(1,"i",43),r(2,"span"),d(3),i()()),o&2){let t=f(2);n(3),g(t.product.basicDetails.unitOfMeasure.name)}}function Dr(o,e){if(o&1&&(r(0,"div",16)(1,"div",9)(2,"div",17),x(3,xr,1,1,"img",18),r(4,"p-galleria",19),x(5,Ir,1,1,"ng-template",null,0,y)(7,Pr,1,1,"ng-template",null,1,y),i()(),r(9,"div",20)(10,"div",21)(11,"div",22),m(12,"span",23),r(13,"span"),d(14),l(15,"translate"),i()(),r(16,"div",24),m(17,"p-button",25),l(18,"translate"),m(19,"p-button",26),l(20,"translate"),i()(),r(21,"div",6),d(22),i(),r(23,"div",27),x(24,Er,4,1,"div",28)(25,wr,4,1,"div",28)(26,Tr,4,1,"div",28),i(),r(27,"div",29)(28,"span"),d(29),l(30,"translate"),i(),m(31,"p-tag",30),i(),r(32,"div",29)(33,"span"),d(34),l(35,"translate"),i(),r(36,"span"),d(37),l(38,"sCurrency"),i()(),r(39,"div",29)(40,"span"),d(41),l(42,"translate"),i(),r(43,"span"),d(44),l(45,"sCurrency"),i()(),r(46,"div",29)(47,"span"),d(48),l(49,"translate"),i(),r(50,"span",31),d(51),l(52,"translate"),i()(),r(53,"div",29)(54,"span"),d(55),l(56,"translate"),i(),r(57,"span"),d(58),l(59,"translate"),l(60,"translate"),i()(),r(61,"div",29)(62,"span"),d(63),l(64,"translate"),i(),r(65,"span",32),d(66),l(67,"sCurrency"),i()(),r(68,"div",33),m(69,"span",34),r(70,"span"),d(71),i()(),r(72,"div",35),m(73,"ngx-barcode6",36),i()()()()),o&2){let t=f();n(3),s("ngIf",!(t.product.basicDetails.productImages!=null&&t.product.basicDetails.productImages.length)),n(),s("value",t.product.basicDetails.productImages)("showItemNavigators",!0)("responsiveOptions",t.responsiveOptions)("circular",!0)("numVisible",5),n(7),s("routerLink",P(67,hr)),n(3),g(p(15,37,"BACK_TO_LIST")),n(3),s("routerLink",ze(68,Sr,t.product.productId))("pTooltip",p(18,39,"EDIT"))("rounded",!0)("text",!0),n(2),s("pTooltip",p(20,41,"DELETE"))("rounded",!0)("text",!0),n(3),S(" ",t.product.basicDetails.productName," "),n(2),s("ngIf",t.product.basicDetails.productCategory),n(),s("ngIf",t.product.basicDetails.productBrand),n(),s("ngIf",t.product.basicDetails.unitOfMeasure),n(3),S("",p(30,43,"QUANTITY"),":"),n(2),s("value",t.product.basicDetails.quantity+"")("severity",t.getQuantitySeverity(t.product)),n(3),S("",p(35,45,"COST"),":"),n(3),g(p(38,47,t.product.priceDetails.costPrice)),n(4),S("",p(42,49,"PRICE"),":"),n(3),g(p(45,51,t.product.priceDetails.sellingPrice)),n(4),S("",p(49,53,"DISCOUNT"),":"),n(3),g(t.getDiscountLabel(t.product)||p(52,55,"NO_EXIST")),n(4),S("",p(56,57,"DISCOUNT_ACTIVE"),":"),n(3),g(t.product.priceDetails.discountRangeActive?p(59,59,"YES"):p(60,61,"NO")),n(5),S("",p(64,63,"PRICE_AFTER_DISCOUNT"),":"),n(3),g(p(67,65,t.product.priceDetails.priceWithDiscount)),n(5),g(t.product.basicDetails.barcode),n(2),s("bc-width",2)("bc-height",30)("bc-format","CODE128")("bc-value",t.product.basicDetails.barcode)}}function Br(o,e){o&1&&(r(0,"div",9),m(1,"p-skeleton",44)(2,"p-skeleton",44)(3,"p-skeleton",44)(4,"p-skeleton",44),i())}function Fr(o,e){if(o&1&&(r(0,"div",9)(1,"div",45)(2,"div",46)(3,"span",47),d(4),l(5,"translate"),i(),r(6,"div",48),m(7,"i",49),i()(),r(8,"div",50)(9,"span"),d(10),i(),r(11,"span",51),d(12),i()()(),r(13,"div",45)(14,"div",46)(15,"span",47),d(16),l(17,"translate"),i(),r(18,"div",52),m(19,"i",53),i()(),r(20,"div",50)(21,"span"),d(22),l(23,"sCurrency"),i()()(),r(24,"div",45)(25,"div",46)(26,"span",47),d(27),l(28,"translate"),i(),r(29,"div",54),m(30,"i",55),i()(),r(31,"div",50)(32,"span"),d(33),l(34,"sCurrency"),i()()(),r(35,"div",45)(36,"div",46)(37,"span",47),d(38),l(39,"translate"),i(),r(40,"div",56),m(41,"i",57),i()(),r(42,"div",50)(43,"span"),d(44),l(45,"sCurrency"),i()()()()),o&2){let t=f();n(4),g(p(5,9,"SOLD_UNITS")),n(6),g((t.productStat==null?null:t.productStat.totalSoldUnits)||0),n(2),g(t.product.basicDetails.unitOfMeasure==null?null:t.product.basicDetails.unitOfMeasure.code),n(4),g(p(17,11,"TOTAL_SALES")),n(6),g(p(23,13,(t.productStat==null?null:t.productStat.totalSoldAmount)||0)),n(5),g(p(28,15,"TOTAL_REVENUE")),n(6),g(p(34,17,(t.productStat==null?null:t.productStat.totalRevenue)||0)),n(5),g(p(39,19,"TOTAL_COST")),n(6),g(p(45,21,(t.productStat==null?null:t.productStat.totalCost)||0))}}var yt=class o{constructor(e,t,a,c){this.productService=e;this.route=t;this.translate=a;this.router=c}product;productStat;loading=!1;statLoading=!1;stRange="day";stOptions=[];responsiveOptions=[{breakpoint:"1300px",numVisible:4},{breakpoint:"575px",numVisible:1}];ngOnInit(){this.fetchProductDetails(),this.initOptions()}initOptions(){this.stOptions=[{label:this.translate.instant("TODAY"),value:"day"},{label:this.translate.instant("LAST_WEEK"),value:"week"},{label:this.translate.instant("LAST_MONTH"),value:"month"},{label:this.translate.instant("LAST_YEAR"),value:"year"}]}fetchProductDetails(){this.loading=!0;let e=this.route.snapshot.paramMap.get("productId");if(e){let t=Number.parseInt(e);t&&Number.isInteger(t)&&this.productService.getProductById(t).subscribe(a=>{a.success?(this.product=a.data,this.getProductStatistics()):this.router.navigate(["/notfound"]),this.loading=!1})}}getProductStatistics(){this.statLoading=!0,this.productService.getProductStatistics(this.product.productId,this.stRange).subscribe(e=>{e.success&&(this.productStat=e.data),this.statLoading=!1})}getProductImageSrc(e,t){return U.getImageSrc(e,t)}getQuantitySeverity(e){return U.getQuantitySeverity(e)}getDiscountLabel(e){return U.getDiscountLabel(e)}getPrimaryImageSrc(e){return U.getFirstImageSrc(e)}onChangeCriteria(e){this.stRange=e.value,this.getProductStatistics()}static \u0275fac=function(t){return new(t||o)(h(pe),h(Ke),h(D),h(Te))};static \u0275cmp=E({type:o,selectors:[["app-product-details"]],decls:13,vars:9,consts:[["item",""],["thumbnail",""],["class","flex gap-4",4,"ngIf"],["class","product-details w-full mb-4",4,"ngIf"],[1,"statistics","mt-4"],[1,"title","flex","gap-6"],[1,"text-lg","font-bold"],[1,"pi","pi-chart-line"],[1,"mb-4",3,"onChange","disabled","options"],[1,"flex","gap-4"],["width","40rem","height","30rem"],["width","20rem","height","2rem","styleClass","mb-2"],["width","10rem","styleClass","mb-2"],["width","5rem","styleClass","mb-2"],["width","20rem","styleClass","mb-2"],["width","10rem","height","3rem","styleClass","mb-2"],[1,"product-details","w-full","mb-4"],[1,"image-slider",2,"width","50%"],["alt","",3,"src",4,"ngIf"],[3,"value","showItemNavigators","responsiveOptions","circular","numVisible"],[1,"basic",2,"width","50%"],[1,"actions","flex","items-center","justify-between"],[1,"back","flex","gap-2","items-center","cursor-pointer","mb-2","text-surface-300",3,"routerLink"],[1,"pi","pi-arrow-left"],[1,"flex","gap-1","justify-between"],["tooltipPosition","top","icon","pi pi-pencil","severity","success",3,"routerLink","pTooltip","rounded","text"],["tooltipPosition","top","icon","pi pi-trash","severity","danger",3,"pTooltip","rounded","text"],[1,"flex","gap-6","mb-4"],["class","ml-2 text-surface-500 text-sm flex gap-2 items-center",4,"ngIf"],[1,"flex","gap-2","items-center","mb-2"],[3,"value","severity"],[1,"text-orange-500"],[1,"text-primary"],[1,"flex","gap-2","items-center","mb-2","mt-6"],[1,"pi","pi-barcode"],[1,"barcode"],[3,"bc-width","bc-height","bc-format","bc-value"],["alt","",3,"src"],[2,"height","20rem","object-fit","cover","display","block",3,"src"],[2,"width","3rem","display","block",3,"src"],[1,"ml-2","text-surface-500","text-sm","flex","gap-2","items-center"],[1,"pi","pi-clone"],[1,"pi","pi-tags"],[1,"pi","pi-gauge"],["width","12rem","height","5rem"],[1,"st-card","p-4","rounded-border","bg-surface-100","dark:bg-surface-800"],[1,"flex","gap-4","justify-between"],[1,"block","text-muted-color"],[1,"flex","items-center","justify-center","bg-blue-200","dark:bg-blue-400/10","rounded-border",2,"width","2.5rem","height","2.5rem"],[1,"pi","pi-shopping-cart","text-blue-500","!text-xl"],[1,"val","ml-2"],[1,"ml-1","text-sm","text-muted-color"],[1,"flex","items-center","justify-center","bg-yellow-200","dark:bg-yellow-400/10","rounded-border",2,"width","2.5rem","height","2.5rem"],[1,"pi","pi-dollar","text-yellow-500","!text-xl"],[1,"flex","items-center","justify-center","bg-green-200","dark:bg-green-400/10","rounded-border",2,"width","2.5rem","height","2.5rem"],[1,"pi","pi-arrow-right-arrow-left","text-green-500","!text-xl"],[1,"flex","items-center","justify-center","bg-orange-200","dark:bg-orange-400/10","rounded-border",2,"width","2.5rem","height","2.5rem"],[1,"pi","pi-dollar","text-orange-500","!text-xl"]],template:function(t,a){t&1&&(r(0,"p-card"),x(1,yr,11,0,"div",2)(2,Dr,74,70,"div",3),m(3,"br"),r(4,"div",4)(5,"div",5)(6,"div",6),m(7,"i",7),d(8),l(9,"translate"),i(),r(10,"p-select",8),b("onChange",function(u){return a.onChangeCriteria(u)}),i()(),x(11,Br,5,0,"div",2)(12,Fr,46,23,"div",2),i()()),t&2&&(n(),s("ngIf",a.loading),n(),s("ngIf",a.product&&!a.loading),n(6),S(" ",p(9,7,"STATISTICS")," "),n(2),s("disabled",a.statLoading)("options",a.stOptions),n(),s("ngIf",a.statLoading),n(),s("ngIf",!a.statLoading&&a.product))},dependencies:[W,M,R,we,T,oe,ne,H,st,Me,tt,Zt,Jt,F,B,ae,At,pt,lt,Be,Ze,je,Vt,Je],styles:["[_nghost-%COMP%]     .p-galleria{border:none!important;box-shadow:none!important}"]})};function Rr(o,e){if(o&1){let t=I();r(0,"div",5),d(1),l(2,"translate"),i(),r(3,"div",6)(4,"p-iconfield"),m(5,"p-inputicon",7),r(6,"input",8,1),l(8,"translate"),b("keydown.enter",function(){_(t);let c=K(7),u=f();return v(u.onSearch(c.value))}),N("ngModelChange",function(c){_(t);let u=f();return O(u.barcode,c)||(u.barcode=c),v(c)}),i()()()}if(o&2){let t=f();n(),S(" ",p(2,3,"QUICK_PRODUCTS_UPDATE")," "),n(5),s("placeholder",p(8,5,"SCAN_BARCODE_HINT")),V("ngModel",t.barcode)}}var xt=class o{constructor(e,t,a){this.productService=e;this.translate=t;this.toast=a}loading=!1;product;barcode;onScanBarcodeChanges(e){if(this.loading)return;this.loading=!0;let t=e.codeResult.code.trim();this.findProductByBarcode(t)}findProductByBarcode(e){this.productService.getProductByBarcode(e).subscribe(t=>{t.success?this.product=t.data:(this.toast.showError(this.translate.instant("PRODUCT_NOT_FOUND")),this.loading=!1)})}onSearch(e){!e||!e.length||this.findProductByBarcode(e)}static \u0275fac=function(t){return new(t||o)(h(pe),h(D),h(z))};static \u0275cmp=E({type:o,selectors:[["app-quick-stock-update"]],decls:7,vars:1,consts:[["header",""],["barcodeIn",""],["styleClass","p-4"],[1,"font-bold"],["type","code_128",3,"valueChanges"],[1,"mb-4","font-bold","text-xl"],[1,"mb-4","w-full","flex","justify-center"],["styleClass","pi pi-barcode"],["pInputText","","id","barcode","type","text",3,"keydown.enter","ngModelChange","placeholder","ngModel"]],template:function(t,a){if(t&1){let c=I();r(0,"p-card",2),x(1,Rr,9,7,"ng-template",null,0,y),r(3,"div",3),d(4),i()(),m(5,"p-toast"),r(6,"barcode-scanner-livestream",4),b("valueChanges",function(C){return _(c),v(a.onScanBarcodeChanges(C))}),i()}t&2&&(n(4),S(" ",a.product==null||a.product.basicDetails==null?null:a.product.basicDetails.productName," "))},dependencies:[T,X,A,Ot,q,G,j,Me,Q,F,B,dt,ct],encapsulation:2})};var Mr=[{path:"list",component:gt,canActivate:[ce],data:{perms:["perm.access.product"]}},{path:"new",component:We,canActivate:[ce],data:{perms:["perm.create.product"]}},{path:"edit/:productId",component:We,canActivate:[ce],data:{perms:["perm.create.product"]}},{path:"detail/:productId",component:yt,canActivate:[ce],data:{perms:["perm.access.product"]}},{path:"categories",component:Ct,canActivate:[ce],data:{perms:["perm.access.category"]}},{path:"brands",component:ht,canActivate:[ce],data:{perms:["perm.access.product"]}},{path:"units",component:St,canActivate:[ce],data:{perms:["perm.access.product"]}},{path:"quick-update",component:xt,canActivate:[ce],data:{perms:["perm.access.product"]}}],It=class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=$e({type:o});static \u0275inj=Qe({imports:[je.forChild(Mr),je]})};var pi=class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=$e({type:o});static \u0275inj=Qe({imports:[R,It]})};export{pi as ProductsModule};
