import{a as he,b as ve,c as we,d as be,e as Me,f as Te}from"./chunk-IPGJPCA7.js";import{c as Se,e as Ce,f as ye}from"./chunk-RVWQYIQS.js";import"./chunk-2CRVAWPL.js";import{b as ue}from"./chunk-LVVCGXCS.js";import{a as Ve}from"./chunk-BGLM7VYL.js";import{a as b,c as re,d as se,e as ae}from"./chunk-TGB364TN.js";import{b as fe,c as xe}from"./chunk-7G2FJQ27.js";import{d as pe,i as le,m as me}from"./chunk-XBK3DIBG.js";import{m as D}from"./chunk-RL6IEZWP.js";import{Ia as ee,La as te,Pa as ie,Ra as ne,Xa as oe,b as U,ob as ce,pb as _e,qb as ge,sb as de}from"./chunk-AQJP2JMO.js";import{Db as l,Eb as c,Fb as w,Gb as W,Hb as N,Jb as d,Lb as g,Mb as o,Pc as K,Qc as Q,Rc as X,Sc as Z,U as I,Ua as p,V as F,Va as T,Yb as v,Z as L,Zb as k,Zc as O,_b as P,ac as y,bc as f,cc as x,ec as E,fb as J,gb as B,ha as _,ia as m,mb as h,oc as u,p as z,pc as S,tb as C,ub as a,v as Y,xb as V}from"./chunk-HRECHPDI.js";import"./chunk-EQDQRRRY.js";var $=class{key;value};var A=class i{constructor(s){this.http=s}baseUrl=b.apiBaseUrl+"/setting";getSettingsByCategory(s){return this.http.get(`${this.baseUrl}/category?type=${s}`)}updateSettings(s){return this.http.put(this.baseUrl,s)}static \u0275fac=function(e){return new(e||i)(L(U))};static \u0275prov=I({token:i,factory:i.\u0275fac,providedIn:"root"})};var j=class i{constructor(s){this.http=s}baseUrl=b.apiBaseUrl+"/resource";uploadStaticFile(s){let e=new FormData;return e.append("file",s),this.http.post(this.baseUrl,e)}static \u0275fac=function(e){return new(e||i)(L(U))};static \u0275prov=I({token:i,factory:i.\u0275fac,providedIn:"root"})};var Le=()=>({height:"3px"}),q=()=>({width:"50%"});function Be(i,s){i&1&&w(0,"p-progressbar",13),i&2&&V(E(2,Le))}function We(i,s){if(i&1){let e=d();l(0,"input",22),x("ngModelChange",function(t){_(e);let n=o().$implicit;return f(n.value,t)||(n.value=t),m(t)}),g("ngModelChange",function(){_(e);let t=o().$implicit,n=o();return m(n.settingChange(t))}),c()}if(i&2){let e=o().$implicit;a("id",e.key),y("ngModel",e.value),C("id",e.key)}}function Ne(i,s){if(i&1){let e=d();l(0,"input",23),x("ngModelChange",function(t){_(e);let n=o().$implicit;return f(n.value,t)||(n.value=t),m(t)}),g("ngModelChange",function(){_(e);let t=o().$implicit,n=o();return m(n.settingChange(t))}),c()}if(i&2){let e=o().$implicit;a("id",e.key),y("ngModel",e.value),C("id",e.key)}}function Pe(i,s){if(i&1){let e=d();l(0,"p-checkbox",24),x("ngModelChange",function(t){_(e);let n=o().$implicit;return f(n.value,t)||(n.value=t),m(t)}),g("ngModelChange",function(){_(e);let t=o().$implicit,n=o();return m(n.settingChange(t))}),c()}if(i&2){let e=o().$implicit;a("id",e.key)("falseValue","false")("trueValue","true"),y("ngModel",e.value),C("id",e.key)}}function Oe(i,s){if(i&1){let e=d();l(0,"p-fileupload",25),u(1,"translate"),g("onSelect",function(t){_(e);let n=o().$implicit,M=o();return m(M.onSelectFile(n,t))}),c()}if(i&2){let e=o().$implicit,r=o();a("id",e.key)("chooseLabel",S(1,3,"CHOOSE_FILE"))("url",r.getUploadPath())}}function Ue(i,s){if(i&1){let e=d();l(0,"p-select",26),x("ngModelChange",function(t){_(e);let n=o().$implicit;return f(n.value,t)||(n.value=t),m(t)}),g("onChange",function(){_(e);let t=o().$implicit,n=o();return m(n.settingChange(t))}),c()}if(i&2){let e=o().$implicit;V(E(6,q)),a("id",e.key)("options",e.options),y("ngModel",e.value),C("id",e.key)}}function $e(i,s){if(i&1&&(l(0,"div")(1,"div",14)(2,"label",15),v(3),u(4,"translate"),c(),W(5,16),h(6,We,1,3,"input",17)(7,Ne,1,3,"input",18)(8,Pe,1,5,"p-checkbox",19)(9,Oe,2,5,"p-fileupload",20)(10,Ue,1,7,"p-select",21),N(),c()()),i&2){let e=s.$implicit;p(2),a("for",e.key),p(),k(S(4,8,e.key)),p(2),a("ngSwitch",e.type),p(),a("ngSwitchCase","STRING"),p(),a("ngSwitchCase","NUMBER"),p(),a("ngSwitchCase","BOOLEAN"),p(),a("ngSwitchCase","IMAGE"),p(),a("ngSwitchCase","SELECT")}}function Ae(i,s){if(i&1){let e=d();l(0,"input",22),x("ngModelChange",function(t){_(e);let n=o().$implicit;return f(n.value,t)||(n.value=t),m(t)}),g("ngModelChange",function(){_(e);let t=o().$implicit,n=o();return m(n.settingChange(t))}),c()}if(i&2){let e=o().$implicit;a("id",e.key),y("ngModel",e.value),C("id",e.key)}}function Re(i,s){if(i&1){let e=d();l(0,"input",23),x("ngModelChange",function(t){_(e);let n=o().$implicit;return f(n.value,t)||(n.value=t),m(t)}),g("ngModelChange",function(){_(e);let t=o().$implicit,n=o();return m(n.settingChange(t))}),c()}if(i&2){let e=o().$implicit;a("id",e.key),y("ngModel",e.value),C("id",e.key)}}function je(i,s){if(i&1){let e=d();l(0,"p-checkbox",24),x("ngModelChange",function(t){_(e);let n=o().$implicit;return f(n.value,t)||(n.value=t),m(t)}),g("ngModelChange",function(){_(e);let t=o().$implicit,n=o();return m(n.settingChange(t))}),c()}if(i&2){let e=o().$implicit;a("id",e.key)("falseValue","false")("trueValue","true"),y("ngModel",e.value),C("id",e.key)}}function Ge(i,s){if(i&1){let e=d();l(0,"p-fileupload",25),u(1,"translate"),g("onSelect",function(t){_(e);let n=o().$implicit,M=o();return m(M.onSelectFile(n,t))}),c()}if(i&2){let e=o().$implicit,r=o();a("id",e.key)("chooseLabel",S(1,3,"CHOOSE_FILE"))("url",r.getUploadPath())}}function He(i,s){if(i&1){let e=d();l(0,"p-select",26),x("ngModelChange",function(t){_(e);let n=o().$implicit;return f(n.value,t)||(n.value=t),m(t)}),g("onChange",function(){_(e);let t=o().$implicit,n=o();return m(n.settingChange(t))}),c()}if(i&2){let e=o().$implicit;V(E(6,q)),a("id",e.key)("options",e.options),y("ngModel",e.value),C("id",e.key)}}function De(i,s){if(i&1&&(l(0,"div")(1,"div",14)(2,"label",15),v(3),u(4,"translate"),c(),W(5,16),h(6,Ae,1,3,"input",17)(7,Re,1,3,"input",18)(8,je,1,5,"p-checkbox",19)(9,Ge,2,5,"p-fileupload",20)(10,He,1,7,"p-select",21),N(),c()()),i&2){let e=s.$implicit;p(2),a("for",e.key),p(),k(S(4,8,e.key)),p(2),a("ngSwitch",e.type),p(),a("ngSwitchCase","STRING"),p(),a("ngSwitchCase","NUMBER"),p(),a("ngSwitchCase","BOOLEAN"),p(),a("ngSwitchCase","IMAGE"),p(),a("ngSwitchCase","SELECT")}}function qe(i,s){if(i&1){let e=d();l(0,"input",22),x("ngModelChange",function(t){_(e);let n=o().$implicit;return f(n.value,t)||(n.value=t),m(t)}),g("ngModelChange",function(){_(e);let t=o().$implicit,n=o();return m(n.settingChange(t))}),c()}if(i&2){let e=o().$implicit;a("id",e.key),y("ngModel",e.value),C("id",e.key)}}function ze(i,s){if(i&1){let e=d();l(0,"input",23),x("ngModelChange",function(t){_(e);let n=o().$implicit;return f(n.value,t)||(n.value=t),m(t)}),g("ngModelChange",function(){_(e);let t=o().$implicit,n=o();return m(n.settingChange(t))}),c()}if(i&2){let e=o().$implicit;a("id",e.key),y("ngModel",e.value),C("id",e.key)}}function Ye(i,s){if(i&1){let e=d();l(0,"p-checkbox",24),x("ngModelChange",function(t){_(e);let n=o().$implicit;return f(n.value,t)||(n.value=t),m(t)}),g("ngModelChange",function(){_(e);let t=o().$implicit,n=o();return m(n.settingChange(t))}),c()}if(i&2){let e=o().$implicit;a("id",e.key)("falseValue","false")("trueValue","true"),y("ngModel",e.value),C("id",e.key)}}function Je(i,s){if(i&1){let e=d();l(0,"p-fileupload",25),u(1,"translate"),g("onSelect",function(t){_(e);let n=o().$implicit,M=o();return m(M.onSelectFile(n,t))}),c()}if(i&2){let e=o().$implicit,r=o();a("id",e.key)("chooseLabel",S(1,3,"CHOOSE_FILE"))("url",r.getUploadPath())}}function Ke(i,s){if(i&1){let e=d();l(0,"p-select",26),x("ngModelChange",function(t){_(e);let n=o().$implicit;return f(n.value,t)||(n.value=t),m(t)}),g("onChange",function(){_(e);let t=o().$implicit,n=o();return m(n.settingChange(t))}),c()}if(i&2){let e=o().$implicit;V(E(6,q)),a("id",e.key)("options",e.options),y("ngModel",e.value),C("id",e.key)}}function Qe(i,s){if(i&1&&(l(0,"div")(1,"div",14)(2,"label",15),v(3),u(4,"translate"),c(),W(5,16),h(6,qe,1,3,"input",17)(7,ze,1,3,"input",18)(8,Ye,1,5,"p-checkbox",19)(9,Je,2,5,"p-fileupload",20)(10,Ke,1,7,"p-select",21),N(),c()()),i&2){let e=s.$implicit;p(2),a("for",e.key),p(),k(S(4,8,e.key)),p(2),a("ngSwitch",e.type),p(),a("ngSwitchCase","STRING"),p(),a("ngSwitchCase","NUMBER"),p(),a("ngSwitchCase","BOOLEAN"),p(),a("ngSwitchCase","IMAGE"),p(),a("ngSwitchCase","SELECT")}}var G=class i{constructor(s,e,r,t){this.settingService=s;this.fileService=e;this.translate=r;this.toast=t}settings=[];payloads=[];settingFiles=[];saveLoading=!1;loading=!1;settingCategory="setting.app";ngOnInit(){this.loadCategorySettings()}loadCategorySettings(){this.loading=!0,this.settingService.getSettingsByCategory(this.settingCategory.toString()).subscribe(s=>{s.success&&(this.settings=s.data),this.loading=!1})}settingChange(s){console.log(s);let e=this.payloads.find(r=>r.key===s.key);if(e)e.value=s.value;else{let r=new $;r.key=s.key,r.value=s.value,this.payloads.push(r)}}saveSettings(){if(this.saveLoading=!0,!this.settingFiles||this.settingFiles.length===0){this.updateSettingsWithPayloads();return}let s=this.settingFiles.map(e=>this.fileService.uploadStaticFile(e.file).pipe(z(r=>r.success?{key:e.key,value:r.data.fileName}:null)));Y(s).subscribe(e=>{let r=e.filter(t=>t!==null);this.payloads.push(...r),this.updateSettingsWithPayloads()})}updateSettingsWithPayloads(){this.settingService.updateSettings(this.payloads).subscribe(s=>{s.success&&(this.loadCategorySettings(),this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),window.location.reload()),this.saveLoading=!1})}getUploadPath(){return b.apiBaseUrl+"/resource"}onSelectFile(s,e){let r=this.settingFiles.find(t=>t.key===s.key);r?r.file=e.files[0]:this.settingFiles.push({key:s.key,file:e.files[0]})}onChangeTab(s){this.payloads=[],this.settingFiles=[],this.settingCategory=s,this.loadCategorySettings()}static \u0275fac=function(e){return new(e||i)(T(A),T(j),T(re),T(Ve))};static \u0275cmp=J({type:i,selectors:[["app-system-settings"]],decls:36,vars:28,consts:[[1,"card"],[1,"font-semibold","text-xl","mb-4"],["value","setting.app",3,"valueChange"],["value","setting.app"],[1,"pi","pi-cog"],["value","setting.company"],[1,"pi","pi-slack"],["value","setting.pos"],[1,"pi","pi-shop"],["class","mt-1","mode","indeterminate",3,"style",4,"ngIf"],[1,"p-grid","p-dir-col"],[4,"ngFor","ngForOf"],["pButton","","icon","pi pi-save",1,"p-button-primary",3,"click","label","loading"],["mode","indeterminate",1,"mt-1"],[1,"p-field","flex","gap-4","items-center","mb-4"],[1,"cursor-pointer",2,"width","16rem",3,"for"],[3,"ngSwitch"],["style","width: 75%;","pInputText","","class","p-inputtext p-component",3,"id","ngModel","ngModelChange",4,"ngSwitchCase"],["pInputText","","type","number","class","p-inputtext p-component",3,"id","ngModel","ngModelChange",4,"ngSwitchCase"],["binary","true",3,"id","falseValue","trueValue","ngModel","ngModelChange",4,"ngSwitchCase"],["mode","basic","chooseIcon","pi pi-upload","name","file","maxFileSize","10000000",3,"id","chooseLabel","url","onSelect",4,"ngSwitchCase"],["optionLabel","name","optionValue","value",3,"style","id","options","ngModel","ngModelChange","onChange",4,"ngSwitchCase"],["pInputText","",1,"p-inputtext","p-component",2,"width","75%",3,"ngModelChange","id","ngModel"],["pInputText","","type","number",1,"p-inputtext","p-component",3,"ngModelChange","id","ngModel"],["binary","true",3,"ngModelChange","id","falseValue","trueValue","ngModel"],["mode","basic","chooseIcon","pi pi-upload","name","file","maxFileSize","10000000",3,"onSelect","id","chooseLabel","url"],["optionLabel","name","optionValue","value",3,"ngModelChange","onChange","id","options","ngModel"]],template:function(e,r){e&1&&(l(0,"div",0)(1,"div",1),v(2),u(3,"translate"),c(),l(4,"p-tabs",2),g("valueChange",function(n){return r.onChangeTab(n)}),l(5,"p-tablist")(6,"p-tab",3),w(7,"span",4),v(8),u(9,"translate"),c(),l(10,"p-tab",5),w(11,"span",6),v(12),u(13,"translate"),c(),l(14,"p-tab",7),w(15,"span",8),v(16),u(17,"translate"),c()(),h(18,Be,1,3,"p-progressbar",9),l(19,"p-tabpanels")(20,"p-tabpanel",3)(21,"div",10),h(22,$e,11,10,"div",11),l(23,"button",12),u(24,"translate"),g("click",function(){return r.saveSettings()}),c()()(),l(25,"p-tabpanel",5)(26,"div",10),h(27,De,11,10,"div",11),l(28,"button",12),u(29,"translate"),g("click",function(){return r.saveSettings()}),c()()(),l(30,"p-tabpanel",7)(31,"div",10),h(32,Qe,11,10,"div",11),l(33,"button",12),u(34,"translate"),g("click",function(){return r.saveSettings()}),c()()()()()(),w(35,"p-toast")),e&2&&(p(2),k(S(3,14,"SYSTEM_SETTINGS")),p(6),P(" ",S(9,16,"APP_SETTINGS")," "),p(4),P(" ",S(13,18,"COMPANY_SETTINGS")," "),p(4),P(" ",S(17,20,"RECEIPT_SETTINGS")," "),p(2),a("ngIf",r.loading),p(4),a("ngForOf",r.settings),p(),a("label",S(24,22,"SAVE_ALL"))("loading",r.saveLoading),p(4),a("ngForOf",r.settings),p(),a("label",S(29,24,"SAVE_ALL"))("loading",r.saveLoading),p(4),a("ngForOf",r.settings),p(),a("label",S(34,26,"SAVE_ALL"))("loading",r.saveLoading))},dependencies:[O,K,Q,X,Z,oe,ee,ne,te,ie,de,ge,_e,ce,Te,Me,be,we,he,ve,pe,le,ae,se,me,xe,fe,ye,Ce,Se,ue],encapsulation:2})};var Xe=[{path:"system",component:G}],H=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=B({type:i});static \u0275inj=F({imports:[D.forChild(Xe),D]})};var ke=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=B({type:i});static \u0275inj=F({imports:[O,H]})};export{ke as SettingsModule};
