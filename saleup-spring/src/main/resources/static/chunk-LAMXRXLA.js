import{a as kt,b as Ot,c as Vt}from"./chunk-HGGIOC3A.js";import{a as Ne}from"./chunk-QKXA2NIK.js";import{a as Lt}from"./chunk-NDTFYA7E.js";import{a as Ut,b as jt,c as ze,d as Ht,e as We,f as xe}from"./chunk-WBSWCOYN.js";import{a as j,b as ve}from"./chunk-G4FF2B5M.js";import{a as A}from"./chunk-FMMZUCLX.js";import{a as X,b as K}from"./chunk-TOUITQG2.js";import{a as re}from"./chunk-FLAFVX6E.js";import{a as Ft}from"./chunk-BRBYF4VY.js";import{a as Qt,b as $t}from"./chunk-XPJVPVYE.js";import"./chunk-APHUFVIH.js";import{a as qt}from"./chunk-SCWCLCIA.js";import{a as le}from"./chunk-O3SRXZ6G.js";import{a as Qe,b as $e}from"./chunk-LM2R7CUP.js";import{d as je,e as He}from"./chunk-7TNYY5WH.js";import{B as Ve,C as qe,E as J,o as Fe,q as _e,r as Nt,u as G,x as ke,y as Oe}from"./chunk-ZWE3YAKD.js";import"./chunk-24EOINCO.js";import{a as ge}from"./chunk-4EMWHUSH.js";import{a as Le,c as z,d as D,e as B}from"./chunk-PWXSQGX5.js";import{b as Se,c as Ue}from"./chunk-BTRQCZZF.js";import{a as $,c as ce,d as W,k as de,l as Y}from"./chunk-CVJAGL52.js";import{e as ne,g as Q,h as ae,m as F}from"./chunk-XJ7XG5EY.js";import{Ha as Dt,Ka as me,Na as Bt,Oa as Ae,Ra as Mt,Wa as P,Xa as At,b as Me,ob as ue,pb as M,qb as fe,rb as O,sb as L,va as Pt}from"./chunk-6GUNNAMA.js";import{$ as we,$a as g,Ab as c,Db as y,Jb as r,K as gt,Kb as a,Lb as _,O as xt,Pb as R,Rb as b,Sb as u,Uc as wt,V as It,Va as H,Vc as Be,Wc as k,Yb as Et,Zb as Rt,_ as se,_a as i,_b as Tt,bc as pe,cc as o,da as Pe,dc as m,dd as T,ec as f,gc as Z,hc as ee,ic as te,kc as S,lb as w,lc as ie,mb as De,n as St,na as I,oa as C,ob as yt,pa as Ct,qa as ht,sb as x,uc as s,vc as p,wa as bt,wc as N,yc as h}from"./chunk-X5E3IHQQ.js";var Ye=class{customer;items;subTotal;discount;grandTotal;constructor(){this.items=[],this.subTotal=0,this.discount=0,this.grandTotal=0}empty(){this.items=[],this.subTotal=0,this.discount=0,this.grandTotal=0}},Ge=class{product;quantity};var Je=class{static playSaleEffect(){var t=new Audio("assets/sounds/sale-pulse.mp3");t.play()}};var Xe=class{saleId;customerId;saleItems;subTotal;grandTotal;discount},Ke=class{saleItemId;saleId;productId;quantity};var Ie=class n{addProductSubject=new St;addItem(t,e){this.getItem(t,e)?this.increaseQty(t,e):this.addNewItem(t,e),Je.playSaleEffect()}addNewItem(t,e){let l=new Ge;l.product=t,l.quantity=1,t.basicDetails.quantity>0&&(e.items?.push(l),this.updateAmout(e))}increaseQty(t,e){let l=this.getItem(t,e);l&&l.quantity&&l.quantity<t.basicDetails.quantity&&(l.quantity++,this.updateAmout(e))}decreaseQty(t,e){let l=this.getItem(t,e);l&&l.quantity&&l.quantity>1&&(l.quantity--,this.updateAmout(e))}itemExists(t,e){if(e&&e.items){for(let l of e.items)if(l.product?.productId==t?.productId)return!0;return!1}return!1}removeItem(t,e){if(e&&e.items)for(let l=0;l<e.items.length;l++)e.items[l].product?.productId==t?.productId&&(e.items.splice(l,1),this.updateAmout(e))}getItem(t,e){if(e&&e.items){for(let l of e.items)if(l.product?.productId==t?.productId)return l;return null}return null}updateAmout(t){if(t&&t.items){t.subTotal=0,t.grandTotal=0;for(let e of t.items){let l=this.getItemTotal(e)||0;t.subTotal+=l}t.grandTotal=t.subTotal-t.subTotal*(t.discount||0)}}getItemTotal(t){return t&&t.product&&t.quantity?t.product.priceDetails.priceWithDiscount*t.quantity:null}cartToSaleRequest(t){if(t.items){let e=new Xe;return e.customerId=t.customer?.customerId,e.subTotal=t.subTotal,e.grandTotal=t.grandTotal,e.discount=t.discount,e.saleItems=this.cartItemsToSaleItems(t.items),e}return{}}cartItemsToSaleItems(t){let e=[];for(let l of t){let d=new Ke;d.productId=l.product?.productId,d.quantity=l.quantity,e.push(d)}return e}static \u0275fac=function(e){return new(e||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})};var q=class n{constructor(t){this.http=t}basUrl=Le.apiBaseUrl+"/sale";createSale(t){return this.http.post(this.basUrl,t)}getSalesPage(t){return this.http.get(`${this.basUrl}?page=${t.page}&size=${t.size}`)}getSaleById(t){return this.http.get(`${this.basUrl}/${t}`)}getSaleReceipt(t){return this.http.get(`${this.basUrl}/receipt/${t}`,{responseType:"blob"})}previewSaleReceipt(t){this.getSaleReceipt(t.saleId).subscribe(e=>{let l=new Blob([e],{type:"application/pdf"}),d=URL.createObjectURL(l),v=window.open(d,"_blank");v&&(v.onload=()=>{v.print()})})}static \u0275fac=function(e){return new(e||n)(Pe(Me))};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})};var ri=()=>({minWidth:"40rem",overflow:"hidden"}),Gt=()=>({width:"100%"}),oi=()=>({width:"100%",border:"1px dashed"}),li=()=>({width:"3rem"});function si(n,t){if(n&1&&(r(0,"div",22),_(1,"p-avatar",23),r(2,"div"),o(3),a(),r(4,"span",24),o(5),a()()),n&2){let e=t.$implicit;i(),c("label",e.fullName.toUpperCase()[0]),i(2),m(e.phone),i(2),f(" ",e.fullName," ")}}function pi(n,t){if(n&1){let e=R();r(0,"p-button",25),s(1,"translate"),b("onClick",function(){I(e);let d=u();return C(d.cart.empty())}),a()}n&2&&c("label",p(1,2,"EMPTY_CART"))("text",!0)}function mi(n,t){n&1&&(r(0,"div",26),o(1),s(2,"translate"),a()),n&2&&(i(),f(" ",p(2,1,"CART_EMPTY")," "))}function ci(n,t){if(n&1){let e=R();r(0,"span",37),b("click",function(){I(e);let d=u().$implicit,v=u();return C(v.increaseQty(d))}),_(1,"span",38),a()}}function di(n,t){if(n&1){let e=R();r(0,"span",37),b("click",function(){I(e);let d=u().$implicit,v=u();return C(v.decreaseQty(d))}),_(1,"span",39),a()}}function ui(n,t){if(n&1){let e=R();r(0,"div",27),_(1,"img",28),r(2,"div",29)(3,"div",30)(4,"div",31),o(5),a(),r(6,"span",32),o(7),s(8,"sCurrency"),a()(),r(9,"div",33)(10,"p-inputnumber",34),te("ngModelChange",function(d){let v=I(e).$implicit;return ee(v.quantity,d)||(v.quantity=d),C(d)}),x(11,ci,2,0,"ng-template",null,2,h)(13,di,2,0,"ng-template",null,3,h),a()(),r(15,"div",35),o(16),s(17,"sCurrency"),a()(),r(18,"p-button",36),b("onClick",function(){let d=I(e).$implicit,v=u();return C(v.removeItem(d))}),a()()}if(n&2){let e=t.$implicit,l=u();i(),c("src",l.getProductImageSrc(e.product),H)("alt",e.product.basicDetails.productName),i(3),c("pTooltip",e.product==null||e.product.basicDetails==null?null:e.product.basicDetails.productName),i(),f(" ",e.product==null||e.product.basicDetails==null?null:e.product.basicDetails.productName," "),i(2),m(p(8,12,e.product==null||e.product.priceDetails==null?null:e.product.priceDetails.priceWithDiscount)),i(3),Z("ngModel",e.quantity),c("max",(e.product==null||e.product.basicDetails==null?null:e.product.basicDetails.quantity)||99)("showButtons",!0)("inputStyle",S(16,li)),i(6),m(p(17,14,l.cartService.getItemTotal(e))),i(2),c("rounded",!0)("text",!0)}}function fi(n,t){if(n&1){let e=R();r(0,"div",40)(1,"p-button",41),s(2,"translate"),b("onClick",function(){I(e);let d=u();return C(d.submitOrder())}),a()()}if(n&2){let e=u();i(),y(S(7,Gt)),c("loading",e.orderLoading)("label",p(2,5,"SUBMIT_ORDER"))("disabled",!e.cart.items||!e.cart.items.length)}}function _i(n,t){if(n&1){let e=R();r(0,"app-customer-create-dialog",42),b("visibleChange",function(d){I(e);let v=u();return C(v.toggleDialog(d))}),a()}}function vi(n,t){if(n&1&&(r(0,"div",43),_(1,"i",44),r(2,"p"),o(3),a()()),n&2){let e=t.$implicit;i(),c("ngClass",e.icon),i(2),m(e.message)}}var Ze=class n{constructor(t,e,l,d,v){this.cartService=t;this.customerService=e;this.saleService=l;this.toast=d;this.translate=v}cart;customers=[];orderLoading=!1;customerDialog=!1;success=new bt;ngOnInit(){this.cart=new Ye,this.cartService.addProductSubject.subscribe(t=>{this.cartService.addItem(t,this.cart)})}searchCustomers(t){this.customerService.filterCustomersByPhone(t.query).subscribe(e=>this.customers=e.data)}getProductImageSrc(t){return j.getFirstImageSrc(t)}increaseQty(t){this.cartService.increaseQty(t.product,this.cart)}decreaseQty(t){this.cartService.decreaseQty(t.product,this.cart)}removeItem(t){this.cartService.removeItem(t.product,this.cart)}submitOrder(){this.orderLoading=!0,this.saleService.createSale(this.cartService.cartToSaleRequest(this.cart)).subscribe(t=>{t.success&&(this.toast.showSuccess(this.translate.instant("ORDER_SAVED")),this.orderLoading=!1,this.cart.empty(),this.success.emit(!0),this.saleService.previewSaleReceipt(t.data))},t=>{this.toast.showError(t.error.message),this.orderLoading=!1})}toggleDialog(t){this.customerDialog=t}static \u0275fac=function(e){return new(e||n)(g(Ie),g(Qt),g(q),g(ge),g(z))};static \u0275cmp=w({type:n,selectors:[["app-pos-sale-details"]],outputs:{success:"success"},decls:48,vars:41,consts:[["footer",""],["message",""],["incrementbuttonicon",""],["decrementbuttonicon",""],[1,"search-customers","mb-8"],[1,"flex","flex-col","gap-2","mb-4"],[1,"text-lg"],["optionLabel","phone",3,"ngModelChange","completeMethod","dropdown","ngModel","suggestions"],["pTemplate","item"],["icon","pi pi-plus","outlined","true",3,"onClick","label"],[1,"order-details"],[1,"mb-4","text-lg","flex","justify-between"],["severity","danger","icon","pi pi-shopping-cart","class","mr-2",3,"label","text","onClick",4,"ngIf"],["class","no-items text-center text-surface-600",4,"ngIf"],[1,"order-items","overflow-auto","flex","flex-col","gap-2","mb-6",2,"max-height","20rem"],["class","order-item flex gap-4 items-center justify-between",4,"ngFor","ngForOf"],[1,"total"],[1,"flex","justify-between"],[1,"mb-4","text-surface-400"],[1,"border-dashed"],[1,"mb-4","font-bold","text-lg"],[3,"visibleChange",4,"ngIf"],[1,"flex","gap-2","items-center"],["shape","circle",3,"label"],[1,"font-sm"],["severity","danger","icon","pi pi-shopping-cart",1,"mr-2",3,"onClick","label","text"],[1,"no-items","text-center","text-surface-600"],[1,"order-item","flex","gap-4","items-center","justify-between"],[1,"rounded","w-full",2,"width","6rem","height","4rem","object-fit","cover",3,"src","alt"],[1,"flex","items-center","justify-between","w-full"],[1,"flex","flex-col"],["tooltipPosition","top",1,"mb-2","text-max-lines-1",2,"width","12rem",3,"pTooltip"],[1,"text-primary"],[1,"item-actions","ml-1","mr-1"],["readonly","true","min","1","buttonLayout","horizontal","spinnerMode","horizontal",3,"ngModelChange","ngModel","max","showButtons","inputStyle"],[1,"w-3rem","text-primary",2,"min-width","3rem"],["icon","pi pi-times","severity","danger",3,"onClick","rounded","text"],[1,"w-full","h-full","flex","items-center","justify-center",3,"click"],[1,"pi","pi-plus"],[1,"pi","pi-minus"],[1,"payment","text-lg"],[3,"onClick","loading","label","disabled"],[3,"visibleChange"],[1,"flex","flex-col","items-center","w-full","gap-4","border-b","border-surface-200","dark:border-surface-700"],[1,"!text-6xl","text-primary-500",3,"ngClass"]],template:function(e,l){if(e&1){let d=R();r(0,"p-card")(1,"div",4)(2,"div",5)(3,"div",6),o(4),s(5,"translate"),a(),r(6,"p-autocomplete",7),te("ngModelChange",function(E){return I(d),ee(l.cart.customer,E)||(l.cart.customer=E),C(E)}),b("completeMethod",function(E){return I(d),C(l.searchCustomers(E))}),x(7,si,6,3,"ng-template",8),a()(),r(8,"p-button",9),s(9,"translate"),b("onClick",function(){return I(d),C(l.customerDialog=!0)}),a()(),r(10,"div",10)(11,"div",11)(12,"span"),o(13),s(14,"translate"),a(),x(15,pi,2,4,"p-button",12),a(),x(16,mi,3,3,"div",13),r(17,"div",14),x(18,ui,19,17,"div",15),a(),r(19,"div",16)(20,"div",17)(21,"div",18),o(22),s(23,"translate"),a(),r(24,"span"),o(25),s(26,"sCurrency"),a()(),r(27,"div",17)(28,"div",18),o(29),s(30,"translate"),a(),r(31,"span"),o(32),a()(),_(33,"hr",19),r(34,"div",17)(35,"div",20),o(36),s(37,"translate"),a(),r(38,"span",6),o(39),s(40,"sCurrency"),a()()()(),x(41,fi,3,8,"ng-template",null,0,h),a(),_(43,"p-toast"),x(44,_i,1,0,"app-customer-create-dialog",21),r(45,"p-confirmdialog"),x(46,vi,4,2,"ng-template",null,1,h),a()}e&2&&(y(S(38,ri)),i(4),m(p(5,22,"CUSTOMER_DETAILS")),i(2),y(S(39,Gt)),c("dropdown",!0),Z("ngModel",l.cart.customer),c("suggestions",l.customers),i(2),y(S(40,oi)),c("label",p(9,24,"ADD_CUSTOMER")),i(5),m(p(14,26,"ORDER_DETAILS")),i(2),c("ngIf",l.cart.items==null?null:l.cart.items.length),i(),c("ngIf",!l.cart.items||!l.cart.items.length),i(2),c("ngForOf",l.cart.items),i(4),f(" ",p(23,28,"SUB_TOTAL")," "),i(3),m(p(26,30,l.cart.subTotal)),i(4),f(" ",p(30,32,"DISCOUNT")," "),i(3),m(l.cart.discount),i(4),f(" ",p(37,34,"TOTAL_AMOUNT")," "),i(3),m(p(40,36,l.cart.grandTotal)),i(5),c("ngIf",l.customerDialog))},dependencies:[L,O,Pt,T,wt,Be,k,P,me,Ae,Y,W,M,K,X,Ot,kt,qt,Fe,Se,$t,$,A,B,D,Qe],styles:[".scrolling-text-wrapper[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap}.scrolling-text[_ngcontent-%COMP%]{display:inline-block;font-weight:700;animation:_ngcontent-%COMP%_scroll-text 5s linear infinite}@keyframes _ngcontent-%COMP%_scroll-text{0%{transform:translate(100%)}to{transform:translate(-100%)}}"]})};var Si=n=>["/products/detail",n];function gi(n,t){if(n&1){let e=R();r(0,"div",7)(1,"p-iconfield"),_(2,"p-inputicon",8)(3,"input",9),s(4,"translate"),a(),r(5,"p-paginator",10),b("onPageChange",function(d){I(e);let v=u();return C(v.onPageChange(d))}),a()()}if(n&2){let e=u();i(3),c("formControl",e.globalSearchControl)("placeholder",p(4,8,"SEARCH_PACEHOLDER")),i(2),c("first",e.pageReq.page*e.pageReq.size)("rows",e.pageReq.size)("totalRecords",(e.pageDetails==null?null:e.pageDetails.totalElements)||0)("showCurrentPageReport",!0)("showPageLinks",!1)("showJumpToPageDropdown",!1)}}function xi(n,t){n&1&&(r(0,"div",13),_(1,"p-skeleton",14)(2,"p-skeleton",14)(3,"p-skeleton",14)(4,"p-skeleton",14),a())}function Ii(n,t){if(n&1){let e=R();r(0,"div",17)(1,"div",18)(2,"div",19)(3,"div",20),_(4,"img",21)(5,"p-tag",22),a()(),r(6,"div",23)(7,"div")(8,"div",24),o(9),a(),r(10,"div",25),o(11),a()(),r(12,"div",26)(13,"div",27)(14,"span",28),o(15),s(16,"sCurrency"),a(),r(17,"span",29),o(18),s(19,"sCurrency"),a()(),r(20,"div",30)(21,"button",31),s(22,"translate"),b("click",function(){let d=I(e).$implicit,v=u(3);return C(v.addProductToCart(d))}),a()()()()()()}if(n&2){let e=t.$implicit,l=u(3);i(4),c("src",l.getProductImageSrc(e),H)("alt",e.basicDetails==null?null:e.basicDetails.productName),i(),c("value","QTY: "+e.basicDetails.quantity)("severity",l.getQuantitySeverity(e)),i(4),f(" ",e.basicDetails==null||e.basicDetails.productCategory==null?null:e.basicDetails.productCategory.name," "),i(),c("routerLink",ie(17,Si,e.productId))("pTooltip",e.basicDetails==null?null:e.basicDetails.productName),i(),f(" ",e.basicDetails.productName," "),i(4),f(" ",p(16,11,e.priceDetails.sellingPrice)," "),i(3),f(" ",p(19,13,e.priceDetails.priceWithDiscount)," "),i(3),c("label",p(22,15,"ADD_TO_CART"))}}function Ci(n,t){if(n&1&&(r(0,"div",15),x(1,Ii,23,19,"div",16),a()),n&2){let e=u().$implicit;i(),c("ngForOf",e)}}function hi(n,t){if(n&1&&x(0,xi,5,0,"div",11)(1,Ci,2,1,"div",12),n&2){let e=u();c("ngIf",e.loading),i(),c("ngIf",!e.loading)}}var tt=class n{constructor(t,e,l,d,v){this.productService=t;this.cartService=e;this.lasyoutService=l;this.translate=d;this.toast=v}globalSearchControl=new Bt("");pageReq=new le(0,8);pageDetails;products=[];loading=!1;searching=!1;barcodeScanner;ngOnInit(){this.subscribeForGlobalSearch(),this.getProducts(),this.hideSideBar()}hideSideBar(){this.lasyoutService.isSidebarActive()||this.lasyoutService.onMenuToggle()}ngAfterViewInit(){this.barcodeScanner.start()}onValueChanges(t){if(this.searching)return;this.searching=!0;let e=t.codeResult.code.trim();this.productService.getProductByBarcode(e).subscribe(l=>{l.success?this.cartService.addProductSubject.next(l.data):(this.toast.showError(this.translate.instant("PRODUCT_NOT_FOUND")),this.searching=!1)})}subscribeForGlobalSearch(){this.pageReq=new le(0,8),this.loading=!0,this.globalSearchControl.valueChanges.pipe(gt(300),It(t=>this.productService.searchByKeyword(t||"",this.pageReq).pipe(xt(()=>this.loading=!1)))).subscribe(t=>{t.success&&(this.products=t.data.content,this.pageDetails=t.data.page),this.loading=!1})}getProducts(){this.loading=!0,this.productService.getProductsPage(this.pageReq).subscribe(t=>{t.success&&(this.products=t.data.content,this.pageDetails=t.data.page),this.loading=!1})}getQuantitySeverity(t){return j.getQuantitySeverity(t)}getProductImageSrc(t){return j.getFirstImageSrc(t)}addProductToCart(t){this.cartService.addProductSubject.next(t)}onPageChange(t){this.pageReq.page=t.page,this.pageReq.size=t.rows,this.getProducts()}orderSuccess(t){this.getProducts()}static \u0275fac=function(e){return new(e||n)(g(Ut),g(Ie),g(Lt),g(z),g(ge))};static \u0275cmp=w({type:n,selectors:[["app-pos"]],viewQuery:function(e,l){if(e&1&&Et(ze,5),e&2){let d;Rt(d=Tt())&&(l.barcodeScanner=d.first)}},decls:11,vars:1,consts:[["dv",""],["header",""],["grid",""],[1,"flex","gap-2","h-full","w-full"],[3,"success"],["layout","grid",3,"value"],["type","code_128",3,"valueChanges"],[1,"flex","items-center","justify-between"],["styleClass","pi pi-barcode"],["pInputText","","type","text",1,"w-80",3,"formControl","placeholder"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords}",3,"onPageChange","first","rows","totalRecords","showCurrentPageReport","showPageLinks","showJumpToPageDropdown"],["class","loading flex flex-wrap gap-2 mb-4 mt-4",4,"ngIf"],["class","grid grid-cols-12 gap-4",4,"ngIf"],[1,"loading","flex","flex-wrap","gap-2","mb-4","mt-4"],["size","10rem"],[1,"grid","grid-cols-12","gap-4"],["class","col-span-6 sm:col-span-3 md:col-span-3 xl:col-span-3 p-2",4,"ngFor","ngForOf"],[1,"col-span-6","sm:col-span-3","md:col-span-3","xl:col-span-3","p-2"],[1,"p-3","border","border-surface-200","dark:border-surface-700","bg-surface-0","dark:bg-surface-900","rounded","flex","flex-col"],[1,"bg-surface-50","flex","justify-center","rounded","p-1"],[1,"relative","mx-auto"],[1,"rounded","w-full",2,"width","20rem","height","8rem","object-fit","cover",3,"src","alt"],["styleClass","dark:!bg-surface-900",1,"absolute","absolute","top-0","left-0",3,"value","severity"],[1,"pt-4"],[1,"text-right","text-red-300"],["tooltipPosition","top",1,"mt-1","cursor-pointer","text-overflow-ellipsis","overflow-hidden","text-max-lines-2",3,"routerLink","pTooltip"],[1,"flex","flex-col","gap-6","mt-6"],[1,"flex","gap-3"],[1,"text-sm","text-surface-400","line-through"],[1,"font-semibold"],[1,"flex","gap-2"],["pButton","","icon","pi pi-shopping-cart","variant","text","severity","secondary",1,"flex-auto",3,"click","label"]],template:function(e,l){if(e&1){let d=R();r(0,"div",3)(1,"app-pos-sale-details",4),b("success",function(E){return I(d),C(l.orderSuccess(E))}),a(),r(2,"p-card")(3,"p-dataview",5,0),x(5,gi,6,10,"ng-template",null,1,h)(7,hi,2,2,"ng-template",null,2,h),a()()(),r(9,"barcode-scanner-livestream",6),b("valueChanges",function(E){return I(d),C(l.onValueChanges(E))}),a(),_(10,"p-toast")}e&2&&(i(3),c("value",l.products))},dependencies:[Vt,Ft,L,fe,T,Be,k,P,Dt,me,At,Mt,Y,de,W,ce,M,ue,K,X,Ze,Ht,ze,Nt,_e,$,A,re,Se,F,ae,B,D],encapsulation:2})};var U=class n{transform(t,e="medium"){let d=this.getLang()==="ar"?["ar","ar-u-nu-latn"]:["en"],v={};switch(e){case"short":v={year:"numeric",month:"short",day:"numeric"};break;case"medium":v={year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0};break;case"long":v={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0};break}return new Intl.DateTimeFormat(d,v).format(new Date(t))}getLang(){let t=sessionStorage.getItem("app.state");if(t)return JSON.parse(t).defaultLanguage||"en"}static \u0275fac=function(e){return new(e||n)};static \u0275pipe=yt({name:"dateFt",type:n,pure:!0})};var yi=()=>["barcode","customer.fullName","createdBy"],Ei=()=>({"min-width":"75rem"}),Ri=()=>[10,20,30],Ti=n=>["/sales/detail",n],wi=()=>["/sales/sale-return/list"],Pi=n=>({saleId:n});function Di(n,t){if(n&1){let e=R();r(0,"div",10),_(1,"p-button",11),s(2,"translate"),r(3,"p-button",12),s(4,"translate"),b("onClick",function(){I(e);let d=u();return C(d.deleteSelectedSales())}),a()()}if(n&2){let e=u();i(),c("label",p(2,3,"ADD")),i(2),c("label",p(4,5,"DELETE"))("disabled",!e.selectedSales||!e.selectedSales.length)}}function Bi(n,t){n&1&&(_(0,"p-button",13),s(1,"translate")),n&2&&c("label",p(1,1,"EXPORT"))}function Mi(n,t){if(n&1){let e=R();r(0,"div",14)(1,"h5",15),o(2),s(3,"translate"),a(),r(4,"p-iconfield"),_(5,"p-inputicon",16),r(6,"input",17),s(7,"translate"),b("input",function(d){I(e);let v=u(),E=pe(6);return C(v.onGlobalFilter(E,d))}),a()()()}n&2&&(i(2),m(p(3,2,"SALE_HISTORY")),i(4),c("placeholder",p(7,4,"SEARCH_PACEHOLDER")))}function Ai(n,t){n&1&&(r(0,"tr")(1,"th",18),_(2,"p-tableHeaderCheckbox"),a(),r(3,"th"),o(4),s(5,"translate"),a(),r(6,"th",19),o(7),s(8,"translate"),_(9,"p-sortIcon",20),a(),r(10,"th",21),o(11),s(12,"translate"),_(13,"p-sortIcon",22),a(),r(14,"th",23),o(15),s(16,"translate"),_(17,"p-sortIcon",24),a(),r(18,"th"),o(19),s(20,"translate"),a(),r(21,"th",25),o(22),s(23,"translate"),_(24,"p-sortIcon",26),a(),r(25,"th"),o(26),s(27,"translate"),a()()),n&2&&(i(4),f(" ",p(5,7,"BARCODE")," "),i(3),f(" ",p(8,9,"DATE")," "),i(4),f(" ",p(12,11,"CUSTOMER")," "),i(4),f(" ",p(16,13,"GRAND_TOTAL")," "),i(4),f(" ",p(20,15,"SALE_RETURN_STATUS")," "),i(3),f(" ",p(23,17,"SOLD_BY")," "),i(4),m(p(27,19,"OPTIONS")))}function Li(n,t){n&1&&(r(0,"div",35),o(1),s(2,"translate"),a()),n&2&&(i(),f(" ",p(2,1,"NOT_REGISTERED_CUSTOMER")," "))}function Ni(n,t){n&1&&(r(0,"div",36),_(1,"i",37),r(2,"div",38),o(3),s(4,"translate"),a()()),n&2&&(i(3),m(p(4,1,"SALE_TOTALLY_RETURNED")))}function Fi(n,t){n&1&&(r(0,"div",36),_(1,"i",37),r(2,"div",39),o(3),s(4,"translate"),a()()),n&2&&(i(3),m(p(4,1,"SALE_PARTIALLY_RETURNED")))}function ki(n,t){n&1&&(r(0,"div",40)(1,"div",41),o(2),s(3,"translate"),a()()),n&2&&(i(2),m(p(3,1,"SALE_HAS_NO_RETURNS")))}function Oi(n,t){if(n&1&&(r(0,"a",42),o(1),s(2,"translate"),a()),n&2){let e=u().$implicit;c("routerLink",S(5,wi))("queryParams",ie(6,Pi,e.saleId)),i(),m(p(2,3,"SHOW_SALE_RETURNS"))}}function Vi(n,t){if(n&1){let e=R();r(0,"tr")(1,"td"),_(2,"p-tableCheckbox",27),a(),r(3,"td")(4,"a",28),o(5),a()(),r(6,"td"),o(7),s(8,"dateFt"),a(),r(9,"td"),o(10),x(11,Li,3,3,"div",29),a(),r(12,"td"),o(13),s(14,"sCurrency"),a(),r(15,"td"),x(16,Ni,5,3,"div",30)(17,Fi,5,3,"div",30)(18,ki,4,3,"div",31)(19,Oi,3,8,"a",32),a(),r(20,"td"),o(21),a(),r(22,"td"),_(23,"p-menu",33,6),r(25,"button",34),b("click",function(d){let v=I(e).$implicit,E=pe(24);return u().getMenuItems(v),C(E.toggle(d))}),a()()()}if(n&2){let e=t.$implicit,l=u();i(2),c("value",e),i(2),c("routerLink",ie(19,Ti,e.saleId)),i(),m(e.barcode),i(2),f(" ",N(8,14,e.createdAt,"long")," "),i(3),f(" ",e.customer==null?null:e.customer.fullName," "),i(),c("ngIf",!e.customer),i(2),f(" ",p(14,17,e.grandTotal)," "),i(3),c("ngIf",e.totallyReturned),i(),c("ngIf",e.partiallyReturned),i(),c("ngIf",!e.partiallyReturned&&!e.totallyReturned),i(),c("ngIf",e.totallyReturned||e.partiallyReturned),i(2),f(" ",e.createdBy," "),i(2),c("popup",!0)("model",l.menuItems)}}var it=class n{constructor(t,e,l){this.saleService=t;this.translate=e;this.router=l}loading=!1;pageReq=new le(0,10);pageDetails;salesList=[];sale;selectedSales;cols;mode;menuItems=[];ngOnInit(){this.getSalesPage()}getSalesPage(){this.loading=!0,this.saleService.getSalesPage(this.pageReq).subscribe(t=>{t.success&&(this.salesList=t.data.content,this.pageDetails=t.data.page,this.loading=!1)})}onPageChange(t){this.pageReq.page=t.page,this.pageReq.size=t.rows,this.getSalesPage()}onGlobalFilter(t,e){t.filterGlobal(e.target.value,"contains")}getMenuItems(t){this.menuItems=[{label:this.translate.instant("SHOW_DETAILS"),icon:"pi pi-eye",command:()=>{this.saleDetails(t)}},{label:this.translate.instant("PRINT_RECEIPT"),icon:"pi pi-print",command:()=>{this.saleService.previewSaleReceipt(t)}},{label:this.translate.instant("RETURN_SALE"),icon:"pi pi-arrow-right-arrow-left",disabled:t.totallyReturned,command:()=>{this.saleReturn(t)}},{label:this.translate.instant("DELETE"),icon:"pi pi-trash",command:()=>{}}]}deleteSale(t){}deleteSelectedSales(){}showSaleDetails(t){}downloadReceipt(t){this.saleService.previewSaleReceipt(t)}saleDetails(t){this.router.navigate(["sales/detail",t.saleId])}saleReturn(t){this.router.navigate(["sales/sale-return/create",t.saleId])}static \u0275fac=function(e){return new(e||n)(g(q),g(z),g(Q))};static \u0275cmp=w({type:n,selectors:[["app-sales-list"]],decls:14,vars:17,consts:[["start",""],["end",""],["dt",""],["caption",""],["header",""],["body",""],["menu",""],["styleClass","mb-6"],["dataKey","saleId",3,"selectionChange","value","rows","columns","loading","globalFilterFields","tableStyle","selection","rowHover"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords}",3,"onPageChange","first","rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","showJumpToPageDropdown"],[1,"flex","items-center","gap-2"],["icon","pi pi-plus","severity","secondary",1,"mr-2",3,"label"],["severity","secondary","icon","pi pi-trash","outlined","",3,"onClick","label","disabled"],["icon","pi pi-upload","severity","secondary",3,"label"],[1,"flex","items-center","justify-between"],[1,"m-0"],["styleClass","pi pi-search"],["pInputText","","type","text",3,"input","placeholder"],[2,"width","3rem"],["pSortableColumn","createdAt"],["field","createdAt"],["pSortableColumn","customer"],["field","customer"],["pSortableColumn","grandTotal"],["field","grandTotal"],["pSortableColumn","createdBy"],["field","createdBy"],[3,"value"],[1,"text-primary",3,"routerLink"],["class","text-muted-color",4,"ngIf"],["class","flex gap-2 mb-2",4,"ngIf"],["class","flex gap-2",4,"ngIf"],["class","text-muted-color dark:text-surface-400 hover:underline",3,"routerLink","queryParams",4,"ngIf"],["appendTo","body",3,"popup","model"],["pButton","","icon","pi pi-ellipsis-v",1,"p-button-text",3,"click"],[1,"text-muted-color"],[1,"flex","gap-2","mb-2"],[1,"pi","pi-arrow-right-arrow-left","text-muted-color"],[1,"text-red-500"],[1,"text-orange-500"],[1,"flex","gap-2"],[1,"text-blue-500","dark:text-blue-300"],[1,"text-muted-color","dark:text-surface-400","hover:underline",3,"routerLink","queryParams"]],template:function(e,l){if(e&1){let d=R();r(0,"p-toolbar",7),x(1,Di,5,7,"ng-template",null,0,h)(3,Bi,2,3,"ng-template",null,1,h),a(),r(5,"p-table",8,2),te("selectionChange",function(E){return I(d),ee(l.selectedSales,E)||(l.selectedSales=E),C(E)}),x(7,Mi,8,6,"ng-template",null,3,h)(9,Ai,28,21,"ng-template",null,4,h)(11,Vi,26,21,"ng-template",null,5,h),a(),r(13,"p-paginator",9),b("onPageChange",function(E){return I(d),C(l.onPageChange(E))}),a()}e&2&&(i(5),c("value",l.salesList)("rows",10)("columns",l.cols)("loading",l.loading)("globalFilterFields",S(14,yi))("tableStyle",S(15,Ei)),Z("selection",l.selectedSales),c("rowHover",!0),i(8),c("first",l.pageReq.page*l.pageReq.size)("rows",l.pageReq.size)("totalRecords",(l.pageDetails==null?null:l.pageDetails.totalElements)||0)("rowsPerPageOptions",S(16,Ri))("showCurrentPageReport",!0)("showJumpToPageDropdown",!1))},dependencies:[T,k,J,G,ke,Oe,Ve,qe,P,L,fe,O,Ue,M,ue,He,je,$e,B,D,ce,de,Ne,_e,A,F,ae,U],encapsulation:2})};var Xt=()=>({"min-width":"50rem"}),Ui=()=>[1],ji=()=>["/sales/sale-return/list"],Hi=n=>({saleId:n}),Qi=()=>({width:"30%"}),$i=()=>({width:"20%"}),Kt=()=>({width:"25%"}),ct=()=>({width:"50%"});function zi(n,t){n&1&&(r(0,"div",4),_(1,"p-skeleton",5)(2,"p-skeleton",6)(3,"p-skeleton",7)(4,"p-skeleton",8)(5,"p-skeleton",9),a())}function Wi(n,t){n&1&&(r(0,"div",29),_(1,"i",30),r(2,"div",31),o(3),s(4,"translate"),a()()),n&2&&(i(3),m(p(4,1,"SALE_TOTALLY_RETURNED")))}function Yi(n,t){n&1&&(r(0,"div",29),_(1,"i",30),r(2,"div",32),o(3),s(4,"translate"),a()()),n&2&&(i(3),m(p(4,1,"SALE_PARTIALLY_RETURNED")))}function Gi(n,t){n&1&&(r(0,"div",33)(1,"div",34),o(2),s(3,"translate"),a()()),n&2&&(i(2),m(p(3,1,"SALE_HAS_NO_RETURNS")))}function Ji(n,t){if(n&1&&(r(0,"a",35),o(1),s(2,"translate"),a()),n&2){let e=u(2);c("routerLink",S(5,ji))("queryParams",ie(6,Hi,e.sale.saleId)),i(),m(p(2,3,"SHOW_SALE_RETURNS"))}}function Xi(n,t){n&1&&(r(0,"div",36)(1,"span"),o(2),s(3,"translate"),a(),o(4),s(5,"translate"),a()),n&2&&(i(2),m(p(3,2,"NAME")),i(2),f(": ",p(5,4,"NOT_REGISTERED_CUSTOMER")," "))}function Ki(n,t){if(n&1&&(r(0,"div",36)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"NAME")),i(2),f(": ",e.sale.customer.fullName," ")}}function Zi(n,t){if(n&1&&(r(0,"div",36)(1,"span"),o(2),s(3,"translate"),a(),o(4,": "),r(5,"span",13),o(6),a()()),n&2){let e=u(2);i(2),m(p(3,2,"PHONE")),i(4),m(e.sale.customer.phone)}}function en(n,t){if(n&1&&(r(0,"div",36)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"COUNTRY")),i(2),f(": ",e.sale.customer.country," ")}}function tn(n,t){if(n&1&&(r(0,"div",36)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"ADDRESS")),i(2),f(": ",e.sale.customer.address," ")}}function nn(n,t){if(n&1&&(r(0,"div",36)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"EMAIL")),i(2),f(": ",e.sale.customer.email," ")}}function an(n,t){n&1&&(r(0,"tr")(1,"th"),o(2),s(3,"translate"),a(),r(4,"th"),o(5),s(6,"translate"),a(),r(7,"th"),o(8),s(9,"translate"),a(),r(10,"th"),o(11),s(12,"translate"),a()()),n&2&&(i(),y(S(20,Qi)),i(),m(p(3,12,"PRODUCT")),i(2),y(S(21,$i)),i(),m(p(6,14,"UNIT_PRICE")),i(2),y(S(22,Kt)),i(),m(p(9,16,"QUANTITY")),i(2),y(S(23,Kt)),i(),m(p(12,18,"SUB_TOTAL")))}function rn(n,t){if(n&1&&(r(0,"tr")(1,"td",37),_(2,"img",38),r(3,"span"),o(4),s(5,"substring"),a()(),r(6,"td"),o(7),s(8,"sCurrency"),a(),r(9,"td"),o(10),a(),r(11,"td"),o(12),s(13,"sCurrency"),a()()),n&2){let e=t.$implicit,l=u(2);i(2),c("src",l.getProductImageSrc(e.product),H)("alt",e.product.basicDetails==null?null:e.product.basicDetails.productName),i(2),m(N(5,6,e.product.basicDetails.productName,"medium")),i(3),m(p(8,9,e.unitPrice)),i(3),m(e.quantity),i(2),m(p(13,11,e.subTotal))}}function on(n,t){n&1&&_(0,"tr")}function ln(n,t){if(n&1&&(r(0,"tr")(1,"td"),o(2),s(3,"translate"),a(),r(4,"td"),o(5),s(6,"sCurrency"),a()(),r(7,"tr")(8,"td"),o(9),s(10,"translate"),a(),r(11,"td"),o(12),s(13,"sCurrency"),a()(),r(14,"tr")(15,"td"),o(16),s(17,"translate"),a(),r(18,"td",13),o(19),s(20,"sCurrency"),a()()),n&2){let e=u(2);i(2),m(p(3,12,"SUB_TOTAL")),i(2),y(S(24,ct)),i(),m(p(6,14,e.sale.subTotal)),i(4),m(p(10,16,"DISCOUNT")),i(2),y(S(25,ct)),i(),m(p(13,18,e.sale.discount)),i(4),m(p(17,20,"GRAND_TOTAL")),i(2),y(S(26,ct)),i(),m(p(20,22,e.sale.grandTotal))}}function sn(n,t){if(n&1){let e=R();r(0,"div",10)(1,"div",11)(2,"div",12)(3,"span"),o(4),s(5,"translate"),a(),o(6,": "),r(7,"span",13),o(8),a()(),r(9,"p-button",14),s(10,"translate"),b("onClick",function(){I(e);let d=u();return C(d.printReceipt())}),a()(),r(11,"div",15)(12,"span",16),o(13),s(14,"translate"),a(),r(15,"span"),o(16),s(17,"dateFt"),a()(),r(18,"div",15),x(19,Wi,5,3,"div",17)(20,Yi,5,3,"div",17)(21,Gi,4,3,"div",18)(22,Ji,3,8,"a",19),a(),r(23,"div",20)(24,"div",21),o(25),s(26,"translate"),a(),r(27,"div",22),x(28,Xi,6,6,"div",23)(29,Ki,5,4,"div",23)(30,Zi,7,4,"div",23)(31,en,5,4,"div",23)(32,tn,5,4,"div",23)(33,nn,5,4,"div",23),a()(),r(34,"div",24)(35,"div",21),o(36),s(37,"translate"),a(),r(38,"p-table",25),x(39,an,13,24,"ng-template",null,0,h)(41,rn,14,13,"ng-template",null,1,h),a(),r(43,"div",26)(44,"p-table",25),x(45,on,1,0,"ng-template",null,0,h)(47,ln,21,27,"ng-template",null,1,h),a()()(),r(49,"div",15)(50,"span",16),o(51),s(52,"translate"),a(),r(53,"span"),o(54),a()(),r(55,"div",27),_(56,"ngx-barcode6",28),a()()}if(n&2){let e=u();i(4),m(p(5,29,"SALE_DETAILS")),i(4),m(" "+e.sale.barcode+" "),i(),c("pTooltip",p(10,31,"PRINT_RECEIPT"))("rounded",!0)("text",!0),i(4),m(p(14,33,"TIMESTAMP")+": "),i(3),m(N(17,35,e.sale.createdAt,"long")),i(3),c("ngIf",e.sale.totallyReturned),i(),c("ngIf",e.sale.partiallyReturned),i(),c("ngIf",!e.sale.partiallyReturned&&!e.sale.totallyReturned),i(),c("ngIf",e.sale.totallyReturned||e.sale.partiallyReturned),i(3),f(" ",p(26,38,"CUSTOMER_DETAILS")," "),i(3),c("ngIf",!e.sale.customer),i(),c("ngIf",e.sale.customer),i(),c("ngIf",e.sale.customer),i(),c("ngIf",e.sale.customer&&e.sale.customer.country),i(),c("ngIf",e.sale.customer&&e.sale.customer.address),i(),c("ngIf",e.sale.customer&&e.sale.customer.email),i(3),f(" ",p(37,40,"ORDER_DETAILS")," "),i(2),c("value",e.sale.saleItems)("tableStyle",S(44,Xt)),i(6),c("value",S(45,Ui))("tableStyle",S(46,Xt)),i(7),m(p(52,42,"SOLD_BY")+": "),i(3),m(e.sale.createdBy),i(2),c("bc-width",3)("bc-format","CODE128")("bc-value",e.sale.barcode)("bc-display-value",!0)}}var at=class n{constructor(t,e,l){this.saleService=t;this.route=e;this.router=l}sale;loading=!1;ngOnInit(){this.fetchSaleDetails()}fetchSaleDetails(){this.loading=!0;let t=this.route.snapshot.paramMap.get("saleId");if(t){let e=Number.parseInt(t);e&&Number.isInteger(e)&&this.saleService.getSaleById(e).subscribe(l=>{l.success?this.sale=l.data:this.router.navigate(["/notfound"]),this.loading=!1})}}printReceipt(){this.saleService.previewSaleReceipt(this.sale)}getProductImageSrc(t){return j.getFirstImageSrc(t)}static \u0275fac=function(e){return new(e||n)(g(q),g(ne),g(Q))};static \u0275cmp=w({type:n,selectors:[["app-sale-details"]],decls:3,vars:2,consts:[["header",""],["body",""],["class","loading",4,"ngIf"],["class","details",4,"ngIf"],[1,"loading"],["styleClass","mb-2"],["width","10rem","styleClass","mb-2"],["width","5rem","styleClass","mb-2"],["height","2rem","styleClass","mb-2"],["width","10rem","height","4rem"],[1,"details"],[1,"font-bold","text-lg","mb-4","flex","justify-between"],[1,"header"],[1,"text-primary"],["tooltipPosition","top","icon","pi pi-print","severity","success",3,"onClick","pTooltip","rounded","text"],[1,"mb-4"],[1,"font-md","text-muted-color"],["class","flex gap-2 mb-2",4,"ngIf"],["class","flex gap-2",4,"ngIf"],["class"," hover:underline",3,"routerLink","queryParams",4,"ngIf"],[1,"sale-customer","mb-4"],[1,"font-md","mb-2","text-muted-color"],[1,"ml-2","text-sm"],["class","mb-1",4,"ngIf"],[1,"order-summary","mb-4"],[3,"value","tableStyle"],[1,"mt-6"],[1,"flex","justify-center","w-full"],[3,"bc-width","bc-format","bc-value","bc-display-value"],[1,"flex","gap-2","mb-2"],[1,"pi","pi-arrow-right-arrow-left","text-muted-color"],[1,"text-red-500"],[1,"text-orange-500"],[1,"flex","gap-2"],[1,"text-blue-500","dark:text-blue-300"],[1,"hover:underline",3,"routerLink","queryParams"],[1,"mb-1"],[1,"dark:text-primary-200","flex","gap-2","items-center"],[1,"rounded","w-full",2,"width","3rem","height","3rem","object-fit","cover",3,"src","alt"]],template:function(e,l){e&1&&(r(0,"p-card"),x(1,zi,6,0,"div",2)(2,sn,57,47,"div",3),a()),e&2&&(i(),c("ngIf",l.loading),i(),c("ngIf",!l.loading))},dependencies:[L,O,T,k,P,Y,W,M,K,X,A,xe,We,B,D,J,G,re,$,ve,U,F,ae],encapsulation:2})};var oe=class n{constructor(t){this.http=t}baseUrl=Le.apiBaseUrl+"/sale-return";createSaleReturn(t){return this.http.post(this.baseUrl,t)}getSaleReturnsPage(t){return this.http.get(`${this.baseUrl}?page=${t.page}&size=${t.size}`)}getSaleReturnById(t){return this.http.get(`${this.baseUrl}/${t}`)}getSaleReturnsBySaleId(t,e){return this.http.get(`${this.baseUrl}/sale/${t}?page=${e.page}&size=${e.size}`)}static \u0275fac=function(e){return new(e||n)(Pe(Me))};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})};var pn=()=>["barcode","customer.fullName","createdBy"],mn=()=>({"min-width":"75rem"}),cn=()=>[10,20,30];function dn(n,t){if(n&1){let e=R();r(0,"div",10),_(1,"p-button",11),s(2,"translate"),r(3,"p-button",12),s(4,"translate"),b("onClick",function(){I(e);let d=u();return C(d.deleteSelectedSales())}),a()()}if(n&2){let e=u();i(),c("label",p(2,3,"ADD")),i(2),c("label",p(4,5,"DELETE"))("disabled",!e.selectedSales||!e.selectedSales.length)}}function un(n,t){n&1&&(_(0,"p-button",13),s(1,"translate")),n&2&&c("label",p(1,1,"EXPORT"))}function fn(n,t){if(n&1){let e=R();r(0,"div",14)(1,"h5",15),o(2),a(),r(3,"p-iconfield"),_(4,"p-inputicon",16),r(5,"input",17),s(6,"translate"),b("input",function(d){I(e);let v=u(),E=pe(6);return C(v.onGlobalFilter(E,d))}),a()()()}if(n&2){let e=u();i(2),m(e.tableHeader),i(3),c("placeholder",p(6,2,"SEARCH_PACEHOLDER"))}}function _n(n,t){n&1&&(r(0,"tr")(1,"th",18),_(2,"p-tableHeaderCheckbox"),a(),r(3,"th"),o(4),s(5,"translate"),a(),r(6,"th",19),o(7),s(8,"translate"),_(9,"p-sortIcon",20),a(),r(10,"th",21),o(11),s(12,"translate"),_(13,"p-sortIcon",22),a(),r(14,"th",23),o(15),s(16,"translate"),_(17,"p-sortIcon",24),a(),r(18,"th",25),o(19),s(20,"translate"),_(21,"p-sortIcon",26),a(),r(22,"th",27),o(23),s(24,"translate"),_(25,"p-sortIcon",28),a(),r(26,"th",29),o(27),s(28,"translate"),_(29,"p-sortIcon",30),a(),r(30,"th",31),o(31),s(32,"translate"),_(33,"p-sortIcon",32),a(),r(34,"th"),o(35),s(36,"translate"),a()()),n&2&&(i(4),f(" ",p(5,9,"BARCODE")," "),i(3),f(" ",p(8,11,"DATE")," "),i(4),f(" ",p(12,13,"CUSTOMER")," "),i(4),f(" ",p(16,15,"SUB_TOTAL")," "),i(4),f(" ",p(20,17,"EXTRA_FEES")," "),i(4),f(" ",p(24,19,"TOTAL_REFUND")," "),i(4),f(" ",p(28,21,"CREATED_BY")," "),i(4),f(" ",p(32,23,"SALE")," "),i(4),m(p(36,25,"OPTIONS")))}function vn(n,t){if(n&1){let e=R();r(0,"tr")(1,"td"),_(2,"p-tableCheckbox",33),a(),r(3,"td")(4,"a",34),b("click",function(){let d=I(e).$implicit,v=u();return C(v.showDetails(d))}),o(5),a()(),r(6,"td"),o(7),s(8,"dateFt"),a(),r(9,"td"),o(10),a(),r(11,"td"),o(12),s(13,"sCurrency"),a(),r(14,"td"),o(15),s(16,"sCurrency"),a(),r(17,"td",35),o(18),s(19,"sCurrency"),a(),r(20,"td"),o(21),a(),r(22,"td",36),o(23),a(),r(24,"td"),_(25,"p-menu",37,6),r(27,"button",38),b("click",function(d){let v=I(e).$implicit,E=pe(26);return u().getMenuItems(v),C(E.toggle(d))}),a()()()}if(n&2){let e=t.$implicit,l=u();i(2),c("value",e),i(3),m(e.barcode),i(2),f(" ",N(8,11,e.returnDate,"long")," "),i(3),f(" ",e.sale==null||e.sale.customer==null?null:e.sale.customer.fullName," "),i(2),f(" ",p(13,14,e.subTotal)," "),i(3),f(" ",p(16,16,e.feesAmount)," "),i(3),f(" ",p(19,18,e.totalAmount)," "),i(3),f(" ",e.returnedBy," "),i(2),f(" ",e.sale.barcode," "),i(2),c("popup",!0)("model",l.menuItems)}}var Te=class n{constructor(t,e,l,d,v){this.saleReturnService=t;this.saleService=e;this.translate=l;this.route=d;this.router=v}loading=!1;pageReq=new le(0,10);pageDetails;returnList=[];sale;selectedSales;cols;tableHeader="";mode;menuItems=[];ngOnInit(){this.fetchSaleDetails(),this.tableHeader=this.translate.instant("SALE_RETURN_LIST")}getSaleReturnsPage(){this.loading=!0,this.sale&&this.sale.saleId?this.saleReturnService.getSaleReturnsBySaleId(this.sale.saleId,this.pageReq).subscribe(t=>{t.success&&(this.returnList=t.data.content,this.pageDetails=t.data.page,this.loading=!1)}):this.saleReturnService.getSaleReturnsPage(this.pageReq).subscribe(t=>{t.success&&(this.returnList=t.data.content,this.pageDetails=t.data.page,this.loading=!1)})}onPageChange(t){this.pageReq.page=t.page,this.pageReq.size=t.rows,this.getSaleReturnsPage()}onGlobalFilter(t,e){t.filterGlobal(e.target.value,"contains")}getMenuItems(t){this.menuItems=[{label:this.translate.instant("SHOW_DETAILS"),icon:"pi pi-eye",command:()=>{this.showDetails(t)}},{label:this.translate.instant("EDIT"),icon:"pi pi-pencil",command:()=>{}},{label:this.translate.instant("DELETE"),icon:"pi pi-trash",command:()=>{}}]}deleteSale(t){}deleteSelectedSales(){}showSaleDetails(t){}fetchSaleDetails(){this.loading=!0;let t=this.route.snapshot.queryParamMap.get("saleId");if(t){let e=Number.parseInt(t);e&&Number.isInteger(e)&&this.saleService.getSaleById(e).subscribe(l=>{l.success?(this.sale=l.data,this.tableHeader=this.translate.instant("ALL_SALE_RETURNS",{name:this.sale.barcode}),this.getSaleReturnsPage()):this.router.navigate(["/notfound"]),this.loading=!1})}else this.getSaleReturnsPage()}saleDetails(t){this.router.navigate(["sales/detail",t.saleId])}saleReturn(t){this.router.navigate(["sales/sale-return",t.saleId])}showDetails(t){this.router.navigate(["/sales/sale-return/detail",t.saleReturnId])}static \u0275fac=function(e){return new(e||n)(g(oe),g(q),g(z),g(ne),g(Q))};static \u0275cmp=w({type:n,selectors:[["app-sale-return-list"]],decls:14,vars:17,consts:[["start",""],["end",""],["dt",""],["caption",""],["header",""],["body",""],["menu",""],["styleClass","mb-6"],["dataKey","saleId",3,"selectionChange","value","rows","columns","loading","globalFilterFields","tableStyle","selection","rowHover"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords}",3,"onPageChange","first","rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","showJumpToPageDropdown"],[1,"flex","items-center","gap-2"],["icon","pi pi-plus","severity","secondary",1,"mr-2",3,"label"],["severity","secondary","icon","pi pi-trash","outlined","",3,"onClick","label","disabled"],["icon","pi pi-upload","severity","secondary",3,"label"],[1,"flex","items-center","justify-between"],[1,"m-0"],["styleClass","pi pi-search"],["pInputText","","type","text",3,"input","placeholder"],[2,"width","3rem"],["pSortableColumn","returnDate"],["field","returnDate"],["pSortableColumn","sale.customer.fullName"],["field","sale.customer.fullName"],["pSortableColumn","subTotal"],["field","subTotal"],["pSortableColumn","feesAmount"],["field","feesAmount"],["pSortableColumn","totalAmount"],["field","totalAmount"],["pSortableColumn","returnedBy"],["field","returnedBy"],["pSortableColumn","sale.saleId"],["field","sale.saleId"],[3,"value"],[1,"text-primary","cursor-pointer","hover:underline",3,"click"],[1,"text-orange-500"],[1,"text-primary"],["appendTo","body",3,"popup","model"],["pButton","","icon","pi pi-ellipsis-v",1,"p-button-text",3,"click"]],template:function(e,l){if(e&1){let d=R();r(0,"p-toolbar",7),x(1,dn,5,7,"ng-template",null,0,h)(3,un,2,3,"ng-template",null,1,h),a(),r(5,"p-table",8,2),te("selectionChange",function(E){return I(d),ee(l.selectedSales,E)||(l.selectedSales=E),C(E)}),x(7,fn,7,4,"ng-template",null,3,h)(9,_n,37,27,"ng-template",null,4,h)(11,vn,28,20,"ng-template",null,5,h),a(),r(13,"p-paginator",9),b("onPageChange",function(E){return I(d),C(l.onPageChange(E))}),a()}e&2&&(i(5),c("value",l.returnList)("rows",10)("columns",l.cols)("loading",l.loading)("globalFilterFields",S(14,pn))("tableStyle",S(15,mn)),Z("selection",l.selectedSales),c("rowHover",!0),i(8),c("first",l.pageReq.page*l.pageReq.size)("rows",l.pageReq.size)("totalRecords",(l.pageDetails==null?null:l.pageDetails.totalElements)||0)("rowsPerPageOptions",S(16,cn))("showCurrentPageReport",!0)("showJumpToPageDropdown",!1))},dependencies:[T,J,G,ke,Oe,Ve,qe,P,L,fe,O,Ue,M,ue,He,je,$e,B,D,ce,de,Ne,_e,A,F,U],encapsulation:2})};var rt=class{sale;returnItems;subTotal;feesAmount;totalAmount;constructor(t){this.sale=t,this.feesAmount=0,this.subTotal=0,this.totalAmount=0,this.returnItems=t.saleItems.map(e=>new ot(e,0))}fillCart(t){this.returnItems=t.saleItems.map(e=>new ot(e,e.quantity-e.returnedQuantity)),this.updateAmount()}increaseItemQty(t){let e=this.returnItems.find(l=>l.saleItem.saleItemId==t.saleItem.saleItemId);e&&e.quantity<e.saleItem.quantity-e.saleItem.returnedQuantity&&(e.quantity++,this.updateAmount())}decreaseItemQty(t){let e=this.returnItems.find(l=>l.saleItem.saleItemId==t.saleItem.saleItemId);e&&e.quantity>0&&(e.quantity--,this.updateAmount())}updateAmount(){let t=0;this.returnItems.forEach(e=>{t+=e.quantity*e.saleItem.unitPrice}),this.subTotal=t,this.totalAmount=this.subTotal-this.feesAmount}},ot=class{saleItem;quantity;constructor(t,e){this.saleItem=t,this.quantity=e}};var lt=class{saleId;returnItems;feesAmount;constructor(t){this.saleId=t.sale.saleId,this.feesAmount=t.feesAmount,this.returnItems=t.returnItems.filter(e=>e.quantity>0).map(e=>new ut(e))}},ut=class{saleItemId;quantity;constructor(t){this.saleItemId=t.saleItem.saleItemId,this.quantity=t.quantity}};var Sn=()=>({width:"450px"}),Zt=()=>({"min-width":"50rem"}),gn=()=>[1],xn=()=>({width:"100%"}),In=()=>({width:"30%"}),Cn=()=>({width:"20%"}),ei=()=>({width:"25%"}),hn=()=>({width:"3rem"}),ft=()=>({width:"50%"});function bn(n,t){n&1&&(r(0,"div",6),_(1,"p-skeleton",7)(2,"p-skeleton",8)(3,"p-skeleton",9)(4,"p-skeleton",10)(5,"p-skeleton",11),a())}function yn(n,t){n&1&&(r(0,"div",30)(1,"span"),o(2),s(3,"translate"),a(),o(4),s(5,"translate"),a()),n&2&&(i(2),m(p(3,2,"NAME")),i(2),f(": ",p(5,4,"NOT_REGISTERED_CUSTOMER")," "))}function En(n,t){if(n&1&&(r(0,"div",30)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"NAME")),i(2),f(": ",e.sale.customer.fullName," ")}}function Rn(n,t){if(n&1&&(r(0,"div",30)(1,"span"),o(2),s(3,"translate"),a(),o(4,": "),r(5,"span",20),o(6),a()()),n&2){let e=u(2);i(2),m(p(3,2,"PHONE")),i(4),m(e.sale.customer.phone)}}function Tn(n,t){if(n&1&&(r(0,"div",30)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"COUNTRY")),i(2),f(": ",e.sale.customer.country," ")}}function wn(n,t){if(n&1&&(r(0,"div",30)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"ADDRESS")),i(2),f(": ",e.sale.customer.address," ")}}function Pn(n,t){if(n&1&&(r(0,"div",30)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"EMAIL")),i(2),f(": ",e.sale.customer.email," ")}}function Dn(n,t){n&1&&(r(0,"tr")(1,"th"),o(2),s(3,"translate"),a(),r(4,"th"),o(5),s(6,"translate"),a(),r(7,"th"),o(8),s(9,"translate"),a(),r(10,"th"),o(11),s(12,"translate"),a()()),n&2&&(i(2),m(p(3,4,"PRODUCT")),i(3),m(p(6,6,"UNIT_PRICE")),i(3),m(p(9,8,"QUANTITY_TO_RETURN")),i(3),m(p(12,10,"SUB_TOTAL")))}function Bn(n,t){if(n&1){let e=R();r(0,"span",35),b("click",function(){I(e);let d=u().$implicit,v=u(2);return C(v.returnCart.increaseItemQty(d))}),_(1,"span",36),a()}}function Mn(n,t){if(n&1){let e=R();r(0,"span",35),b("click",function(){I(e);let d=u().$implicit,v=u(2);return C(v.returnCart.decreaseItemQty(d))}),_(1,"span",37),a()}}function An(n,t){if(n&1){let e=R();r(0,"tr")(1,"td",31)(2,"div",32),_(3,"img",33),r(4,"div"),o(5),s(6,"substring"),a()()(),r(7,"td"),o(8),s(9,"sCurrency"),a(),r(10,"td")(11,"p-inputnumber",34),te("ngModelChange",function(d){let v=I(e).$implicit;return ee(v.quantity,d)||(v.quantity=d),C(d)}),x(12,Bn,2,0,"ng-template",null,2,h)(14,Mn,2,0,"ng-template",null,3,h),a()(),r(16,"td"),o(17),s(18,"sCurrency"),a()()}if(n&2){let e=t.$implicit,l=u(2);i(),y(S(24,In)),i(2),c("src",l.getProductImageSrc(e.saleItem.product),H)("alt",e.saleItem.product.basicDetails==null?null:e.saleItem.product.basicDetails.productName),i(2),m(N(6,17,e.saleItem.product.basicDetails.productName,"medium")),i(2),y(S(25,Cn)),i(),m(p(9,20,e.saleItem.unitPrice)),i(2),y(S(26,ei)),i(),Z("ngModel",e.quantity),c("max",e.saleItem.quantity-e.saleItem.returnedQuantity)("showButtons",!0)("inputStyle",S(27,hn)),i(5),y(S(28,ei)),i(),m(p(18,22,e.quantity*e.saleItem.unitPrice))}}function Ln(n,t){n&1&&_(0,"tr")}function Nn(n,t){if(n&1&&(r(0,"tr")(1,"td"),o(2),s(3,"translate"),a(),r(4,"td"),o(5),s(6,"sCurrency"),a()(),r(7,"tr")(8,"td"),o(9),s(10,"translate"),a(),r(11,"td"),o(12),s(13,"sCurrency"),a()(),r(14,"tr")(15,"td"),o(16),s(17,"translate"),a(),r(18,"td",20),o(19),s(20,"sCurrency"),a()()),n&2){let e=u(2);i(2),m(p(3,12,"SUB_TOTAL")),i(2),y(S(24,ft)),i(),m(p(6,14,e.returnCart.subTotal)),i(4),m(p(10,16,"SALE_RETURN_FEES")),i(2),y(S(25,ft)),i(),m(p(13,18,e.returnCart.feesAmount)),i(4),m(p(17,20,"TOTAL_REFUND")),i(2),y(S(26,ft)),i(),m(p(20,22,e.returnCart.totalAmount))}}function Fn(n,t){if(n&1){let e=R();r(0,"div",12)(1,"div",13)(2,"div",14)(3,"span"),o(4),s(5,"translate"),a()(),r(6,"p-button",15),s(7,"translate"),b("onClick",function(){I(e);let d=u();return C(d.returnAll())}),Ct(),r(8,"svg",16),_(9,"path",17),a()()(),ht(),r(10,"div",18)(11,"span",19),o(12),s(13,"translate"),a(),r(14,"span",20),o(15),a()(),r(16,"div",18)(17,"span",19),o(18),s(19,"translate"),a(),r(20,"span"),o(21),s(22,"dateFt"),a()(),r(23,"div",21)(24,"div",22),o(25),s(26,"translate"),a(),r(27,"div",23),x(28,yn,6,6,"div",24)(29,En,5,4,"div",24)(30,Rn,7,4,"div",24)(31,Tn,5,4,"div",24)(32,wn,5,4,"div",24)(33,Pn,5,4,"div",24),a()(),r(34,"div",18)(35,"span",19),o(36),s(37,"translate"),a(),r(38,"span"),o(39),a()(),r(40,"div",25)(41,"div",22),o(42),s(43,"translate"),a(),r(44,"p-table",26),x(45,Dn,13,12,"ng-template",null,0,h)(47,An,19,29,"ng-template",null,1,h),a(),r(49,"div",27)(50,"p-table",26),x(51,Ln,1,0,"ng-template",null,0,h)(53,Nn,21,27,"ng-template",null,1,h),a()()(),r(55,"div",28)(56,"p-button",29),s(57,"translate"),b("onClick",function(){I(e);let d=u();return C(d.submitSaleReturn())}),a()()()}if(n&2){let e=u();i(4),m(p(5,26,"PRODUCTS_RETURN_REQUEST")),i(2),c("pTooltip",p(7,28,"RETURN_ALL"))("rounded",!0)("text",!0),i(6),m(p(13,30,"SALE")+": "),i(3),m(" "+e.sale.barcode+" "),i(3),m(p(19,32,"TIMESTAMP")+": "),i(3),m(N(22,34,e.sale.createdAt,"long")),i(4),f(" ",p(26,37,"CUSTOMER_DETAILS")," "),i(3),c("ngIf",!e.sale.customer),i(),c("ngIf",e.sale.customer),i(),c("ngIf",e.sale.customer),i(),c("ngIf",e.sale.customer&&e.sale.customer.country),i(),c("ngIf",e.sale.customer&&e.sale.customer.address),i(),c("ngIf",e.sale.customer&&e.sale.customer.email),i(3),m(p(37,39,"SOLD_BY")+": "),i(3),m(e.sale.createdBy),i(3),f(" ",p(43,41,"ORDER_DETAILS")," "),i(2),c("value",e.returnCart.returnItems)("tableStyle",S(45,Zt)),i(6),c("value",S(46,gn))("tableStyle",S(47,Zt)),i(6),y(S(48,xn)),c("loading",e.submitLoading)("label",p(57,43,"SUBMIT_RETURN_ORDER"))}}var st=class n{constructor(t,e,l,d,v,E,vt){this.saleService=t;this.saleReturnService=e;this.route=l;this.toast=d;this.translate=v;this.confirmService=E;this.router=vt}sale;loading=!1;returnCart;submitLoading=!1;ngOnInit(){this.fetchSaleDetails()}fetchSaleDetails(){this.loading=!0;let t=this.route.snapshot.paramMap.get("saleId");if(t){let e=Number.parseInt(t);e&&Number.isInteger(e)&&this.saleService.getSaleById(e).subscribe(l=>{l.success?(this.sale=l.data,this.returnCart=new rt(this.sale),console.log(this.sale)):this.router.navigate(["/notfound"]),this.loading=!1})}}submitSaleReturn(){this.submitLoading=!0;let t=new lt(this.returnCart);(!t.returnItems||!t.returnItems.length)&&this.toast.showWarn(this.translate.instant("EMPTY_SALE_RETURN_WARN_MSG")),this.saleReturnService.createSaleReturn(t).subscribe(e=>{e.success?(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.fetchSaleDetails()):this.toast.showWarn(e.message),this.submitLoading=!1})}returnAll(){let t=this.translate.instant("RETURN_ALL_ALERT_MSG");this.confirmService.dialogAlert(t,()=>{this.returnCart.fillCart(this.sale),this.submitSaleReturn()})}getProductImageSrc(t){return j.getFirstImageSrc(t)}static \u0275fac=function(e){return new(e||n)(g(q),g(oe),g(ne),g(ge),g(z),g(jt),g(Q))};static \u0275cmp=w({type:n,selectors:[["app-sale-return-create"]],decls:5,vars:5,consts:[["header",""],["body",""],["incrementbuttonicon",""],["decrementbuttonicon",""],["class","loading",4,"ngIf"],["class","details",4,"ngIf"],[1,"loading"],["styleClass","mb-2"],["width","10rem","styleClass","mb-2"],["width","5rem","styleClass","mb-2"],["height","2rem","styleClass","mb-2"],["width","10rem","height","4rem"],[1,"details"],[1,"font-bold","text-lg","mb-4","flex","justify-between"],[1,"header"],["tooltipPosition","top","severity","success",3,"onClick","pTooltip","rounded","text"],["xmlns","http://www.w3.org/2000/svg","width","1em","height","1em","viewBox","0 0 14 14"],["fill","currentColor","fill-rule","evenodd","d","M6.545.998a1 1 0 0 0 0 2h2.728a2.638 2.638 0 0 1 0 5.275H4.817V6.545a1 1 0 0 0-1.707-.707L.384 8.564a1 1 0 0 0-.22 1.09q.073.18.218.327l2.728 2.728a1 1 0 0 0 1.707-.707v-1.729h4.456a4.638 4.638 0 1 0 0-9.275z","clip-rule","evenodd"],[1,"mb-4"],[1,"font-md","text-surface-400"],[1,"text-primary"],[1,"sale-customer","mb-4"],[1,"font-md","mb-2","text-surface-400"],[1,"ml-2","text-sm"],["class","mb-1",4,"ngIf"],[1,"order-summary","mb-4"],[3,"value","tableStyle"],[1,"mt-6"],[1,"flex","justify-center","w-full"],[3,"onClick","loading","label"],[1,"mb-1"],[1,"dark:text-primary-200"],[1,"flex","items-center","gap-2"],[1,"rounded","w-full",2,"width","3rem","height","3rem","object-fit","cover",3,"src","alt"],["readonly","true","min","0","buttonLayout","horizontal","spinnerMode","horizontal",3,"ngModelChange","ngModel","max","showButtons","inputStyle"],[1,"w-full","h-full","flex","items-center","justify-center",3,"click"],[1,"pi","pi-plus"],[1,"pi","pi-minus"]],template:function(e,l){e&1&&(r(0,"p-card"),x(1,bn,6,0,"div",4)(2,Fn,58,49,"div",5),a(),_(3,"p-toast")(4,"p-confirmdialog")),e&2&&(i(),c("ngIf",l.loading),i(),c("ngIf",!l.loading),i(2),y(S(4,Sn)))},dependencies:[L,O,T,k,P,me,Ae,Y,W,M,K,X,A,xe,B,D,J,G,re,$,ve,Fe,Se,U,Qe],encapsulation:2})};var kn=n=>["/sales/detail",n],ti=()=>({"min-width":"50rem"}),On=()=>[1],Vn=()=>({width:"30%"}),qn=()=>({width:"20%"}),ii=()=>({width:"25%"}),_t=()=>({width:"50%"});function Un(n,t){n&1&&(r(0,"div",4),_(1,"p-skeleton",5)(2,"p-skeleton",6)(3,"p-skeleton",7)(4,"p-skeleton",8)(5,"p-skeleton",9),a())}function jn(n,t){n&1&&(r(0,"div",27)(1,"span"),o(2),s(3,"translate"),a(),o(4),s(5,"translate"),a()),n&2&&(i(2),m(p(3,2,"NAME")),i(2),f(": ",p(5,4,"NOT_REGISTERED_CUSTOMER")," "))}function Hn(n,t){if(n&1&&(r(0,"div",27)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"NAME")),i(2),f(": ",e.saleReturn.sale.customer.fullName," ")}}function Qn(n,t){if(n&1&&(r(0,"div",27)(1,"span"),o(2),s(3,"translate"),a(),o(4,": "),r(5,"span",13),o(6),a()()),n&2){let e=u(2);i(2),m(p(3,2,"PHONE")),i(4),m(e.saleReturn.sale.customer.phone)}}function $n(n,t){if(n&1&&(r(0,"div",27)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"COUNTRY")),i(2),f(": ",e.saleReturn.sale.customer.country," ")}}function zn(n,t){if(n&1&&(r(0,"div",27)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"ADDRESS")),i(2),f(": ",e.saleReturn.sale.customer.address," ")}}function Wn(n,t){if(n&1&&(r(0,"div",27)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"EMAIL")),i(2),f(": ",e.saleReturn.sale.customer.email," ")}}function Yn(n,t){n&1&&(r(0,"tr")(1,"th"),o(2),s(3,"translate"),a(),r(4,"th"),o(5),s(6,"translate"),a(),r(7,"th"),o(8),s(9,"translate"),a(),r(10,"th"),o(11),s(12,"translate"),a()()),n&2&&(i(),y(S(20,Vn)),i(),m(p(3,12,"PRODUCT")),i(2),y(S(21,qn)),i(),m(p(6,14,"UNIT_PRICE")),i(2),y(S(22,ii)),i(),m(p(9,16,"RETURNED_QUANTITY")),i(2),y(S(23,ii)),i(),m(p(12,18,"SUB_TOTAL")))}function Gn(n,t){if(n&1&&(r(0,"tr")(1,"td",28),_(2,"img",29),o(3),s(4,"substring"),a(),r(5,"td"),o(6),s(7,"sCurrency"),a(),r(8,"td"),o(9),a(),r(10,"td"),o(11),s(12,"sCurrency"),a()()),n&2){let e=t.$implicit,l=u(2);i(2),c("src",l.getProductImageSrc(e.saleItem.product),H)("alt",e.saleItem.product.basicDetails==null?null:e.saleItem.product.basicDetails.productName),i(),f(" ",N(4,6,e.saleItem.product.basicDetails.productName,"medium")," "),i(3),m(p(7,9,e.saleItem.unitPrice)),i(3),m(e.quantity),i(2),m(p(12,11,e.subTotal))}}function Jn(n,t){n&1&&_(0,"tr")}function Xn(n,t){if(n&1&&(r(0,"tr")(1,"td"),o(2),s(3,"translate"),a(),r(4,"td"),o(5),s(6,"sCurrency"),a()(),r(7,"tr")(8,"td"),o(9),s(10,"translate"),a(),r(11,"td"),o(12),s(13,"sCurrency"),a()(),r(14,"tr")(15,"td"),o(16),s(17,"translate"),a(),r(18,"td",13),o(19),s(20,"sCurrency"),a()()),n&2){let e=u(2);i(2),m(p(3,12,"GRAND_TOTAL")),i(2),y(S(24,_t)),i(),m(p(6,14,e.saleReturn.subTotal)),i(4),m(p(10,16,"EXTRA_FEES")),i(2),y(S(25,_t)),i(),m(p(13,18,e.saleReturn.feesAmount)),i(4),m(p(17,20,"TOTAL_REFUND")),i(2),y(S(26,_t)),i(),m(p(20,22,e.saleReturn.totalAmount))}}function Kn(n,t){if(n&1&&(r(0,"div",10)(1,"div",11)(2,"div",12)(3,"span"),o(4),s(5,"translate"),a(),o(6,": "),r(7,"span",13),o(8),a()(),_(9,"p-button",14),s(10,"translate"),a(),r(11,"div",15)(12,"span",16),o(13),s(14,"translate"),a(),r(15,"span"),o(16),s(17,"dateFt"),a()(),r(18,"div",15)(19,"span",16),o(20),s(21,"translate"),a(),r(22,"a",17),o(23),a()(),r(24,"div",18)(25,"div",19),o(26),s(27,"translate"),a(),r(28,"div",20),x(29,jn,6,6,"div",21)(30,Hn,5,4,"div",21)(31,Qn,7,4,"div",21)(32,$n,5,4,"div",21)(33,zn,5,4,"div",21)(34,Wn,5,4,"div",21),a()(),r(35,"div",22)(36,"div",19),o(37),s(38,"translate"),a(),r(39,"p-table",23),x(40,Yn,13,24,"ng-template",null,0,h)(42,Gn,13,13,"ng-template",null,1,h),a(),r(44,"div",24)(45,"p-table",23),x(46,Jn,1,0,"ng-template",null,0,h)(48,Xn,21,27,"ng-template",null,1,h),a()()(),r(50,"div",15)(51,"span",16),o(52),s(53,"translate"),a(),r(54,"span"),o(55),a()(),r(56,"div",25),_(57,"ngx-barcode6",26),a()()),n&2){let e=u();i(4),m(p(5,28,"SALE_RETURN_DETAILS")),i(4),m(" "+e.saleReturn.barcode+" "),i(),c("pTooltip",p(10,30,"PRINT_RECEIPT"))("rounded",!0)("text",!0),i(4),m(p(14,32,"TIMESTAMP")+": "),i(3),m(N(17,34,e.saleReturn.returnDate,"long")),i(4),m(p(21,37,"SALE")+": "),i(2),c("routerLink",ie(45,kn,e.saleReturn.sale.saleId)),i(),m(e.saleReturn.sale.barcode),i(3),f(" ",p(27,39,"CUSTOMER_DETAILS")," "),i(3),c("ngIf",!e.saleReturn.sale.customer),i(),c("ngIf",e.saleReturn.sale.customer),i(),c("ngIf",e.saleReturn.sale.customer),i(),c("ngIf",e.saleReturn.sale.customer&&e.saleReturn.sale.customer.country),i(),c("ngIf",e.saleReturn.sale.customer&&e.saleReturn.sale.customer.address),i(),c("ngIf",e.saleReturn.sale.customer&&e.saleReturn.sale.customer.email),i(3),f(" ",p(38,41,"ORDER_DETAILS")," "),i(2),c("value",e.saleReturn.returnItems)("tableStyle",S(47,ti)),i(6),c("value",S(48,On))("tableStyle",S(49,ti)),i(7),m(p(53,43,"RETURNED_BY")+": "),i(3),m(e.saleReturn.returnedBy),i(2),c("bc-width",3)("bc-format","CODE128")("bc-value",e.saleReturn.barcode)("bc-display-value",!0)}}var pt=class n{constructor(t,e,l){this.saleReturnService=t;this.route=e;this.router=l}saleReturn;loading=!1;ngOnInit(){this.fetchSaleDetails()}fetchSaleDetails(){this.loading=!0;let t=this.route.snapshot.paramMap.get("saleReturnId");if(t){let e=Number.parseInt(t);e&&Number.isInteger(e)&&this.saleReturnService.getSaleReturnById(e).subscribe(l=>{l.success?this.saleReturn=l.data:this.router.navigate(["/notfound"]),console.log(l),this.loading=!1})}}getProductImageSrc(t){return j.getFirstImageSrc(t)}static \u0275fac=function(e){return new(e||n)(g(oe),g(ne),g(Q))};static \u0275cmp=w({type:n,selectors:[["app-sale-return-details"]],decls:3,vars:2,consts:[["header",""],["body",""],["class","loading",4,"ngIf"],["class","details",4,"ngIf"],[1,"loading"],["styleClass","mb-2"],["width","10rem","styleClass","mb-2"],["width","5rem","styleClass","mb-2"],["height","2rem","styleClass","mb-2"],["width","10rem","height","4rem"],[1,"details"],[1,"font-bold","text-lg","mb-4","flex","justify-between"],[1,"header"],[1,"text-primary"],["tooltipPosition","top","icon","pi pi-print","severity","success",3,"pTooltip","rounded","text"],[1,"mb-4"],[1,"font-md","text-muted-color"],[1,"text-primary","hover:underline",3,"routerLink"],[1,"sale-customer","mb-4"],[1,"font-md","mb-2","text-muted-color"],[1,"ml-2","text-sm"],["class","mb-1",4,"ngIf"],[1,"order-summary","mb-4"],[3,"value","tableStyle"],[1,"mt-6"],[1,"flex","justify-center","w-full"],[3,"bc-width","bc-format","bc-value","bc-display-value"],[1,"mb-1"],[1,"dark:text-primary-200","flex","items-center","gap-2"],[1,"rounded","w-full",2,"width","3rem","height","3rem","object-fit","cover",3,"src","alt"]],template:function(e,l){e&1&&(r(0,"p-card"),x(1,Un,6,0,"div",2)(2,Kn,58,50,"div",3),a()),e&2&&(i(),c("ngIf",l.loading),i(),c("ngIf",!l.loading))},dependencies:[L,O,T,k,P,Y,W,M,K,X,A,xe,We,B,D,J,G,re,$,ve,U,F,ae],encapsulation:2})};var Zn=[{path:"pos",component:tt},{path:"list",component:it},{path:"detail/:saleId",component:at},{path:"sale-return",children:[{path:"list",component:Te},{path:":saleId",component:Te},{path:"create/:saleId",component:st},{path:"detail/:saleReturnId",component:pt}]}],mt=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=De({type:n});static \u0275inj=we({imports:[F.forChild(Zn),F]})};var ni=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=De({type:n});static \u0275inj=we({imports:[T,mt]})};export{ni as SalesModule};
