import{a as je}from"./chunk-JQICBPRN.js";import{a as Ae,b as Oe}from"./chunk-CJQUUSTS.js";import{a as Le}from"./chunk-DBBLTLGT.js";import"./chunk-UKT22RCV.js";import{a as Be}from"./chunk-O3SRXZ6G.js";import{a as ye,b as Te}from"./chunk-CBWDQ4RF.js";import"./chunk-BUWKAAGZ.js";import{e as Ee,f as we}from"./chunk-RVWQYIQS.js";import{b as Ie}from"./chunk-U6VIG5J4.js";import{a as Re,b as De}from"./chunk-VE5ZA4EI.js";import{A as Ce,m as fe,n as ge,q as _e,t as he,u as be,x as Se,y as ve}from"./chunk-DJHBNVEJ.js";import"./chunk-2CRVAWPL.js";import"./chunk-5IQ2NTOW.js";import"./chunk-LVVCGXCS.js";import{a as Ve}from"./chunk-MN5LVCU7.js";import{a as ke,b as Pe}from"./chunk-AMELEMFQ.js";import{a as Ne}from"./chunk-BGLM7VYL.js";import{a as te,c as re,d as oe,e as ne}from"./chunk-TGB364TN.js";import{d as Me,e as Fe}from"./chunk-N474PGLI.js";import{b as xe,c as Ue}from"./chunk-7G2FJQ27.js";import"./chunk-E2WTBZXM.js";import{a as ie,c as ae,d as se,h as le,i as pe}from"./chunk-XBK3DIBG.js";import{m as N}from"./chunk-RL6IEZWP.js";import{Ia as z,Ja as E,La as J,Ma as K,Na as A,Oa as v,Qa as Q,Ta as X,Ua as Y,Xa as Z,Ya as ee,b as $,ob as me,pb as de,rb as ce,sb as ue}from"./chunk-AQJP2JMO.js";import{Db as o,Eb as i,Fb as c,Jb as x,Lb as S,Mb as h,Qc as W,U as j,Ua as r,V as T,Va as w,Xb as G,Yb as m,Z as q,Zb as C,Zc as R,_b as u,ac as P,bc as B,cc as V,ec as y,fb as H,gb as L,ha as g,ia as _,mb as I,oc as a,pc as s,sc as U,ub as p,xb as k}from"./chunk-HRECHPDI.js";import"./chunk-EQDQRRRY.js";var D=class n{constructor(e){this.http=e}baseUrl=te.apiBaseUrl+"/user";getUsersPage(e){return this.http.get(`${this.baseUrl}?page=${e.page}&size=${e.size}`)}createUser(e){return this.http.post(this.baseUrl,e)}updateUser(e){return this.http.put(this.baseUrl,e)}toggleUserLock(e,t){return this.http.get(`${this.baseUrl}/lock/${e}?lock=${t}`)}deleteUser(e){return this.http.delete(`${this.baseUrl}/${e}`)}static \u0275fac=function(t){return new(t||n)(q($))};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var We=()=>["username","phone","email"],$e=()=>({"min-width":"75rem"}),qe=()=>({width:"450px"});function ze(n,e){if(n&1){let t=x();o(0,"div",11)(1,"p-button",12),a(2,"translate"),S("onClick",function(){g(t);let d=h();return _(d.openNew())}),i(),o(3,"p-button",13),a(4,"translate"),S("onClick",function(){g(t);let d=h();return _(d.deleteSelectedUsers())}),i()()}if(n&2){let t=h();r(),p("label",s(2,3,"ADD")),r(2),p("label",s(4,5,"DELETE"))("disabled",!t.selectedUsers||!t.selectedUsers.length)}}function Je(n,e){n&1&&(c(0,"p-button",14),a(1,"translate")),n&2&&p("label",s(1,1,"EXPORT"))}function Ke(n,e){if(n&1){let t=x();o(0,"div",15)(1,"h5",16),m(2),a(3,"translate"),i(),o(4,"p-iconfield"),c(5,"p-inputicon",17),o(6,"input",18),a(7,"translate"),S("input",function(d){g(t);let f=h(),b=G(6);return _(f.onGlobalFilter(b,d))}),i()()()}n&2&&(r(2),C(s(3,2,"USERS")),r(4),p("placeholder",s(7,4,"SEARCH_PACEHOLDER")))}function Qe(n,e){n&1&&(o(0,"tr")(1,"th",19),c(2,"p-tableHeaderCheckbox"),i(),o(3,"th"),m(4),a(5,"translate"),i(),o(6,"th",20),m(7),a(8,"translate"),c(9,"p-sortIcon",21),i(),o(10,"th",22),m(11),a(12,"translate"),c(13,"p-sortIcon",23),i(),o(14,"th",24),m(15),a(16,"translate"),c(17,"p-sortIcon",25),i(),o(18,"th",26),m(19),a(20,"translate"),c(21,"p-sortIcon",27),i(),o(22,"th",28),m(23),a(24,"translate"),c(25,"p-sortIcon",29),i(),o(26,"th",30),m(27),a(28,"translate"),c(29,"p-sortIcon",31),i(),o(30,"th"),m(31),a(32,"translate"),i()()),n&2&&(r(4),u(" ",s(5,8,"IMAGE")," "),r(3),u(" ",s(8,10,"USERNAME")," "),r(4),u(" ",s(12,12,"ROLE")," "),r(4),u(" ",s(16,14,"PHONE")," "),r(4),u(" ",s(20,16,"EMAIL")," "),r(4),u(" ",s(24,18,"LAST_LOGIN")," "),r(4),u(" ",s(28,20,"IS_LOCKED")," "),r(4),u(" ",s(32,22,"OPTIONS")," "))}function Xe(n,e){if(n&1){let t=x();o(0,"tr")(1,"td",19),c(2,"p-tableCheckbox",32),i(),o(3,"td"),c(4,"p-avatar",33),i(),o(5,"td"),m(6),i(),o(7,"td"),m(8),i(),o(9,"td"),m(10),i(),o(11,"td"),m(12),i(),o(13,"td"),m(14),i(),o(15,"td"),m(16),a(17,"translate"),a(18,"translate"),i(),o(19,"td")(20,"div",34)(21,"p-button",35),a(22,"translate"),S("onClick",function(){let d=g(t).$implicit,f=h();return _(f.onEditUser(d))}),i(),o(23,"p-button",36),a(24,"translate"),a(25,"translate"),S("click",function(){let d=g(t).$implicit,f=h();return _(f.toggleUserLock(d))}),i(),o(26,"p-button",37),a(27,"translate"),S("onClick",function(){let d=g(t).$implicit,f=h();return _(f.onDeleteUser(d))}),i()()()()}if(n&2){let t=e.$implicit;r(2),p("value",t.userId),r(2),p("label","US"),r(2),u(" ",t.username," "),r(2),u(" ",t.role.roleName," "),r(2),u(" ",t.phone," "),r(2),u(" ",t.email," "),r(2),u(" ",t.lastLoginTime," "),r(2),u(" ",t.locked?s(17,18,"YES"):s(18,20,"NO")," "),r(5),p("pTooltip",s(22,22,"EDIT"))("rounded",!0)("outlined",!0),r(2),p("icon",t.locked?"pi pi-lock-open":"pi pi-unlock")("pTooltip",t.locked?s(24,24,"ENABLE"):s(25,26,"DISABLE"))("rounded",!0)("outlined",!0),r(3),p("pTooltip",s(27,28,"DELETE"))("rounded",!0)("outlined",!0)}}function Ye(n,e){n&1&&(o(0,"div",42)(1,"label",56),m(2),a(3,"translate"),i(),c(4,"p-password",57),i()),n&2&&(r(2),C(s(3,2,"PASSWORD")),r(2),p("toggleMask",!0))}function Ze(n,e){n&1&&(o(0,"div",42)(1,"label",58),m(2),a(3,"translate"),i(),c(4,"p-password",59),i()),n&2&&(r(2),C(s(3,3,"PASSWORD_CONFIRM")),r(2),p("toggleMask",!0)("feedback",!1))}function et(n,e){if(n&1){let t=x();o(0,"form",38),S("ngSubmit",function(){g(t);let d=h();return _(d.onSaveUser())}),o(1,"div",39)(2,"label",40),m(3),a(4,"translate"),i(),c(5,"input",41),i(),o(6,"div",42)(7,"label",43),m(8),a(9,"translate"),i(),c(10,"p-multiselect",44),a(11,"translate"),a(12,"translate"),i(),I(13,Ye,5,4,"div",45)(14,Ze,5,5,"div",45),o(15,"div",42)(16,"label",46),m(17),a(18,"translate"),i(),c(19,"input",47),i(),o(20,"div",42)(21,"label",48),m(22),a(23,"translate"),i(),c(24,"input",49),i(),o(25,"div",50)(26,"label",51),m(27),a(28,"translate"),i(),o(29,"p-fileupload",52),a(30,"translate"),S("onSelect",function(d){g(t);let f=h();return _(f.onSelectImage(d))}),i()(),o(31,"div",53)(32,"p-button",54),a(33,"translate"),S("click",function(){g(t);let d=h();return _(d.userDialog=!1)}),i(),c(34,"p-button",55),a(35,"translate"),i()()}if(n&2){let t=h();p("formGroup",t.userForm),r(3),C(s(4,15,"USERNAME")),r(5),C(s(9,17,"ROLE")),r(2),p("options",t.roles)("filter",!0)("emptyMessage",s(11,19,"NO_DATA"))("placeholder",s(12,21,"SELECT_FROM_LIST")),r(3),p("ngIf",t.mode==="create"),r(),p("ngIf",t.mode==="create"),r(3),C(s(18,23,"PHONE")),r(5),C(s(23,25,"EMAIL")),r(5),C(s(28,27,"IMAGE")),r(2),p("chooseLabel",s(30,29,"CHOOSE_FILE")),r(3),p("label",s(33,31,"CANCEL")),r(2),p("label",s(35,33,"SAVE"))}}var M=class n{constructor(e,t,l,d,f){this.userService=e;this.roleService=t;this.toast=l;this.confirm=d;this.translate=f}userDialog=!1;dialogHeader="Create User";loading=!1;pageReq=new Be(0,10);pageDetails;userList=[];roles=[];user;selectedUsers;cols;userForm;mode;ngOnInit(){this.getUsers(),this.getRoles()}getUsers(){this.userService.getUsersPage(this.pageReq).subscribe(e=>{e.success&&(this.userList=e.data.content,this.pageDetails=e.data.page)})}getRoles(){this.roleService.getAllRoles().subscribe(e=>{e.success&&(this.roles=e.data)})}onPageChange(e){this.pageReq.page=e.page,this.pageReq.size=e.rows,this.getUsers()}initUserForm(){this.userForm=new A({username:new v(null,[E.required]),password:new v(null,[E.required]),passwordConfirm:new v(null,[E.required]),phone:new v(null),email:new v(null),roleId:new v(null,[E.required])})}onSaveUser(){if(this.loading=!0,this.userForm.invalid){this.toast.showWarn(this.translate.instant("REQUIRED_FIELDS_MSG"));return}this.mode==="create"?this.userService.createUser(this.getUserPayload()).subscribe(e=>{e.success?(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.getUsers(),this.userForm.reset(),this.userDialog=!1):this.toast.showError(e.message),this.loading=!1}):this.mode==="update"&&this.userService.updateUser(this.getUserPayload()).subscribe(e=>{e.success?(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.getUsers(),this.userForm.reset(),this.userDialog=!1):this.toast.showError(e.message),this.loading=!1})}getUserPayload(){let e=new FormData,t=this.userForm.value;return this.user&&e.append("userId",this.user.userId+""),e.append("username",t.username),e.append("password",t.password),e.append("passwordConfirm",t.passwordConfirm),e.append("phone",t.phone||""),e.append("email",t.email||""),e.append("roleId",t.roleId),e}openNew(){this.userDialog=!0,this.mode="create",this.dialogHeader=this.translate.instant("ADD_USER"),this.initUserForm()}deleteSelectedUsers(){}onGlobalFilter(e,t){e.filterGlobal(t.target.value,"contains")}onSelectImage(e){console.log(e)}toggleUserLock(e){this.userService.toggleUserLock(e.userId,!e.locked).subscribe(t=>{t.success?(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.getUsers()):this.toast.showError(t.message)})}onEditUser(e){this.mode="update",this.user=e,this.dialogHeader=this.translate.instant("EDIT_USER",{name:e.username}),this.userForm=new A({username:new v(e.username,[E.required]),phone:new v(e.phone,[]),email:new v(e.email,[]),roleId:new v([e.role.roleId],[E.required])}),this.userDialog=!0}onDeleteUser(e){let t=this.translate.instant("DELETE_ALERT",{name:e.username});this.confirm.dialogAlert(t,()=>{this.userService.deleteUser(e.userId).subscribe(l=>{l.success?(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.getUsers()):this.toast.showError(l.message)})})}static \u0275fac=function(t){return new(t||n)(w(D),w(je),w(Ne),w(Ve),w(re))};static \u0275cmp=H({type:n,selectors:[["app-user-list"]],decls:18,vars:25,consts:[["start",""],["end",""],["dt",""],["caption",""],["header",""],["body",""],["styleClass","mb-6"],["dataKey","userId",3,"selectionChange","value","rows","columns","loading","globalFilterFields","tableStyle","selection","rowHover"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords}",3,"onPageChange","first","rows","totalRecords","showCurrentPageReport","showJumpToPageDropdown"],[3,"visibleChange","visible","header","modal"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"flex","items-center","gap-2"],["icon","pi pi-plus","severity","secondary",1,"mr-2",3,"onClick","label"],["severity","secondary","icon","pi pi-trash","outlined","",3,"onClick","label","disabled"],["icon","pi pi-upload","severity","secondary",3,"label"],[1,"flex","items-center","justify-between"],[1,"m-0"],["styleClass","pi pi-search"],["pInputText","","type","text",3,"input","placeholder"],[2,"width","3rem"],["pSortableColumn","username"],["field","username"],["pSortableColumn","role"],["field","role"],["pSortableColumn","phone"],["field","phone"],["pSortableColumn","email"],["field","email"],["pSortableColumn","lastLoginTime"],["field","lastLoginTime"],["pSortableColumn","locked"],["field","locked"],[3,"value"],[3,"label"],[1,"flex","gap-2","items-center"],["icon","pi pi-pencil","tooltipPosition","top",3,"onClick","pTooltip","rounded","outlined"],["tooltipPosition","top","severity","warn",3,"click","icon","pTooltip","rounded","outlined"],["icon","pi pi-trash","tooltipPosition","top","severity","danger",3,"onClick","pTooltip","rounded","outlined"],[3,"ngSubmit","formGroup"],[1,"flex","items-center","gap-4","mb-4"],["for","username",1,"font-semibold","w-24"],["formControlName","username","pInputText","","id","username","autocomplete","off",1,"flex-auto"],[1,"flex","justify-between","items-center","gap-4","mb-4"],["for","role",1,"font-semibold","w-24"],["id","role","optionLabel","roleName","optionValue","roleId","selectionLimit","1","formControlName","roleId",3,"options","filter","emptyMessage","placeholder"],["class","flex justify-between items-center gap-4 mb-4",4,"ngIf"],["for","phone",1,"font-semibold","w-24"],["formControlName","phone","pInputText","","id","phone","autocomplete","off",1,"flex-auto"],["for","email",1,"font-semibold","w-24"],["formControlName","email","pInputText","","id","email","autocomplete","off",1,"flex-auto"],[1,"flex","justify-between","items-center","gap-4","mb-8"],["for","userImage",1,"font-semibold","w-24"],["mode","basic","chooseIcon","pi pi-upload","name","userImage","accept","image/*","maxFileSize","1000000",3,"onSelect","chooseLabel"],[1,"flex","justify-end","gap-2"],["severity","secondary",3,"click","label"],["type","submit",3,"label"],["for","password",1,"font-semibold","w-24"],["formControlName","password",3,"toggleMask"],["for","passwordConfirm",1,"font-semibold","w-24"],["formControlName","passwordConfirm",3,"toggleMask","feedback"]],template:function(t,l){if(t&1){let d=x();o(0,"p-toolbar",6),I(1,ze,5,7,"ng-template",null,0,U)(3,Je,2,3,"ng-template",null,1,U),i(),o(5,"p-table",7,2),V("selectionChange",function(b){return g(d),B(l.selectedUsers,b)||(l.selectedUsers=b),_(b)}),I(7,Ke,8,6,"ng-template",null,3,U)(9,Qe,33,24,"ng-template",null,4,U)(11,Xe,28,30,"ng-template",null,5,U),i(),o(13,"p-paginator",8),S("onPageChange",function(b){return g(d),_(l.onPageChange(b))}),i(),o(14,"p-dialog",9),V("visibleChange",function(b){return g(d),B(l.userDialog,b)||(l.userDialog=b),_(b)}),I(15,et,36,35,"form",10),i(),c(16,"p-toast")(17,"p-confirmdialog")}t&2&&(r(5),p("value",l.userList)("rows",10)("columns",l.cols)("loading",l.loading)("globalFilterFields",y(21,We))("tableStyle",y(22,$e)),P("selection",l.selectedUsers),p("rowHover",!0),r(8),p("first",l.pageReq.page*l.pageReq.size)("rows",l.pageReq.size)("totalRecords",(l.pageDetails==null?null:l.pageDetails.totalElements)||0)("showCurrentPageReport",!0)("showJumpToPageDropdown",!1),r(),k(y(23,qe)),P("visible",l.userDialog),p("header",l.dialogHeader)("modal",!0),r(),p("ngIf",l.userForm),r(2),k(y(24,qe)))},dependencies:[R,W,Ce,_e,he,be,Se,ve,Z,Q,z,J,K,ee,X,Y,ue,ce,Ue,xe,De,Re,de,me,Ie,Fe,Me,pe,le,se,ae,Pe,ke,ne,oe,Le,ie,ge,fe,Oe,Ae,we,Ee,Te,ye],encapsulation:2})};var tt=[{path:"list",component:M,pathMatch:"full"}],F=class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=L({type:n});static \u0275inj=T({imports:[N.forChild(tt),N]})};var He=class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=L({type:n});static \u0275inj=T({imports:[R,F]})};export{He as UsersModule};
