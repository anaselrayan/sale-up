import{a as nt,b as at,c as ct,d as st,e as mt,f as dt,g as _t}from"./chunk-LPIFUDDQ.js";import{a as A,b as Ne}from"./chunk-X5LWDADS.js";import{c as ut,d as ft}from"./chunk-ENM4NOVD.js";import{a as Ue}from"./chunk-O3SRXZ6G.js";import{e as xe,f as we}from"./chunk-2ELM3XNV.js";import{a as Le}from"./chunk-WIRIMW56.js";import{a as T,c as pe,d as me,e as de}from"./chunk-5UAWEPHZ.js";import{e as Je,g as te,m as Ge}from"./chunk-L7JGJGTX.js";import{b as lt}from"./chunk-BDX637B4.js";import{a as Fe,b as pt}from"./chunk-SGXGVKVF.js";import{a as Te,b as j}from"./chunk-BMG4SHQF.js";import{a as Ct,b as Ve}from"./chunk-7CUJPHMK.js";import{d as Re,e as De,f as gt,g as Me}from"./chunk-EQLXSBQK.js";import{A as be,D as Se,E as Pe,G as Ie,o as tt,p as ue,r as ve,s as it,t as rt,v as ot,w as ye,z as he}from"./chunk-3KSFBAUP.js";import"./chunk-BLOXM7VH.js";import{b as Ee,c as q}from"./chunk-RUYHRMRN.js";import{i as fe,j as ge,k as _e,l as Ce}from"./chunk-DA5S727S.js";import{$a as et,Ia as re,Ja as x,La as oe,Ma as ne,Na as Xe,Oa as $e,Qa as ae,Ta as le,Ua as ce,Wa as Ze,Xa as N,Ya as se,b as V,lb as L,mb as B,oa as U,rb as k,sa as ie,sb as O}from"./chunk-YJSGKVHH.js";import{$ as J,$a as v,Ab as p,Db as Z,Jb as o,Kb as r,Lb as c,Pb as S,Rb as C,Sb as d,Va as R,Vc as We,Wc as Ke,Yb as G,Zb as $,_ as w,_a as a,_b as Q,bc as ee,bd as Ye,cc as s,da as E,dc as u,dd as M,fc as Qe,gc as z,hc as W,ic as K,jc as ze,kc as I,lb as D,mb as X,na as f,oa as g,sb as b,uc as h,vc as P,wc as He,yc as y}from"./chunk-TMGVZNBO.js";var Vt=["dt"],Ut=["filter"],Nt=()=>["basicDetails.productName"],Lt=()=>({"min-width":"75rem"}),Bt=()=>[10,20,30],kt=()=>({width:"450px"});function Ot(i,e){if(i&1){let t=S();c(0,"p-button",9),o(1,"p-button",10),C("onClick",function(){f(t);let l=d();return g(l.deleteSelectedProducts())}),r()}if(i&2){let t=d();a(),p("disabled",!t.selectedProducts||!t.selectedProducts.length)}}function qt(i,e){i&1&&c(0,"p-button",11)}function jt(i,e){if(i&1){let t=S();o(0,"div",12)(1,"h5",13),s(2,"Product List"),r(),o(3,"p-iconfield"),c(4,"p-inputicon",14),o(5,"input",15),C("input",function(l){f(t);let m=d(),_=ee(7);return g(m.onGlobalFilter(_,l))}),r()()()}}function At(i,e){i&1&&(o(0,"tr")(1,"th",16),c(2,"p-tableHeaderCheckbox"),r(),o(3,"th",17),s(4," Barcode "),c(5,"p-sortIcon",18),r(),o(6,"th",19),s(7," Name "),c(8,"p-sortIcon",20),r(),o(9,"th"),s(10,"Image"),r(),o(11,"th",21),s(12," Category "),c(13,"p-sortIcon",22),r(),o(14,"th",23),s(15," Brand "),c(16,"p-sortIcon",22),r(),o(17,"th",24),s(18," Cost "),c(19,"p-sortIcon",25),r(),o(20,"th",26),s(21," Price "),c(22,"p-sortIcon",27),r(),o(23,"th",28),s(24," Quantity "),c(25,"p-sortIcon",29),r(),c(26,"th",30),r())}function Ht(i,e){if(i&1){let t=S();o(0,"tr")(1,"td",16),c(2,"p-tableCheckbox",31),r(),o(3,"td",30),s(4),r(),o(5,"td",32),s(6),r(),o(7,"td"),c(8,"img",33),r(),o(9,"td"),s(10),r(),o(11,"td"),s(12),r(),o(13,"td"),s(14),h(15,"currency"),r(),o(16,"td"),s(17),h(18,"currency"),r(),o(19,"td"),c(20,"p-tag",34),r(),o(21,"td")(22,"p-button",35),C("onClick",function(){let l=f(t).$implicit,m=d();return g(m.onEditProduct(l))}),r(),o(23,"p-button",36),C("click",function(){let l=f(t).$implicit,m=d();return g(m.deleteProduct(l))}),r()()()}if(i&2){let t=e.$implicit,n=d();a(2),p("value",t),a(2),u(t.basicDetails.barcode),a(2),u(t.basicDetails.productName),a(2),p("src",n.getProductImageSrc(t),R)("alt",t.basicDetails==null?null:t.basicDetails.productName),a(2),u(t.basicDetails.productCategory==null?null:t.basicDetails.productCategory.name),a(2),u(t.basicDetails.productBrand==null?null:t.basicDetails.productBrand.name),a(2),u(He(15,15,t.priceDetails.costPrice,"USD")),a(3),u(He(18,18,t.priceDetails.sellingPrice,"USD")),a(3),p("value",t.basicDetails.quantity)("severity",n.getQuantitySeverity(t)),a(2),p("rounded",!0)("outlined",!0),a(),p("rounded",!0)("outlined",!0)}}var Be=class i{constructor(e,t,n,l){this.productService=e;this.messageService=t;this.confirmationService=n;this.router=l}loading=!1;pageReq=new Ue(0,10);pageDetails;products=[];selectedProducts;statuses;cols;dt;filter;ngOnInit(){this.getProducts()}getProducts(){this.loading=!0,this.productService.getProductsPage(this.pageReq).subscribe(e=>{console.log(e),e.success&&(this.products=e.data.content,this.pageDetails=e.data.page),this.loading=!1})}onGlobalFilter(e,t){e.filterGlobal(t.target.value,"contains")}deleteSelectedProducts(){this.confirmationService.confirm({message:"Are you sure you want to delete the selected products?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{console.log("Deleting items ",this.selectedProducts),this.selectedProducts=null,this.messageService.add({severity:"success",summary:"Successful",detail:"Products Deleted",life:3e3})}})}deleteProduct(e){this.confirmationService.confirm({message:"Are you sure you want to delete "+e.basicDetails.productName+"?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{console.log("deleting item ",e),this.messageService.add({severity:"success",summary:"Successful",detail:"Product Deleted",life:3e3})}})}onEditProduct(e){this.router.navigate(["products/edit",e.productId])}onPageChange(e){this.pageReq.page=e.page,this.pageReq.size=e.rows,this.getProducts()}getSeverity(e){switch(e){case"INSTOCK":return"success";case"LOWSTOCK":return"warn";case"OUTOFSTOCK":return"danger";default:return"info"}}getQuantitySeverity(e){return e.basicDetails.quantity>e.basicDetails.lowStockPoint?"success":e.basicDetails.quantity<=e.basicDetails.lowStockPoint?"warn":e.basicDetails.quantity==0?"danger":"info"}getProductImageSrc(e){return A.getFirstImageSrc(e)}static \u0275fac=function(t){return new(t||i)(v(Ne),v(ie),v(U),v(te))};static \u0275cmp=D({type:i,selectors:[["app-product-list"]],viewQuery:function(t,n){if(t&1&&(G(Vt,5),G(Ut,5)),t&2){let l;$(l=Q())&&(n.dt=l.first),$(l=Q())&&(n.filter=l.first)}},features:[ze([ie,U])],decls:16,vars:21,consts:[["start",""],["end",""],["dt",""],["caption",""],["header",""],["body",""],["styleClass","mb-6"],["dataKey","productId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} products",3,"selectionChange","value","rows","columns","loading","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","rowsPerPageOptions"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords}",3,"onPageChange","first","rows","totalRecords","showCurrentPageReport","showJumpToPageDropdown"],["label","New","icon","pi pi-plus","severity","secondary",1,"mr-2"],["severity","secondary","label","Delete","icon","pi pi-trash","outlined","",3,"onClick","disabled"],["label","Export","icon","pi pi-upload","severity","secondary"],[1,"flex","items-center","justify-between"],[1,"m-0"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[2,"width","3rem"],["pSortableColumn","basicDetails.barcode",2,"min-width","16rem"],["field","barcode"],["pSortableColumn","basicDetails.productName",2,"min-width","16rem"],["field","productName"],["pSortableColumn","basicDetails.productCategory.name",2,"min-width","8rem"],["field","productBrand"],["pSortableColumn","basicDetails.productBrand?.name",2,"min-width","8rem"],["pSortableColumn","priceDetails.costPrice",2,"min-width","8rem"],["field","costPrice"],["pSortableColumn","priceDetails.sellingPrice",2,"min-width","8rem"],["field","sellingPrice"],["pSortableColumn","basicDetails.quantity",2,"min-width","12rem"],["field","quantity"],[2,"min-width","12rem"],[3,"value"],[2,"min-width","16rem"],[1,"rounded","w-full",2,"width","80px","object-fit","cover",3,"src","alt"],[3,"value","severity"],["icon","pi pi-pencil",1,"mr-2",3,"onClick","rounded","outlined"],["icon","pi pi-trash","severity","danger",3,"click","rounded","outlined"]],template:function(t,n){if(t&1){let l=S();o(0,"p-toolbar",6),b(1,Ot,2,1,"ng-template",null,0,y)(3,qt,1,0,"ng-template",null,1,y),r(),o(5,"p-card")(6,"p-table",7,2),K("selectionChange",function(_){return f(l),W(n.selectedProducts,_)||(n.selectedProducts=_),g(_)}),b(8,jt,6,0,"ng-template",null,3,y)(10,At,27,0,"ng-template",null,4,y)(12,Ht,24,21,"ng-template",null,5,y),r(),o(14,"p-paginator",8),C("onPageChange",function(_){return f(l),g(n.onPageChange(_))}),r()(),c(15,"p-confirmdialog")}t&2&&(a(6),p("value",n.products)("rows",10)("columns",n.cols)("loading",n.loading)("globalFilterFields",I(17,Nt))("tableStyle",I(18,Lt)),z("selection",n.selectedProducts),p("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",I(19,Bt)),a(8),p("first",n.pageReq.page*n.pageReq.size)("rows",n.pageReq.size)("totalRecords",(n.pageDetails==null?null:n.pageDetails.totalElements)||0)("showCurrentPageReport",!0)("showJumpToPageDropdown",!1),a(),Z(I(20,kt)))},dependencies:[M,Ye,Ie,ye,he,be,Se,Pe,N,B,L,et,q,De,Re,lt,O,k,j,ve,ot,ue,Me,pt,Fe,Ce,_e,ge,fe,Ve,Ct,rt,it,ft,ut],encapsulation:2})};var ke=class i{constructor(e){this.http=e}baseUrl=T.apiBaseUrl+"/product-image";deleteProductImage(e){return this.http.delete(`${this.baseUrl}/${e}`)}setPrimaryImage(e){return this.http.put(`${this.baseUrl}/primary/${e}`,{})}static \u0275fac=function(t){return new(t||i)(E(V))};static \u0275prov=w({token:i,factory:i.\u0275fac,providedIn:"root"})};var H=class i{constructor(e){this.http=e}baseUrl=T.apiBaseUrl;getAllCategories(){return this.http.get(`${this.baseUrl}/product-category/all`)}getCategoriesPage(e){return this.http.get(`${this.baseUrl}/product-category?page=${e.page}&size=${e.size}`)}createProductCategory(e){return this.http.post(`${this.baseUrl}/product-category`,e)}static \u0275fac=function(t){return new(t||i)(E(V))};static \u0275prov=w({token:i,factory:i.\u0275fac,providedIn:"root"})};var Oe=class i{constructor(e){this.http=e}baseUrl=T.apiBaseUrl;getAllUnits(){return this.http.get(`${this.baseUrl}/product-unit`)}static \u0275fac=function(t){return new(t||i)(E(V))};static \u0275prov=w({token:i,factory:i.\u0275fac,providedIn:"root"})};var qe=class i{constructor(e){this.confirmation=e}alert(e,t){this.confirmation.confirm({target:e.target,message:"Are you sure you want to proceed?",icon:"pi pi-exclamation-triangle",rejectButtonProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptButtonProps:{label:"Yes"},accept:()=>t()})}static \u0275fac=function(t){return new(t||i)(E(U))};static \u0275prov=w({token:i,factory:i.\u0275fac,providedIn:"root"})};var Zt=["imageUpload"],Pt=()=>[];function ei(i,e){if(i&1&&c(0,"img",36),i&2){let t=e.$implicit,n=d(2);p("src",n.getProductImageSrc(n.product.productId,t),R)}}function ti(i,e){if(i&1&&c(0,"img",37),i&2){let t=e.$implicit,n=d(2);p("src",n.getProductImageSrc(n.product.productId,t),R)}}function ii(i,e){if(i&1){let t=S();o(0,"p-button",42),C("onClick",function(){f(t);let l=d().$implicit,m=d(2);return g(m.setImageAsPrimary(l))}),r()}}function ri(i,e){i&1&&c(0,"p-tag",43)}function oi(i,e){if(i&1){let t=S();o(0,"div",38),b(1,ii,1,0,"p-button",39)(2,ri,1,0,"p-tag",40),o(3,"p-button",41),C("onClick",function(l){let m=f(t).$implicit,_=d(2);return g(_.deleteImage(l,m))}),r()()}if(i&2){let t=e.$implicit;a(),p("ngIf",!t.isPrimary),a(),p("ngIf",t.isPrimary)}}function ni(i,e){i&1&&(o(0,"div"),s(1,"Drag and drop files to here to upload."),r())}function ai(i,e){if(i&1&&(o(0,"li"),s(1),r()),i&2){let t=e.$implicit;a(),Qe("",t.name," - ",t.size," bytes")}}function li(i,e){if(i&1&&(o(0,"ul"),b(1,ai,2,2,"li",45),r()),i&2){let t=d(3);a(),p("ngForOf",t.uploadedFiles)}}function ci(i,e){if(i&1&&b(0,li,2,1,"ul",44),i&2){let t=d(2);p("ngIf",t.uploadedFiles.length)}}function si(i,e){if(i&1){let t=S();o(0,"div",33)(1,"p-galleria",34),b(2,ei,1,1,"ng-template",null,0,y)(4,ti,1,1,"ng-template",null,1,y)(6,oi,4,2,"ng-template",null,2,y),r(),o(8,"p-fileupload",35),C("onUpload",function(l){f(t);let m=d();return g(m.onUpload(l))}),b(9,ni,2,0,"ng-template",null,3,y)(11,ci,1,1,"ng-template",null,4,y),r()()}if(i&2){let t=d();a(),p("value",t.product.basicDetails.productImages)("responsiveOptions",I(4,Pt)),a(7),p("url",t.getUploadPath())("multiple",!0)}}function pi(i,e){i&1&&(o(0,"div"),s(1,"Drag and drop files to here to upload."),r())}function mi(i,e){if(i&1){let t=S();o(0,"div",16)(1,"label",46),s(2),h(3,"translate"),r(),o(4,"p-fileupload",47),C("onSelect",function(l){f(t);let m=d();return g(m.handleImageSelection(l))}),b(5,pi,2,0,"ng-template",null,3,y),r()()}i&2&&(a(2),u(P(3,4,"PRODUCT_IMAGES")),a(2),p("fileLimit",5)("showUploadButton",!1)("multiple",!0))}var Y=class i{constructor(e,t,n,l,m,_,Si,Pi,Ii,xi){this.productServie=e;this.productImageService=t;this.categoryService=n;this.unitService=l;this.toast=m;this.confirm=_;this.formBuilder=Si;this.route=Pi;this.router=Ii;this.translate=xi}mode="new";productForm;loading;categoryList=[];unitList=[];imagesFiles=[];uploadedFiles=[];imageUpload;product;ngOnInit(){this.fetchProductToEdit(),this.buildFormBasic(),this.getCategories(),this.getUnits()}fetchProductToEdit(){let e=this.route.snapshot.paramMap.get("productId");if(e){let t=Number.parseInt(e);t&&Number.isInteger(t)&&this.productServie.getProductById(t).subscribe(n=>{n.success?(this.product=n.data,this.mode="edit",this.patchFormValue()):this.router.navigate(["/notfound"])})}}patchFormValue(){this.productForm.patchValue({productName:this.product.basicDetails.productName,barcode:this.product.basicDetails.barcode,productCategoryId:[this.product.basicDetails.productCategory.productCategoryId],unitOfMeasureId:[this.product.basicDetails.unitOfMeasure.unitOfMeasureId],productBrandId:[this.product.basicDetails.productBrand?.productBrandId],productStatusId:[this.product.basicDetails.productStatus?.productStatusId],description:this.product.basicDetails.description,quantity:this.product.basicDetails.quantity,costPrice:this.product.priceDetails.costPrice,sellingPrice:this.product.priceDetails.sellingPrice,lowStockPoint:this.product.basicDetails.lowStockPoint})}getCategories(){this.categoryService.getAllCategories().subscribe(e=>this.categoryList=e.data)}getUnits(){this.unitService.getAllUnits().subscribe(e=>this.unitList=e.data)}buildFormBasic(){this.productForm=this.formBuilder.group({productName:[null,x.required],barcode:[null,x.required],productCategoryId:[null,x.required],unitOfMeasureId:[null,x.required],productBrandId:[null],productStatusId:[null],description:[null],quantity:[0,x.required],costPrice:[0,x.required],sellingPrice:[0,x.required],lowStockPoint:[0,x.required]})}getProductRequest(){let e=this.productForm.value,t=new FormData;return this.product&&t.append("productId",this.product.productId+""),t.append("productName",e.productName),t.append("barcode",e.barcode),t.append("productCategoryId",e.productCategoryId),t.append("unitOfMeasureId",e.unitOfMeasureId),e.productBrandId&&t.append("productBrandId",e.productBrandId),e.productStatusId&&t.append("productStatusId",e.productStatusId),t.append("description",e.description),t.append("quantity",e.quantity),t.append("costPrice",e.costPrice),t.append("quantity",e.quantity),t.append("sellingPrice",e.sellingPrice),t.append("lowStockPoint",e.lowStockPoint),this.imagesFiles.forEach(n=>{t.append("imageFiles",n,n.name)}),t}submit(){if(!this.productForm.valid){this.toast.showError("Make sure to enter all the required fields");return}this.mode=="new"?this.createProduct():this.mode=="edit"&&this.editProduct()}createProduct(){this.loading=!0,this.productServie.createProduct(this.getProductRequest()).subscribe(e=>{e.success&&(this.loading=!1,this.toast.showSuccess("Saved successfully"))},e=>{this.loading=!1,this.toast.showError(e.error?.message)})}editProduct(){this.loading=!0,this.productServie.editProduct(this.getProductRequest()).subscribe(e=>{e.success&&(this.loading=!1,this.toast.showSuccess("Saved successfully"))},e=>{this.loading=!1,this.toast.showError(e.error?.message)})}handleImageSelection(e){this.imagesFiles=[...e.currentFiles]}getHeader(){return this.mode=="edit"?this.translate.instant("EDIT_PRODUCT"):this.translate.instant("ADD_PRODUCTS")}getProductImageSrc(e,t){return A.getImageSrc(e,t)}deleteImage(e,t){this.confirm.alert(e,()=>{this.productImageService.deleteProductImage(t.productImageId).subscribe(n=>{n.success&&(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.fetchProductToEdit())})})}setImageAsPrimary(e){this.productImageService.setPrimaryImage(e.productImageId).subscribe(t=>{t.success&&(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.fetchProductToEdit())})}onUpload(e){e.originalEvent.body?.success?(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.fetchProductToEdit()):this.toast.showWarn(e.originalEvent.body?.message)}getUploadPath(){return T.apiBaseUrl+"/product-image/"+this.product.productId}static \u0275fac=function(t){return new(t||i)(v(Ne),v(ke),v(H),v(Oe),v(Le),v(qe),v(Ze),v(Je),v(te),v(pe))};static \u0275cmp=D({type:i,selectors:[["app-product-create"]],viewQuery:function(t,n){if(t&1&&G(Zt,5),t&2){let l;$(l=Q())&&(n.imageUpload=l.first)}},decls:62,vars:39,consts:[["item",""],["thumbnail",""],["caption",""],["empty",""],["content",""],[3,"ngSubmit","formGroup"],[1,"flex","mt-8"],[1,"card","flex","flex-col","gap-6","w-full"],[1,"font-semibold","text-xl"],["class","flex justify-center gap-2 w-full",4,"ngIf"],[1,"flex","flex-col","md:flex-row","gap-6"],[1,"flex","flex-wrap","gap-2","w-full"],["for","productName"],["pInputText","","id","productName","type","text","formControlName","productName"],["for","barcode"],["pInputText","","id","barcode","type","text","formControlName","barcode"],[1,"flex","flex-col","flex-wrap","gap-2","w-full"],["for","category"],["id","category","optionLabel","name","optionValue","productCategoryId","placeholder","Select options","selectionLimit","1","formControlName","productCategoryId",3,"options","filter"],["for","brand"],["id","brand","optionLabel","name","optionValue","productBrandId","placeholder","Select options","selectionLimit","1","formControlName","productBrandId",3,"options","filter"],["for","costPrice"],["id","costPrice","formControlName","costPrice","mode","currency","currency","USD","showButtons",""],["for","sellingPrice"],["id","sellingPrice","formControlName","sellingPrice","mode","currency","currency","USD","showButtons",""],["for","productUnit"],["id","productUnit","optionLabel","name","optionValue","unitOfMeasureId","placeholder","Select options","selectionLimit","1","formControlName","unitOfMeasureId",3,"options","filter"],["for","quantity"],["id","quantity","formControlName","quantity","showButtons","","mode","decimal"],["for","desc"],["formControlName","description","pTextarea","","id","desc","rows","5"],["class","flex flex-col flex-wrap gap-2 w-full",4,"ngIf"],["type","submit","label","Save","icon","pi pi-check",3,"loading"],[1,"flex","justify-center","gap-2","w-full"],[2,"width","40%",3,"value","responsiveOptions"],["name","files[]","accept","image/*","maxFileSize","10000000","mode","advanced",3,"onUpload","url","multiple"],[2,"width","300px","display","block",3,"src"],[2,"width","60px","display","block",3,"src"],[1,"flex","justify-between"],["label","Set as primary","text","",3,"onClick",4,"ngIf"],["value","PRIMARY","severity","success",4,"ngIf"],["icon","pi pi-trash","severity","danger","rounded","",3,"onClick"],["label","Set as primary","text","",3,"onClick"],["value","PRIMARY","severity","success"],[4,"ngIf"],[4,"ngFor","ngForOf"],["for","productImages"],["accept","image/*","maxFileSize","10000000","mode","advanced",3,"onSelect","fileLimit","showUploadButton","multiple"]],template:function(t,n){t&1&&(o(0,"p-fluid")(1,"form",5),C("ngSubmit",function(){return n.submit()}),o(2,"div",6)(3,"div",7)(4,"div",8),s(5),r(),b(6,si,13,5,"div",9),o(7,"div",10)(8,"div",11)(9,"label",12),s(10),h(11,"translate"),r(),c(12,"input",13),r(),o(13,"div",11)(14,"label",14),s(15),h(16,"translate"),r(),c(17,"input",15),r()(),o(18,"div",10)(19,"div",16)(20,"label",17),s(21),h(22,"translate"),r(),c(23,"p-multiselect",18),r(),o(24,"div",16)(25,"label",19),s(26),h(27,"translate"),r(),c(28,"p-multiselect",20),r()(),o(29,"div",10)(30,"div",11)(31,"label",21),s(32),h(33,"translate"),r(),c(34,"p-inputnumber",22),r(),o(35,"div",11)(36,"label",23),s(37),h(38,"translate"),r(),c(39,"p-inputnumber",24),r()(),o(40,"div",10)(41,"div",16)(42,"label",25),s(43),h(44,"translate"),r(),c(45,"p-multiselect",26),r(),o(46,"div",11)(47,"label",27),s(48),h(49,"translate"),r(),c(50,"p-inputnumber",28),r()(),o(51,"div",10)(52,"div",16)(53,"label",29),s(54),h(55,"translate"),r(),c(56,"textarea",30),r(),b(57,mi,7,6,"div",31),r(),o(58,"div",10),c(59,"p-button",32),r()()()()(),c(60,"p-toast")(61,"p-confirmpopup")),t&2&&(a(),p("formGroup",n.productForm),a(4),u(n.getHeader()),a(),p("ngIf",n.mode==="edit"),a(4),u(P(11,20,"PRODUCT_NAME")),a(5),u(P(16,22,"BARCODE")),a(6),u(P(22,24,"CATEGORY")),a(2),p("options",n.categoryList)("filter",!0),a(3),u(P(27,26,"BRAND")),a(2),p("options",I(38,Pt))("filter",!0),a(4),u(P(33,28,"COST")),a(5),u(P(38,30,"PRICE")),a(6),u(P(44,32,"PRODUCT_UNIT")),a(2),p("options",n.unitList)("filter",!0),a(3),u(P(49,34,"QUANTITY")),a(6),u(P(55,36,"DESCRIPTION")),a(3),p("ngIf",n.mode==="new"),a(2),p("loading",n.loading))},dependencies:[O,k,at,nt,B,L,ve,N,ae,re,oe,ne,ue,tt,j,Te,st,ct,se,le,ce,we,xe,q,Ee,_t,de,me,dt,We,Ke,mt,Fe],encapsulation:2})};var di=()=>["name","description"],ui=()=>({"min-width":"75rem"}),fi=()=>[10,20,30],gi=()=>({width:"450px"});function _i(i,e){if(i&1){let t=S();o(0,"p-button",21),C("onClick",function(){f(t);let l=d();return g(l.openNew())}),r(),o(1,"p-button",22),C("onClick",function(){f(t);let l=d();return g(l.deleteSelectedProducts())}),r()}if(i&2){let t=d();a(),p("disabled",!t.selectedCategories||!t.selectedCategories.length)}}function Ci(i,e){i&1&&c(0,"p-button",23)}function vi(i,e){if(i&1){let t=S();o(0,"div",24)(1,"h5",25),s(2,"Categories"),r(),o(3,"p-iconfield"),c(4,"p-inputicon",26),o(5,"input",27),C("input",function(l){f(t);let m=d(),_=ee(6);return g(m.onGlobalFilter(_,l))}),r()()()}}function yi(i,e){i&1&&(o(0,"tr")(1,"th",28),c(2,"p-tableHeaderCheckbox"),r(),o(3,"th"),s(4,"Image"),r(),o(5,"th",29),s(6," Name "),c(7,"p-sortIcon",30),r(),o(8,"th",31),s(9," Description "),c(10,"p-sortIcon",32),r(),c(11,"th"),r())}function hi(i,e){if(i&1){let t=S();o(0,"tr")(1,"td",28),c(2,"p-tableCheckbox",33),r(),o(3,"td"),c(4,"img",34),r(),o(5,"td",35),s(6),r(),o(7,"td",36),s(8),r(),o(9,"td")(10,"p-button",37),C("click",function(){let l=f(t).$implicit,m=d();return g(m.editCategory(l))}),r(),o(11,"p-button",38),C("click",function(){let l=f(t).$implicit,m=d();return g(m.deleteCategory(l))}),r()()()}if(i&2){let t=e.$implicit,n=d();a(2),p("value",t.productCategoryId),a(2),p("src",n.getCatImageSrc(t),R)("alt",t.name),a(2),u(t.name),a(2),u(t.description),a(2),p("rounded",!0)("outlined",!0),a(),p("rounded",!0)("outlined",!0)}}var je=class i{constructor(e,t,n){this.categoryService=e;this.toast=t;this.translate=n}categoryDialog=!1;dialogHeader="";loading=!1;saveLoading=!1;pageReq=new Ue(0,10);categoryList=[];category;selectedCategories;cols;imageFile;mode;catForm;ngOnInit(){this.initCategoryForm(),this.getCategoriesPage()}initCategoryForm(){this.catForm=new Xe({name:new $e(null,[x.required]),description:new $e(null)})}getCategoriesPage(){this.loading=!0,this.categoryService.getCategoriesPage(this.pageReq).subscribe(e=>{e.success&&(this.categoryList=e.data.content,this.loading=!1)})}openNew(){this.categoryDialog=!0,this.mode="create",this.dialogHeader="Add Category",this.catForm.reset()}onGlobalFilter(e,t){e.filterGlobal(t.target.value,"contains")}editCategory(e){this.category=e,this.mode="update",this.categoryDialog=!0,this.dialogHeader=e.name,this.catForm.patchValue({name:e.name,description:e.description})}deleteCategory(e){}deleteSelectedProducts(){}getCategoryRequest(){let e=this.catForm.value,t=new FormData;return this.imageFile&&t.append("image",this.imageFile),t.append("name",e.name),t.append("description",e.description||""),t}onSaveCategory(){if(!this.catForm.valid){this.toast.showError(this.translate.instant("REQUIRED_FIELDS_MSG"));return}this.saveLoading=!0,this.categoryService.createProductCategory(this.getCategoryRequest()).subscribe(e=>{this.saveLoading=!1,e.success&&this.toast.showSuccess("Category Created")},e=>{this.toast.showError(e.error?.message),this.saveLoading=!1}),this.categoryDialog=!1}onSelectImage(e){e.currentFiles&&(this.imageFile=e.currentFiles[0])}getCatImageSrc(e){return A.getCategoryImageSrc(e)}static \u0275fac=function(t){return new(t||i)(v(H),v(Le),v(pe))};static \u0275cmp=D({type:i,selectors:[["app-category-list"]],decls:34,vars:30,consts:[["start",""],["end",""],["dt",""],["caption",""],["header",""],["body",""],["styleClass","mb-6"],["dataKey","productCategoryId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} categories",3,"selectionChange","value","rows","columns","loading","paginator","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","rowsPerPageOptions"],[3,"visibleChange","visible","header","modal"],[3,"ngSubmit","formGroup"],[1,"flex","items-center","gap-4","mb-4"],["for","name",1,"font-semibold","w-24"],["formControlName","name","pInputText","","id","name","autocomplete","off",1,"flex-auto"],[1,"flex","items-center","gap-4","mb-8"],["for","description",1,"font-semibold","w-24"],["formControlName","description","pTextarea","","id","description","autocomplete","off",1,"flex-auto"],["for","catImage",1,"font-semibold","w-24"],["mode","basic","chooseLabel","Choose","chooseIcon","pi pi-upload","name","catImage","accept","image/*","maxFileSize","1000000",3,"onSelect"],[1,"flex","justify-end","gap-2"],["label","Cancel","severity","secondary",3,"click"],["label","Save","type","submit"],["label","New","icon","pi pi-plus","severity","secondary",1,"mr-2",3,"onClick"],["severity","secondary","label","Delete","icon","pi pi-trash","outlined","",3,"onClick","disabled"],["label","Export","icon","pi pi-upload","severity","secondary"],[1,"flex","items-center","justify-between"],[1,"m-0"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[2,"width","3rem"],["pSortableColumn","name",2,"min-width","16rem"],["field","name"],["pSortableColumn","description",2,"min-width","16rem"],["field","description"],[3,"value"],[1,"rounded","w-full",2,"width","80px","object-fit","cover",3,"src","alt"],[2,"min-width","12rem"],[2,"min-width","16rem"],["icon","pi pi-pencil",1,"mr-2",3,"click","rounded","outlined"],["icon","pi pi-trash","severity","danger",3,"click","rounded","outlined"]],template:function(t,n){if(t&1){let l=S();o(0,"p-toolbar",6),b(1,_i,2,1,"ng-template",null,0,y)(3,Ci,1,0,"ng-template",null,1,y),r(),o(5,"p-table",7,2),K("selectionChange",function(_){return f(l),W(n.selectedCategories,_)||(n.selectedCategories=_),g(_)}),b(7,vi,6,0,"ng-template",null,3,y)(9,yi,12,0,"ng-template",null,4,y)(11,hi,12,9,"ng-template",null,5,y),r(),o(13,"p-dialog",8),K("visibleChange",function(_){return f(l),W(n.categoryDialog,_)||(n.categoryDialog=_),g(_)}),o(14,"form",9),C("ngSubmit",function(){return f(l),g(n.onSaveCategory())}),o(15,"div",10)(16,"label",11),s(17),h(18,"translate"),r(),c(19,"input",12),r(),o(20,"div",13)(21,"label",14),s(22),h(23,"translate"),r(),c(24,"textarea",15),r(),o(25,"div",13)(26,"label",16),s(27),h(28,"translate"),r(),o(29,"p-fileupload",17),C("onSelect",function(_){return f(l),g(n.onSelectImage(_))}),r()(),o(30,"div",18)(31,"p-button",19),C("click",function(){return f(l),g(n.categoryDialog=!1)}),r(),c(32,"p-button",20),r()()(),c(33,"p-toast")}t&2&&(a(5),p("value",n.categoryList)("rows",10)("columns",n.cols)("loading",n.loading)("paginator",!0)("globalFilterFields",I(26,di))("tableStyle",I(27,ui)),z("selection",n.selectedCategories),p("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",I(28,fi)),a(8),Z(I(29,gi)),z("visible",n.categoryDialog),p("header",n.dialogHeader)("modal",!0),a(),p("formGroup",n.catForm),a(3),u(P(18,20,"NAME")),a(5),u(P(23,22,"DESCRIPTION")),a(5),u(P(28,24,"IMAGE")))},dependencies:[M,Ie,ye,he,be,Se,Pe,N,ae,re,oe,ne,se,le,ce,B,L,q,Ee,De,Re,O,k,j,Te,Me,gt,Ce,_e,ge,fe,Ve,de,me,we,xe],encapsulation:2})};var bi=[{path:"list",component:Be},{path:"new",component:Y},{path:"edit/:productId",component:Y},{path:"category",component:je}],Ae=class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=X({type:i});static \u0275inj=J({imports:[Ge.forChild(bi),Ge]})};var It=class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=X({type:i});static \u0275inj=J({imports:[M,Ae]})};export{It as ProductsModule};
