import{a as $t,b as Qt}from"./chunk-PCYVRXDC.js";import{a as Vt,b as Ut,c as qt}from"./chunk-5KUBI6GN.js";import{a as jt}from"./chunk-DBBLTLGT.js";import{a as Oe}from"./chunk-OZINJZ6P.js";import{a as Ft}from"./chunk-I6ODW7O6.js";import{a as me}from"./chunk-O3SRXZ6G.js";import{a as xe}from"./chunk-VGXZIDM6.js";import"./chunk-BUWKAAGZ.js";import{a as We,b as $e}from"./chunk-VE5ZA4EI.js";import{a as le}from"./chunk-6HPWOTLE.js";import{A as Z,m as ge,n as Ot,q as K,t as Ve,u as Ue,x as qe,y as je}from"./chunk-DJHBNVEJ.js";import"./chunk-2CRVAWPL.js";import"./chunk-5IQ2NTOW.js";import"./chunk-LVVCGXCS.js";import{a as Ht,b as ze,c as Wt,d as Ye,e as he}from"./chunk-LZG6A5QF.js";import{a as Ie}from"./chunk-MN5LVCU7.js";import{a as se,b as Qe}from"./chunk-AMELEMFQ.js";import{a as ne}from"./chunk-BGLM7VYL.js";import{a as j}from"./chunk-DLZLUNEY.js";import{a as A}from"./chunk-LV7F5CKA.js";import{a as Fe,c as G,d as D,e as B}from"./chunk-TGB364TN.js";import{a as te,b as ie}from"./chunk-FB455MTE.js";import"./chunk-N474PGLI.js";import{b as ee,c as He}from"./chunk-7G2FJQ27.js";import{a as kt}from"./chunk-2ZAHAWY3.js";import{c as ke}from"./chunk-E2WTBZXM.js";import{a as Y,c as fe,d as J,h as ve,i as X}from"./chunk-XBK3DIBG.js";import{e as re,g as z,h as oe,m as F}from"./chunk-RL6IEZWP.js";import{Ia as Mt,La as ue,Oa as At,Pa as Ne,Sa as Lt,Xa as P,Ya as Nt,b as Le,ob as _e,pb as M,qb as Se,rb as k,sb as L,wa as Bt}from"./chunk-AQJP2JMO.js";import{Db as r,E as It,Eb as a,Fb as v,I as ht,Jb as R,Lb as E,Mb as u,Oc as Dt,P as Ct,Pa as H,Pc as Ae,Qc as O,Sb as Tt,Tb as wt,U as ce,Ua as i,Ub as Pt,V as De,Va as g,Xb as de,Yb as o,Z as Be,Zb as m,Zc as T,_b as f,ac as W,bc as $,cc as Q,ec as S,fb as w,fc as ae,gb as Me,h as xt,ha as I,ia as h,ib as Rt,ja as bt,ka as yt,mb as x,oc as s,pc as p,qa as Et,qc as N,sc as C,ub as c,xb as y}from"./chunk-HRECHPDI.js";import"./chunk-EQDQRRRY.js";var Ge=class{customer;items;subTotal;discount;grandTotal;constructor(){this.items=[],this.subTotal=0,this.discount=0,this.grandTotal=0}empty(){this.items=[],this.subTotal=0,this.discount=0,this.grandTotal=0}},Je=class{product;quantity};var Xe=class{static playSaleEffect(){var t=new Audio("assets/sounds/sale-pulse.mp3");t.play()}};var Ke=class{saleId;customerId;saleItems;subTotal;grandTotal;discount},Ze=class{saleItemId;saleId;productId;quantity};var Ce=class n{addProductSubject=new xt;addItem(t,e){this.getItem(t,e)?this.increaseQty(t,e):this.addNewItem(t,e),Xe.playSaleEffect()}addNewItem(t,e){let l=new Je;l.product=t,l.quantity=1,t.basicDetails.quantity>0&&(e.items?.push(l),this.updateAmout(e))}increaseQty(t,e){let l=this.getItem(t,e);l&&l.quantity&&l.quantity<t.basicDetails.quantity&&(l.quantity++,this.updateAmout(e))}decreaseQty(t,e){let l=this.getItem(t,e);l&&l.quantity&&l.quantity>1&&(l.quantity--,this.updateAmout(e))}itemExists(t,e){if(e&&e.items){for(let l of e.items)if(l.product?.productId==t?.productId)return!0;return!1}return!1}removeItem(t,e){if(e&&e.items)for(let l=0;l<e.items.length;l++)e.items[l].product?.productId==t?.productId&&(e.items.splice(l,1),this.updateAmout(e))}getItem(t,e){if(e&&e.items){for(let l of e.items)if(l.product?.productId==t?.productId)return l;return null}return null}updateAmout(t){if(t&&t.items){t.subTotal=0,t.grandTotal=0;for(let e of t.items){let l=this.getItemTotal(e)||0;t.subTotal+=l}t.grandTotal=t.subTotal-t.discount}}updateDiscount(t){t.grandTotal=t.subTotal-t.discount}getItemTotal(t){return t&&t.product&&t.quantity?t.product.priceDetails.priceWithDiscount*t.quantity:null}cartToSaleRequest(t){if(t.items){let e=new Ke;return e.customerId=t.customer?.customerId,e.subTotal=t.subTotal,e.grandTotal=t.grandTotal,e.discount=t.discount,e.saleItems=this.cartItemsToSaleItems(t.items),e}return{}}cartItemsToSaleItems(t){let e=[];for(let l of t){let d=new Ze;d.productId=l.product?.productId,d.quantity=l.quantity,e.push(d)}return e}static \u0275fac=function(e){return new(e||n)};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})};var U=class n{constructor(t){this.http=t}basUrl=Fe.apiBaseUrl+"/sale";createSale(t){return this.http.post(this.basUrl,t)}getSalesPage(t){return this.http.get(`${this.basUrl}?page=${t.page}&size=${t.size}`)}getSaleById(t){return this.http.get(`${this.basUrl}/${t}`)}getSaleReceipt(t){return this.http.get(`${this.basUrl}/receipt/${t}`,{responseType:"blob"})}deleteSale(t){return this.http.delete(`${this.basUrl}/${t}`)}previewSaleReceipt(t){this.getSaleReceipt(t.saleId).subscribe(e=>{let l=new Blob([e],{type:"application/pdf"}),d=URL.createObjectURL(l),_=window.open(d,"_blank");_&&(_.onload=()=>{_.print()})})}static \u0275fac=function(e){return new(e||n)(Be(Le))};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})};var oi=()=>({minWidth:"40rem",overflow:"hidden"}),Gt=()=>({width:"100%"}),li=()=>({width:"100%",border:"1px dashed"}),si=()=>({width:"3rem"});function pi(n,t){if(n&1&&(r(0,"div",23),v(1,"p-avatar",24),r(2,"div"),o(3),a(),r(4,"span",25),o(5),a()()),n&2){let e=t.$implicit;i(),c("label",e.fullName.toUpperCase()[0]),i(2),m(e.phone),i(2),f(" ",e.fullName," ")}}function mi(n,t){if(n&1){let e=R();r(0,"p-button",26),s(1,"translate"),E("onClick",function(){I(e);let d=u();return h(d.cart.empty())}),a()}n&2&&c("label",p(1,2,"EMPTY_CART"))("text",!0)}function ci(n,t){n&1&&(r(0,"div",27),o(1),s(2,"translate"),a()),n&2&&(i(),f(" ",p(2,1,"CART_EMPTY")," "))}function di(n,t){if(n&1){let e=R();r(0,"span",38),E("click",function(){I(e);let d=u().$implicit,_=u();return h(_.increaseQty(d))}),v(1,"span",39),a()}}function ui(n,t){if(n&1){let e=R();r(0,"span",38),E("click",function(){I(e);let d=u().$implicit,_=u();return h(_.decreaseQty(d))}),v(1,"span",40),a()}}function fi(n,t){if(n&1){let e=R();r(0,"div",28),v(1,"img",29),r(2,"div",30)(3,"div",31)(4,"div",32),o(5),a(),r(6,"span",33),o(7),s(8,"sCurrency"),a()(),r(9,"div",34)(10,"p-inputnumber",35),Q("ngModelChange",function(d){let _=I(e).$implicit;return $(_.quantity,d)||(_.quantity=d),h(d)}),x(11,di,2,0,"ng-template",null,2,C)(13,ui,2,0,"ng-template",null,3,C),a()(),r(15,"div",36),o(16),s(17,"sCurrency"),a()(),r(18,"p-button",37),E("onClick",function(){let d=I(e).$implicit,_=u();return h(_.removeItem(d))}),a()()}if(n&2){let e=t.$implicit,l=u();i(),c("src",l.getProductImageSrc(e.product),H)("alt",e.product.basicDetails.productName),i(3),c("pTooltip",e.product==null||e.product.basicDetails==null?null:e.product.basicDetails.productName),i(),f(" ",e.product==null||e.product.basicDetails==null?null:e.product.basicDetails.productName," "),i(2),m(p(8,12,e.product==null||e.product.priceDetails==null?null:e.product.priceDetails.priceWithDiscount)),i(3),W("ngModel",e.quantity),c("max",(e.product==null||e.product.basicDetails==null?null:e.product.basicDetails.quantity)||99)("showButtons",!0)("inputStyle",S(16,si)),i(6),m(p(17,14,l.cartService.getItemTotal(e))),i(2),c("rounded",!0)("text",!0)}}function vi(n,t){if(n&1){let e=R();r(0,"div",41)(1,"p-button",42),s(2,"translate"),E("onClick",function(){I(e);let d=u();return h(d.submitOrder())}),a()()}if(n&2){let e=u();i(),y(S(7,Gt)),c("loading",e.orderLoading)("label",p(2,5,"SUBMIT_ORDER"))("disabled",!e.cart.items||!e.cart.items.length)}}function _i(n,t){if(n&1){let e=R();r(0,"app-customer-create-dialog",43),E("visibleChange",function(d){I(e);let _=u();return h(_.toggleDialog(d))}),a()}}function Si(n,t){if(n&1&&(r(0,"div",44),v(1,"i",45),r(2,"p"),o(3),a()()),n&2){let e=t.$implicit;i(),c("ngClass",e.icon),i(2),m(e.message)}}var et=class n{constructor(t,e,l,d,_){this.cartService=t;this.customerService=e;this.saleService=l;this.toast=d;this.translate=_}cart;customers=[];orderLoading=!1;customerDialog=!1;success=new Et;ngOnInit(){this.cart=new Ge,this.cartService.addProductSubject.subscribe(t=>{this.cartService.addItem(t,this.cart)})}searchCustomers(t){this.customerService.filterCustomersByPhone(t.query).subscribe(e=>this.customers=e.data)}getProductImageSrc(t){return j.getFirstImageSrc(t)}increaseQty(t){this.cartService.increaseQty(t.product,this.cart)}decreaseQty(t){this.cartService.decreaseQty(t.product,this.cart)}removeItem(t){this.cartService.removeItem(t.product,this.cart)}submitOrder(){this.orderLoading=!0,this.saleService.createSale(this.cartService.cartToSaleRequest(this.cart)).subscribe(t=>{t.success&&(this.toast.showSuccess(this.translate.instant("ORDER_SAVED")),this.orderLoading=!1,this.cart.empty(),this.success.emit(!0),this.saleService.previewSaleReceipt(t.data))},t=>{this.toast.showError(t.error.message),this.orderLoading=!1})}updateDiscount(){this.cartService.updateDiscount(this.cart)}toggleDialog(t){this.customerDialog=t}static \u0275fac=function(e){return new(e||n)(g(Ce),g($t),g(U),g(ne),g(G))};static \u0275cmp=w({type:n,selectors:[["app-pos-sale-details"]],outputs:{success:"success"},decls:47,vars:42,consts:[["footer",""],["message",""],["incrementbuttonicon",""],["decrementbuttonicon",""],[1,"search-customers","mb-8"],[1,"flex","flex-col","gap-2","mb-4"],[1,"text-lg"],["optionLabel","phone",3,"ngModelChange","completeMethod","dropdown","ngModel","suggestions"],["pTemplate","item"],["icon","pi pi-plus","outlined","true",3,"onClick","label"],[1,"order-details"],[1,"mb-4","text-lg","flex","justify-between"],["severity","danger","icon","pi pi-shopping-cart","class","mr-2",3,"label","text","onClick",4,"ngIf"],["class","no-items text-center text-surface-600",4,"ngIf"],[1,"order-items","overflow-auto","flex","flex-col","gap-2","mb-6",2,"max-height","20rem"],["class","order-item flex gap-4 items-center justify-between",4,"ngFor","ngForOf"],[1,"total"],[1,"flex","justify-between"],[1,"mb-4","text-surface-400"],["id","discount","mode","currency","currency","USD","showButtons","",3,"onInput","ngModelChange","disabled","ngModel"],[1,"border-dashed"],[1,"mb-4","font-bold","text-lg"],[3,"visibleChange",4,"ngIf"],[1,"flex","gap-2","items-center"],["shape","circle",3,"label"],[1,"font-sm"],["severity","danger","icon","pi pi-shopping-cart",1,"mr-2",3,"onClick","label","text"],[1,"no-items","text-center","text-surface-600"],[1,"order-item","flex","gap-4","items-center","justify-between"],[1,"rounded","w-full",2,"width","4rem","height","4rem","object-fit","cover",3,"src","alt"],[1,"flex","items-center","justify-between","w-full"],[1,"flex","flex-col"],["tooltipPosition","top",1,"mb-2","text-max-lines-1",2,"width","12rem",3,"pTooltip"],[1,"text-primary"],[1,"item-actions","ml-1","mr-1"],["readonly","true","min","1","buttonLayout","horizontal","spinnerMode","horizontal",3,"ngModelChange","ngModel","max","showButtons","inputStyle"],[1,"w-3rem","text-primary",2,"min-width","3rem"],["icon","pi pi-times","severity","danger",3,"onClick","rounded","text"],[1,"w-full","h-full","flex","items-center","justify-center",3,"click"],[1,"pi","pi-plus"],[1,"pi","pi-minus"],[1,"payment","text-lg"],[3,"onClick","loading","label","disabled"],[3,"visibleChange"],[1,"flex","flex-col","items-center","w-full","gap-4","border-b","border-surface-200","dark:border-surface-700"],[1,"!text-6xl","text-primary-500",3,"ngClass"]],template:function(e,l){if(e&1){let d=R();r(0,"p-card")(1,"div",4)(2,"div",5)(3,"div",6),o(4),s(5,"translate"),a(),r(6,"p-autocomplete",7),Q("ngModelChange",function(b){return I(d),$(l.cart.customer,b)||(l.cart.customer=b),h(b)}),E("completeMethod",function(b){return I(d),h(l.searchCustomers(b))}),x(7,pi,6,3,"ng-template",8),a()(),r(8,"p-button",9),s(9,"translate"),E("onClick",function(){return I(d),h(l.customerDialog=!0)}),a()(),r(10,"div",10)(11,"div",11)(12,"span"),o(13),s(14,"translate"),a(),x(15,mi,2,4,"p-button",12),a(),x(16,ci,3,3,"div",13),r(17,"div",14),x(18,fi,19,17,"div",15),a(),r(19,"div",16)(20,"div",17)(21,"div",18),o(22),s(23,"translate"),a(),r(24,"span"),o(25),s(26,"sCurrency"),a()(),r(27,"div",17)(28,"div",18),o(29),s(30,"translate"),a(),r(31,"p-inputnumber",19),E("onInput",function(){return I(d),h(l.updateDiscount())}),Q("ngModelChange",function(b){return I(d),$(l.cart.discount,b)||(l.cart.discount=b),h(b)}),a()(),v(32,"hr",20),r(33,"div",17)(34,"div",21),o(35),s(36,"translate"),a(),r(37,"span",6),o(38),s(39,"sCurrency"),a()()()(),x(40,vi,3,8,"ng-template",null,0,C),a(),v(42,"p-toast"),x(43,_i,1,0,"app-customer-create-dialog",22),r(44,"p-confirmdialog"),x(45,Si,4,2,"ng-template",null,1,C),a()}e&2&&(y(S(39,oi)),i(4),m(p(5,23,"CUSTOMER_DETAILS")),i(2),y(S(40,Gt)),c("dropdown",!0),W("ngModel",l.cart.customer),c("suggestions",l.customers),i(2),y(S(41,li)),c("label",p(9,25,"ADD_CUSTOMER")),i(5),m(p(14,27,"ORDER_DETAILS")),i(2),c("ngIf",l.cart.items==null?null:l.cart.items.length),i(),c("ngIf",!l.cart.items||!l.cart.items.length),i(2),c("ngForOf",l.cart.items),i(4),f(" ",p(23,29,"SUB_TOTAL")," "),i(3),m(p(26,31,l.cart.subTotal)),i(4),f(" ",p(30,33,"DISCOUNT")," "),i(2),c("disabled",!l.cart.items.length),W("ngModel",l.cart.discount),i(4),f(" ",p(36,35,"TOTAL_AMOUNT")," "),i(3),m(p(39,37,l.cart.grandTotal)),i(5),c("ngIf",l.customerDialog))},dependencies:[L,k,Bt,T,Dt,Ae,O,P,ue,Ne,X,J,M,ie,te,Ut,Vt,jt,ke,ee,Qt,Y,A,B,D,se],styles:[".scrolling-text-wrapper[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap}.scrolling-text[_ngcontent-%COMP%]{display:inline-block;font-weight:700;animation:_ngcontent-%COMP%_scroll-text 5s linear infinite}@keyframes _ngcontent-%COMP%_scroll-text{0%{transform:translate(100%)}to{transform:translate(-100%)}}"]})};var gi=()=>["code_128","ean","upc"],xi=n=>["/products/detail",n];function Ii(n,t){if(n&1){let e=R();r(0,"div",7)(1,"p-iconfield"),v(2,"p-inputicon",8)(3,"input",9),s(4,"translate"),a(),r(5,"p-paginator",10),E("onPageChange",function(d){I(e);let _=u();return h(_.onPageChange(d))}),a()()}if(n&2){let e=u();i(3),c("formControl",e.globalSearchControl)("placeholder",p(4,8,"SEARCH_PACEHOLDER")),i(2),c("first",e.pageReq.page*e.pageReq.size)("rows",e.pageReq.size)("totalRecords",(e.pageDetails==null?null:e.pageDetails.totalElements)||0)("showCurrentPageReport",!0)("showPageLinks",!1)("showJumpToPageDropdown",!1)}}function hi(n,t){n&1&&(r(0,"div",13),v(1,"p-skeleton",14)(2,"p-skeleton",14)(3,"p-skeleton",14)(4,"p-skeleton",14),a())}function Ci(n,t){if(n&1&&(r(0,"div",30)(1,"span",31),o(2),s(3,"sCurrency"),a()()),n&2){let e=u().$implicit;i(2),f(" ",p(3,1,e.priceDetails.priceWithDiscount)," ")}}function bi(n,t){if(n&1&&(r(0,"div",30)(1,"span",32),o(2),s(3,"sCurrency"),a(),r(4,"span",31),o(5),s(6,"sCurrency"),a()()),n&2){let e=u().$implicit;i(2),f(" ",p(3,2,e.priceDetails.sellingPrice)," "),i(3),f(" ",p(6,4,e.priceDetails.priceWithDiscount)," ")}}function yi(n,t){if(n&1){let e=R();r(0,"div",17)(1,"div",18)(2,"div",19)(3,"div",20),v(4,"img",21)(5,"p-tag",22),a()(),r(6,"div",23)(7,"div")(8,"div",24),o(9),a(),r(10,"div",25),o(11),a()(),r(12,"div",26),x(13,Ci,4,3,"div",27)(14,bi,7,6,"div",27),r(15,"div",28)(16,"button",29),s(17,"translate"),E("click",function(){let d=I(e).$implicit,_=u(3);return h(_.addProductToCart(d))}),a()()()()()()}if(n&2){let e=t.$implicit,l=u(3);i(4),c("src",l.getProductImageSrc(e),H)("alt",e.basicDetails==null?null:e.basicDetails.productName),i(),c("value","QTY: "+e.basicDetails.quantity)("severity",l.getQuantitySeverity(e)),i(4),f(" ",e.basicDetails==null||e.basicDetails.productCategory==null?null:e.basicDetails.productCategory.name," "),i(),c("routerLink",ae(13,xi,e.productId))("pTooltip",e.basicDetails==null?null:e.basicDetails.productName),i(),f(" ",e.basicDetails.productName," "),i(2),c("ngIf",e.priceDetails.sellingPrice==e.priceDetails.priceWithDiscount),i(),c("ngIf",e.priceDetails.sellingPrice!=e.priceDetails.priceWithDiscount),i(2),c("label",p(17,11,"ADD_TO_CART"))}}function Ei(n,t){if(n&1&&(r(0,"div",15),x(1,yi,18,15,"div",16),a()),n&2){let e=u().$implicit;i(),c("ngForOf",e)}}function Ri(n,t){if(n&1&&x(0,hi,5,0,"div",11)(1,Ei,2,1,"div",12),n&2){let e=u();c("ngIf",e.loading),i(),c("ngIf",!e.loading)}}var nt=class n{constructor(t,e,l,d,_){this.productService=t;this.cartService=e;this.lasyoutService=l;this.translate=d;this.toast=_}globalSearchControl=new At("");pageReq=new me(0,8);pageDetails;products=[];loading=!1;searching=!1;barcodeScanner;ngOnInit(){this.subscribeForGlobalSearch(),this.getProducts(),this.hideSideBar()}hideSideBar(){this.lasyoutService.isSidebarActive()||this.lasyoutService.onMenuToggle()}ngAfterViewInit(){}onValueChanges(t){if(this.searching)return;this.searching=!0;let e=t.codeResult.code.trim();this.productService.getProductByBarcode(e).subscribe(l=>{l.success?this.cartService.addProductSubject.next(l.data):(this.toast.showError(this.translate.instant("PRODUCT_NOT_FOUND")),this.searching=!1)})}subscribeForGlobalSearch(){this.pageReq=new me(0,8),this.loading=!0,this.globalSearchControl.valueChanges.pipe(It(300),Ct(t=>this.productService.searchByKeyword(t||"",this.pageReq).pipe(ht(()=>this.loading=!1)))).subscribe(t=>{t.success&&(this.products=t.data.content,this.pageDetails=t.data.page),this.loading=!1})}getProducts(){this.loading=!0,this.productService.getProductsPage(this.pageReq).subscribe(t=>{t.success&&(this.products=t.data.content,this.pageDetails=t.data.page),this.loading=!1})}getQuantitySeverity(t){return j.getQuantitySeverity(t)}getProductImageSrc(t){return j.getFirstImageSrc(t)}addProductToCart(t){this.cartService.addProductSubject.next(t)}onPageChange(t){this.pageReq.page=t.page,this.pageReq.size=t.rows,this.getProducts()}orderSuccess(t){this.getProducts()}static \u0275fac=function(e){return new(e||n)(g(Ht),g(Ce),g(Ft),g(G),g(ne))};static \u0275cmp=w({type:n,selectors:[["app-pos"]],viewQuery:function(e,l){if(e&1&&Tt(ze,5),e&2){let d;wt(d=Pt())&&(l.barcodeScanner=d.first)}},decls:11,vars:3,consts:[["dv",""],["header",""],["grid",""],[1,"flex","gap-2","h-full","w-full"],[3,"success"],["layout","grid",3,"value"],[3,"valueChanges","type"],[1,"flex","items-center","justify-between"],["styleClass","pi pi-barcode"],["pInputText","","type","text",1,"w-80",3,"formControl","placeholder"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords}",3,"onPageChange","first","rows","totalRecords","showCurrentPageReport","showPageLinks","showJumpToPageDropdown"],["class","loading flex flex-wrap gap-2 mb-4 mt-4",4,"ngIf"],["class","grid grid-cols-12 gap-4",4,"ngIf"],[1,"loading","flex","flex-wrap","gap-2","mb-4","mt-4"],["size","10rem"],[1,"grid","grid-cols-12","gap-4"],["class","col-span-6 sm:col-span-3 md:col-span-3 xl:col-span-3 p-2",4,"ngFor","ngForOf"],[1,"col-span-6","sm:col-span-3","md:col-span-3","xl:col-span-3","p-2"],[1,"p-3","border","border-surface-200","dark:border-surface-700","bg-surface-0","dark:bg-surface-900","rounded","flex","flex-col"],[1,"bg-surface-50","flex","justify-center","rounded","p-1"],[1,"relative","mx-auto"],[1,"rounded","w-full",2,"width","20rem","height","8rem","object-fit","cover",3,"src","alt"],["styleClass","dark:!bg-surface-900",1,"absolute","absolute","top-0","left-0",3,"value","severity"],[1,"pt-4"],[1,"text-right","text-red-300"],["tooltipPosition","top",1,"mt-1","cursor-pointer","text-overflow-ellipsis","overflow-hidden","text-max-lines-2",3,"routerLink","pTooltip"],[1,"flex","flex-col","gap-6","mt-6"],["class","flex gap-3",4,"ngIf"],[1,"flex","gap-2"],["pButton","","icon","pi pi-shopping-cart","variant","text","severity","secondary",1,"flex-auto",3,"click","label"],[1,"flex","gap-3"],[1,"font-semibold","text-primary"],[1,"text-sm","text-surface-400","line-through"]],template:function(e,l){if(e&1){let d=R();r(0,"div",3)(1,"app-pos-sale-details",4),E("success",function(b){return I(d),h(l.orderSuccess(b))}),a(),r(2,"p-card")(3,"p-dataview",5,0),x(5,Ii,6,10,"ng-template",null,1,C)(7,Ri,2,2,"ng-template",null,2,C),a()()(),r(9,"barcode-scanner-livestream",6),E("valueChanges",function(b){return I(d),h(l.onValueChanges(b))}),a(),v(10,"p-toast")}e&2&&(i(3),c("value",l.products),i(6),c("type",S(2,gi)))},dependencies:[qt,kt,L,Se,T,Ae,O,P,Mt,ue,Nt,Lt,X,ve,J,fe,M,_e,ie,te,et,Wt,ze,Ot,ge,Y,A,le,ee,F,oe,B,D],encapsulation:2})};var q=class n{transform(t,e="medium"){let d=this.getLang()==="ar"?["ar","ar-u-nu-latn"]:["en"],_={};switch(e){case"short":_={year:"numeric",month:"short",day:"numeric"};break;case"medium":_={year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0};break;case"long":_={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0};break}return new Intl.DateTimeFormat(d,_).format(new Date(t))}getLang(){let t=sessionStorage.getItem("app.state");if(t)return JSON.parse(t).defaultLanguage||"en"}static \u0275fac=function(e){return new(e||n)};static \u0275pipe=Rt({name:"dateFt",type:n,pure:!0})};var Di=()=>["barcode","customer.fullName","createdBy"],Bi=()=>({"min-width":"75rem"}),Mi=()=>[10,20,30],Ai=()=>({width:"450px"}),Li=n=>["/sales/detail",n],Ni=()=>["/sales/sale-return/list"],Fi=n=>({saleId:n});function Oi(n,t){if(n&1){let e=R();r(0,"div",10),v(1,"p-button",11),s(2,"translate"),r(3,"p-button",12),s(4,"translate"),E("onClick",function(){I(e);let d=u();return h(d.deleteSelectedSales())}),a()()}if(n&2){let e=u();i(),c("label",p(2,3,"ADD")),i(2),c("label",p(4,5,"DELETE"))("disabled",!e.selectedSales||!e.selectedSales.length)}}function ki(n,t){n&1&&(v(0,"p-button",13),s(1,"translate")),n&2&&c("label",p(1,1,"EXPORT"))}function Vi(n,t){if(n&1){let e=R();r(0,"div",14)(1,"h5",15),o(2),s(3,"translate"),a(),r(4,"p-iconfield"),v(5,"p-inputicon",16),r(6,"input",17),s(7,"translate"),E("input",function(d){I(e);let _=u(),b=de(6);return h(_.onGlobalFilter(b,d))}),a()()()}n&2&&(i(2),m(p(3,2,"SALE_HISTORY")),i(4),c("placeholder",p(7,4,"SEARCH_PACEHOLDER")))}function Ui(n,t){n&1&&(r(0,"tr")(1,"th",18),v(2,"p-tableHeaderCheckbox"),a(),r(3,"th"),o(4),s(5,"translate"),a(),r(6,"th",19),o(7),s(8,"translate"),v(9,"p-sortIcon",20),a(),r(10,"th",21),o(11),s(12,"translate"),v(13,"p-sortIcon",22),a(),r(14,"th",23),o(15),s(16,"translate"),v(17,"p-sortIcon",24),a(),r(18,"th"),o(19),s(20,"translate"),a(),r(21,"th",25),o(22),s(23,"translate"),v(24,"p-sortIcon",26),a(),r(25,"th"),o(26),s(27,"translate"),a()()),n&2&&(i(4),f(" ",p(5,7,"BARCODE")," "),i(3),f(" ",p(8,9,"DATE")," "),i(4),f(" ",p(12,11,"CUSTOMER")," "),i(4),f(" ",p(16,13,"GRAND_TOTAL")," "),i(4),f(" ",p(20,15,"SALE_RETURN_STATUS")," "),i(3),f(" ",p(23,17,"SOLD_BY")," "),i(4),m(p(27,19,"OPTIONS")))}function qi(n,t){n&1&&(r(0,"div",35),o(1),s(2,"translate"),a()),n&2&&(i(),f(" ",p(2,1,"NOT_REGISTERED_CUSTOMER")," "))}function ji(n,t){n&1&&(r(0,"div",36),v(1,"i",37),r(2,"div",38),o(3),s(4,"translate"),a()()),n&2&&(i(3),m(p(4,1,"SALE_TOTALLY_RETURNED")))}function Hi(n,t){n&1&&(r(0,"div",36),v(1,"i",37),r(2,"div",39),o(3),s(4,"translate"),a()()),n&2&&(i(3),m(p(4,1,"SALE_PARTIALLY_RETURNED")))}function Wi(n,t){n&1&&(r(0,"div",40)(1,"div",41),o(2),s(3,"translate"),a()()),n&2&&(i(2),m(p(3,1,"SALE_HAS_NO_RETURNS")))}function $i(n,t){if(n&1&&(r(0,"a",42),o(1),s(2,"translate"),a()),n&2){let e=u().$implicit;c("routerLink",S(5,Ni))("queryParams",ae(6,Fi,e.saleId)),i(),m(p(2,3,"SHOW_SALE_RETURNS"))}}function Qi(n,t){if(n&1){let e=R();r(0,"tr")(1,"td"),v(2,"p-tableCheckbox",27),a(),r(3,"td")(4,"a",28),o(5),a()(),r(6,"td"),o(7),s(8,"dateFt"),a(),r(9,"td"),o(10),x(11,qi,3,3,"div",29),a(),r(12,"td"),o(13),s(14,"sCurrency"),a(),r(15,"td"),x(16,ji,5,3,"div",30)(17,Hi,5,3,"div",30)(18,Wi,4,3,"div",31)(19,$i,3,8,"a",32),a(),r(20,"td"),o(21),a(),r(22,"td"),v(23,"p-menu",33,6),r(25,"button",34),E("click",function(d){let _=I(e).$implicit,b=de(24);return u().getMenuItems(_),h(b.toggle(d))}),a()()()}if(n&2){let e=t.$implicit,l=u();i(2),c("value",e),i(2),c("routerLink",ae(19,Li,e.saleId)),i(),m(e.barcode),i(2),f(" ",N(8,14,e.createdAt,"long")," "),i(3),f(" ",e.customer==null?null:e.customer.fullName," "),i(),c("ngIf",!e.customer),i(2),f(" ",p(14,17,e.grandTotal)," "),i(3),c("ngIf",e.totallyReturned),i(),c("ngIf",e.partiallyReturned),i(),c("ngIf",!e.partiallyReturned&&!e.totallyReturned),i(),c("ngIf",e.totallyReturned||e.partiallyReturned),i(2),f(" ",e.createdBy," "),i(2),c("popup",!0)("model",l.menuItems)}}var at=class n{constructor(t,e,l,d,_){this.saleService=t;this.translate=e;this.toast=l;this.confirmService=d;this.router=_}loading=!1;pageReq=new me(0,10);pageDetails;salesList=[];sale;selectedSales;cols;mode;menuItems=[];ngOnInit(){this.getSalesPage()}getSalesPage(){this.loading=!0,this.saleService.getSalesPage(this.pageReq).subscribe(t=>{t.success&&(this.salesList=t.data.content,this.pageDetails=t.data.page,this.loading=!1)})}onPageChange(t){this.pageReq.page=t.page,this.pageReq.size=t.rows,this.getSalesPage()}onGlobalFilter(t,e){t.filterGlobal(e.target.value,"contains")}getMenuItems(t){this.menuItems=[{label:this.translate.instant("SHOW_DETAILS"),icon:"pi pi-eye",command:()=>{this.saleDetails(t)}},{label:this.translate.instant("PRINT_RECEIPT"),icon:"pi pi-print",command:()=>{this.saleService.previewSaleReceipt(t)}},{label:this.translate.instant("RETURN_SALE"),icon:"pi pi-arrow-right-arrow-left",disabled:t.totallyReturned,command:()=>{this.saleReturn(t)}},{label:this.translate.instant("DELETE"),icon:"pi pi-trash",command:()=>{this.deleteSale(t)}}]}deleteSale(t){let e=this.translate.instant("DELETE_ALERT",{name:t.barcode});this.confirmService.dialogAlert(e,()=>{this.saleService.deleteSale(t.saleId).subscribe(l=>{l.success?(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.getSalesPage()):this.toast.showError(l.message)})})}deleteSelectedSales(){}downloadReceipt(t){this.saleService.previewSaleReceipt(t)}saleDetails(t){this.router.navigate(["sales/detail",t.saleId])}saleReturn(t){this.router.navigate(["sales/sale-return/create",t.saleId])}static \u0275fac=function(e){return new(e||n)(g(U),g(G),g(ne),g(Ie),g(z))};static \u0275cmp=w({type:n,selectors:[["app-sales-list"]],decls:16,vars:20,consts:[["start",""],["end",""],["dt",""],["caption",""],["header",""],["body",""],["menu",""],["styleClass","mb-6"],["dataKey","saleId",3,"selectionChange","value","rows","columns","loading","globalFilterFields","tableStyle","selection","rowHover"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords}",3,"onPageChange","first","rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","showJumpToPageDropdown"],[1,"flex","items-center","gap-2"],["icon","pi pi-plus","severity","secondary",1,"mr-2",3,"label"],["severity","secondary","icon","pi pi-trash","outlined","",3,"onClick","label","disabled"],["icon","pi pi-upload","severity","secondary",3,"label"],[1,"flex","items-center","justify-between"],[1,"m-0"],["styleClass","pi pi-search"],["pInputText","","type","text",3,"input","placeholder"],[2,"width","3rem"],["pSortableColumn","createdAt"],["field","createdAt"],["pSortableColumn","customer"],["field","customer"],["pSortableColumn","grandTotal"],["field","grandTotal"],["pSortableColumn","createdBy"],["field","createdBy"],[3,"value"],[1,"text-primary",3,"routerLink"],["class","text-muted-color",4,"ngIf"],["class","flex gap-2 mb-2",4,"ngIf"],["class","flex gap-2",4,"ngIf"],["class","text-muted-color dark:text-surface-400 hover:underline",3,"routerLink","queryParams",4,"ngIf"],["appendTo","body",3,"popup","model"],["pButton","","icon","pi pi-ellipsis-v",1,"p-button-text",3,"click"],[1,"text-muted-color"],[1,"flex","gap-2","mb-2"],[1,"pi","pi-arrow-right-arrow-left","text-muted-color"],[1,"text-red-500"],[1,"text-orange-500"],[1,"flex","gap-2"],[1,"text-blue-500","dark:text-blue-300"],[1,"text-muted-color","dark:text-surface-400","hover:underline",3,"routerLink","queryParams"]],template:function(e,l){if(e&1){let d=R();r(0,"p-toolbar",7),x(1,Oi,5,7,"ng-template",null,0,C)(3,ki,2,3,"ng-template",null,1,C),a(),r(5,"p-table",8,2),Q("selectionChange",function(b){return I(d),$(l.selectedSales,b)||(l.selectedSales=b),h(b)}),x(7,Vi,8,6,"ng-template",null,3,C)(9,Ui,28,21,"ng-template",null,4,C)(11,Qi,26,21,"ng-template",null,5,C),a(),r(13,"p-paginator",9),E("onPageChange",function(b){return I(d),h(l.onPageChange(b))}),a(),v(14,"p-confirmdialog")(15,"p-toast")}e&2&&(i(5),c("value",l.salesList)("rows",10)("columns",l.cols)("loading",l.loading)("globalFilterFields",S(16,Di))("tableStyle",S(17,Bi)),W("selection",l.selectedSales),c("rowHover",!0),i(8),c("first",l.pageReq.page*l.pageReq.size)("rows",l.pageReq.size)("totalRecords",(l.pageDetails==null?null:l.pageDetails.totalElements)||0)("rowsPerPageOptions",S(18,Mi))("showCurrentPageReport",!0)("showJumpToPageDropdown",!1),i(),y(S(19,Ai)))},dependencies:[T,O,Z,K,Ve,Ue,qe,je,P,L,Se,k,He,ee,M,_e,$e,We,Qe,se,B,D,fe,ve,Oe,ge,A,F,oe,q],encapsulation:2})};var Kt=()=>({"min-width":"50rem"}),Yi=()=>[1],Gi=()=>["/sales/sale-return/list"],Ji=n=>({saleId:n}),Xi=()=>({width:"30%"}),Ki=()=>({width:"20%"}),Zt=()=>({width:"25%"}),ft=()=>({width:"50%"});function Zi(n,t){n&1&&(r(0,"div",4),v(1,"p-skeleton",5)(2,"p-skeleton",6)(3,"p-skeleton",7)(4,"p-skeleton",8)(5,"p-skeleton",9),a())}function en(n,t){n&1&&(r(0,"div",29),v(1,"i",30),r(2,"div",31),o(3),s(4,"translate"),a()()),n&2&&(i(3),m(p(4,1,"SALE_TOTALLY_RETURNED")))}function tn(n,t){n&1&&(r(0,"div",29),v(1,"i",30),r(2,"div",32),o(3),s(4,"translate"),a()()),n&2&&(i(3),m(p(4,1,"SALE_PARTIALLY_RETURNED")))}function nn(n,t){n&1&&(r(0,"div",33)(1,"div",34),o(2),s(3,"translate"),a()()),n&2&&(i(2),m(p(3,1,"SALE_HAS_NO_RETURNS")))}function an(n,t){if(n&1&&(r(0,"a",35),o(1),s(2,"translate"),a()),n&2){let e=u(2);c("routerLink",S(5,Gi))("queryParams",ae(6,Ji,e.sale.saleId)),i(),m(p(2,3,"SHOW_SALE_RETURNS"))}}function rn(n,t){n&1&&(r(0,"div",36)(1,"span"),o(2),s(3,"translate"),a(),o(4),s(5,"translate"),a()),n&2&&(i(2),m(p(3,2,"NAME")),i(2),f(": ",p(5,4,"NOT_REGISTERED_CUSTOMER")," "))}function on(n,t){if(n&1&&(r(0,"div",36)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"NAME")),i(2),f(": ",e.sale.customer.fullName," ")}}function ln(n,t){if(n&1&&(r(0,"div",36)(1,"span"),o(2),s(3,"translate"),a(),o(4,": "),r(5,"span",13),o(6),a()()),n&2){let e=u(2);i(2),m(p(3,2,"PHONE")),i(4),m(e.sale.customer.phone)}}function sn(n,t){if(n&1&&(r(0,"div",36)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"COUNTRY")),i(2),f(": ",e.sale.customer.country," ")}}function pn(n,t){if(n&1&&(r(0,"div",36)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"ADDRESS")),i(2),f(": ",e.sale.customer.address," ")}}function mn(n,t){if(n&1&&(r(0,"div",36)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"EMAIL")),i(2),f(": ",e.sale.customer.email," ")}}function cn(n,t){n&1&&(r(0,"tr")(1,"th"),o(2),s(3,"translate"),a(),r(4,"th"),o(5),s(6,"translate"),a(),r(7,"th"),o(8),s(9,"translate"),a(),r(10,"th"),o(11),s(12,"translate"),a()()),n&2&&(i(),y(S(20,Xi)),i(),m(p(3,12,"PRODUCT")),i(2),y(S(21,Ki)),i(),m(p(6,14,"UNIT_PRICE")),i(2),y(S(22,Zt)),i(),m(p(9,16,"QUANTITY")),i(2),y(S(23,Zt)),i(),m(p(12,18,"SUB_TOTAL")))}function dn(n,t){if(n&1&&(r(0,"tr")(1,"td",37),v(2,"img",38),r(3,"span"),o(4),s(5,"substring"),a()(),r(6,"td"),o(7),s(8,"sCurrency"),a(),r(9,"td"),o(10),a(),r(11,"td"),o(12),s(13,"sCurrency"),a()()),n&2){let e=t.$implicit,l=u(2);i(2),c("src",l.getProductImageSrc(e.product),H)("alt",e.product.basicDetails==null?null:e.product.basicDetails.productName),i(2),m(N(5,6,e.product.basicDetails.productName,"medium")),i(3),m(p(8,9,e.unitPrice)),i(3),m(e.quantity),i(2),m(p(13,11,e.subTotal))}}function un(n,t){n&1&&v(0,"tr")}function fn(n,t){if(n&1&&(r(0,"tr")(1,"td"),o(2),s(3,"translate"),a(),r(4,"td"),o(5),s(6,"sCurrency"),a()(),r(7,"tr")(8,"td"),o(9),s(10,"translate"),a(),r(11,"td"),o(12),s(13,"sCurrency"),a()(),r(14,"tr")(15,"td"),o(16),s(17,"translate"),a(),r(18,"td",13),o(19),s(20,"sCurrency"),a()()),n&2){let e=u(2);i(2),m(p(3,12,"SUB_TOTAL")),i(2),y(S(24,ft)),i(),m(p(6,14,e.sale.subTotal)),i(4),m(p(10,16,"DISCOUNT")),i(2),y(S(25,ft)),i(),m(p(13,18,e.sale.discount)),i(4),m(p(17,20,"GRAND_TOTAL")),i(2),y(S(26,ft)),i(),m(p(20,22,e.sale.grandTotal))}}function vn(n,t){if(n&1){let e=R();r(0,"div",10)(1,"div",11)(2,"div",12)(3,"span"),o(4),s(5,"translate"),a(),o(6,": "),r(7,"span",13),o(8),a()(),r(9,"p-button",14),s(10,"translate"),E("onClick",function(){I(e);let d=u();return h(d.printReceipt())}),a()(),r(11,"div",15)(12,"span",16),o(13),s(14,"translate"),a(),r(15,"span"),o(16),s(17,"dateFt"),a()(),r(18,"div",15),x(19,en,5,3,"div",17)(20,tn,5,3,"div",17)(21,nn,4,3,"div",18)(22,an,3,8,"a",19),a(),r(23,"div",20)(24,"div",21),o(25),s(26,"translate"),a(),r(27,"div",22),x(28,rn,6,6,"div",23)(29,on,5,4,"div",23)(30,ln,7,4,"div",23)(31,sn,5,4,"div",23)(32,pn,5,4,"div",23)(33,mn,5,4,"div",23),a()(),r(34,"div",24)(35,"div",21),o(36),s(37,"translate"),a(),r(38,"p-table",25),x(39,cn,13,24,"ng-template",null,0,C)(41,dn,14,13,"ng-template",null,1,C),a(),r(43,"div",26)(44,"p-table",25),x(45,un,1,0,"ng-template",null,0,C)(47,fn,21,27,"ng-template",null,1,C),a()()(),r(49,"div",15)(50,"span",16),o(51),s(52,"translate"),a(),r(53,"span"),o(54),a()(),r(55,"div",27),v(56,"ngx-barcode6",28),a()()}if(n&2){let e=u();i(4),m(p(5,29,"SALE_DETAILS")),i(4),m(" "+e.sale.barcode+" "),i(),c("pTooltip",p(10,31,"PRINT_RECEIPT"))("rounded",!0)("text",!0),i(4),m(p(14,33,"TIMESTAMP")+": "),i(3),m(N(17,35,e.sale.createdAt,"long")),i(3),c("ngIf",e.sale.totallyReturned),i(),c("ngIf",e.sale.partiallyReturned),i(),c("ngIf",!e.sale.partiallyReturned&&!e.sale.totallyReturned),i(),c("ngIf",e.sale.totallyReturned||e.sale.partiallyReturned),i(3),f(" ",p(26,38,"CUSTOMER_DETAILS")," "),i(3),c("ngIf",!e.sale.customer),i(),c("ngIf",e.sale.customer),i(),c("ngIf",e.sale.customer),i(),c("ngIf",e.sale.customer&&e.sale.customer.country),i(),c("ngIf",e.sale.customer&&e.sale.customer.address),i(),c("ngIf",e.sale.customer&&e.sale.customer.email),i(3),f(" ",p(37,40,"ORDER_DETAILS")," "),i(2),c("value",e.sale.saleItems)("tableStyle",S(44,Kt)),i(6),c("value",S(45,Yi))("tableStyle",S(46,Kt)),i(7),m(p(52,42,"SOLD_BY")+": "),i(3),m(e.sale.createdBy),i(2),c("bc-width",3)("bc-format","CODE128")("bc-value",e.sale.barcode)("bc-display-value",!0)}}var ot=class n{constructor(t,e,l){this.saleService=t;this.route=e;this.router=l}sale;loading=!1;ngOnInit(){this.fetchSaleDetails()}fetchSaleDetails(){this.loading=!0;let t=this.route.snapshot.paramMap.get("saleId");if(t){let e=Number.parseInt(t);e&&Number.isInteger(e)&&this.saleService.getSaleById(e).subscribe(l=>{l.success?this.sale=l.data:this.router.navigate(["/notfound"]),this.loading=!1})}}printReceipt(){this.saleService.previewSaleReceipt(this.sale)}getProductImageSrc(t){return j.getFirstImageSrc(t)}static \u0275fac=function(e){return new(e||n)(g(U),g(re),g(z))};static \u0275cmp=w({type:n,selectors:[["app-sale-details"]],decls:3,vars:2,consts:[["header",""],["body",""],["class","loading",4,"ngIf"],["class","details",4,"ngIf"],[1,"loading"],["styleClass","mb-2"],["width","10rem","styleClass","mb-2"],["width","5rem","styleClass","mb-2"],["height","2rem","styleClass","mb-2"],["width","10rem","height","4rem"],[1,"details"],[1,"font-bold","text-lg","mb-4","flex","justify-between"],[1,"header"],[1,"text-primary"],["tooltipPosition","top","icon","pi pi-print","severity","success",3,"onClick","pTooltip","rounded","text"],[1,"mb-4"],[1,"font-md","text-muted-color"],["class","flex gap-2 mb-2",4,"ngIf"],["class","flex gap-2",4,"ngIf"],["class"," hover:underline",3,"routerLink","queryParams",4,"ngIf"],[1,"sale-customer","mb-4"],[1,"font-md","mb-2","text-muted-color"],[1,"ml-2","text-sm"],["class","mb-1",4,"ngIf"],[1,"order-summary","mb-4"],[3,"value","tableStyle"],[1,"mt-6"],[1,"flex","justify-center","w-full"],[3,"bc-width","bc-format","bc-value","bc-display-value"],[1,"flex","gap-2","mb-2"],[1,"pi","pi-arrow-right-arrow-left","text-muted-color"],[1,"text-red-500"],[1,"text-orange-500"],[1,"flex","gap-2"],[1,"text-blue-500","dark:text-blue-300"],[1,"hover:underline",3,"routerLink","queryParams"],[1,"mb-1"],[1,"dark:text-primary-200","flex","gap-2","items-center"],[1,"rounded","w-full",2,"width","3rem","height","3rem","object-fit","cover",3,"src","alt"]],template:function(e,l){e&1&&(r(0,"p-card"),x(1,Zi,6,0,"div",2)(2,vn,57,47,"div",3),a()),e&2&&(i(),c("ngIf",l.loading),i(),c("ngIf",!l.loading))},dependencies:[L,k,T,O,P,X,J,M,ie,te,A,he,Ye,B,D,Z,K,le,Y,xe,q,F,oe],encapsulation:2})};var pe=class n{constructor(t){this.http=t}baseUrl=Fe.apiBaseUrl+"/sale-return";createSaleReturn(t){return this.http.post(this.baseUrl,t)}getSaleReturnsPage(t){return this.http.get(`${this.baseUrl}?page=${t.page}&size=${t.size}`)}getSaleReturnById(t){return this.http.get(`${this.baseUrl}/${t}`)}getSaleReturnsBySaleId(t,e){return this.http.get(`${this.baseUrl}/sale/${t}?page=${e.page}&size=${e.size}`)}deleteSaleReturn(t){return this.http.delete(`${this.baseUrl}/${t}`)}static \u0275fac=function(e){return new(e||n)(Be(Le))};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})};var _n=()=>["barcode","customer.fullName","createdBy"],Sn=()=>({"min-width":"75rem"}),gn=()=>[10,20,30],xn=()=>({width:"450px"});function In(n,t){if(n&1&&(r(0,"div",10),v(1,"p-button",11),s(2,"translate"),v(3,"p-button",12),s(4,"translate"),a()),n&2){let e=u();i(),c("label",p(2,3,"ADD")),i(2),c("label",p(4,5,"DELETE"))("disabled",!e.selectedSales||!e.selectedSales.length)}}function hn(n,t){n&1&&(v(0,"p-button",13),s(1,"translate")),n&2&&c("label",p(1,1,"EXPORT"))}function Cn(n,t){if(n&1){let e=R();r(0,"div",14)(1,"h5",15),o(2),a(),r(3,"p-iconfield"),v(4,"p-inputicon",16),r(5,"input",17),s(6,"translate"),E("input",function(d){I(e);let _=u(),b=de(6);return h(_.onGlobalFilter(b,d))}),a()()()}if(n&2){let e=u();i(2),m(e.tableHeader),i(3),c("placeholder",p(6,2,"SEARCH_PACEHOLDER"))}}function bn(n,t){n&1&&(r(0,"tr")(1,"th",18),v(2,"p-tableHeaderCheckbox"),a(),r(3,"th"),o(4),s(5,"translate"),a(),r(6,"th",19),o(7),s(8,"translate"),v(9,"p-sortIcon",20),a(),r(10,"th",21),o(11),s(12,"translate"),v(13,"p-sortIcon",22),a(),r(14,"th",23),o(15),s(16,"translate"),v(17,"p-sortIcon",24),a(),r(18,"th",25),o(19),s(20,"translate"),v(21,"p-sortIcon",26),a(),r(22,"th",27),o(23),s(24,"translate"),v(25,"p-sortIcon",28),a(),r(26,"th",29),o(27),s(28,"translate"),v(29,"p-sortIcon",30),a(),r(30,"th",31),o(31),s(32,"translate"),v(33,"p-sortIcon",32),a(),r(34,"th"),o(35),s(36,"translate"),a()()),n&2&&(i(4),f(" ",p(5,9,"BARCODE")," "),i(3),f(" ",p(8,11,"DATE")," "),i(4),f(" ",p(12,13,"CUSTOMER")," "),i(4),f(" ",p(16,15,"SUB_TOTAL")," "),i(4),f(" ",p(20,17,"EXTRA_FEES")," "),i(4),f(" ",p(24,19,"TOTAL_REFUND")," "),i(4),f(" ",p(28,21,"CREATED_BY")," "),i(4),f(" ",p(32,23,"SALE")," "),i(4),m(p(36,25,"OPTIONS")))}function yn(n,t){if(n&1){let e=R();r(0,"tr")(1,"td"),v(2,"p-tableCheckbox",33),a(),r(3,"td")(4,"a",34),E("click",function(){let d=I(e).$implicit,_=u();return h(_.showDetails(d))}),o(5),a()(),r(6,"td"),o(7),s(8,"dateFt"),a(),r(9,"td"),o(10),a(),r(11,"td"),o(12),s(13,"sCurrency"),a(),r(14,"td"),o(15),s(16,"sCurrency"),a(),r(17,"td",35),o(18),s(19,"sCurrency"),a(),r(20,"td"),o(21),a(),r(22,"td",36),o(23),a(),r(24,"td"),v(25,"p-menu",37,6),r(27,"button",38),E("click",function(d){let _=I(e).$implicit,b=de(26);return u().getMenuItems(_),h(b.toggle(d))}),a()()()}if(n&2){let e=t.$implicit,l=u();i(2),c("value",e),i(3),m(e.barcode),i(2),f(" ",N(8,11,e.returnDate,"long")," "),i(3),f(" ",e.sale==null||e.sale.customer==null?null:e.sale.customer.fullName," "),i(2),f(" ",p(13,14,e.subTotal)," "),i(3),f(" ",p(16,16,e.feesAmount)," "),i(3),f(" ",p(19,18,e.totalAmount)," "),i(3),f(" ",e.returnedBy," "),i(2),f(" ",e.sale.barcode," "),i(2),c("popup",!0)("model",l.menuItems)}}var Pe=class n{constructor(t,e,l,d,_,b,ut){this.saleReturnService=t;this.saleService=e;this.translate=l;this.confirmService=d;this.toast=_;this.route=b;this.router=ut}loading=!1;pageReq=new me(0,10);pageDetails;returnList=[];sale;selectedSales;cols;tableHeader="";mode;menuItems=[];ngOnInit(){this.fetchSaleDetails(),this.tableHeader=this.translate.instant("SALE_RETURN_LIST")}getSaleReturnsPage(){this.loading=!0,this.sale&&this.sale.saleId?this.saleReturnService.getSaleReturnsBySaleId(this.sale.saleId,this.pageReq).subscribe(t=>{t.success&&(this.returnList=t.data.content,this.pageDetails=t.data.page,this.loading=!1)}):this.saleReturnService.getSaleReturnsPage(this.pageReq).subscribe(t=>{t.success&&(this.returnList=t.data.content,this.pageDetails=t.data.page,this.loading=!1)})}onPageChange(t){this.pageReq.page=t.page,this.pageReq.size=t.rows,this.getSaleReturnsPage()}onGlobalFilter(t,e){t.filterGlobal(e.target.value,"contains")}getMenuItems(t){this.menuItems=[{label:this.translate.instant("SHOW_DETAILS"),icon:"pi pi-eye",command:()=>{this.showDetails(t)}},{label:this.translate.instant("EDIT"),icon:"pi pi-pencil",command:()=>{}},{label:this.translate.instant("DELETE"),icon:"pi pi-trash",command:()=>{this.deleteSaleReturn(t)}}]}deleteSaleReturn(t){let e=this.translate.instant("DELETE_ALERT",{name:t.barcode});this.confirmService.dialogAlert(e,()=>{this.saleReturnService.deleteSaleReturn(t.saleReturnId).subscribe(l=>{l.success?(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.getSaleReturnsPage()):this.toast.showError(l.message)})})}fetchSaleDetails(){this.loading=!0;let t=this.route.snapshot.queryParamMap.get("saleId");if(t){let e=Number.parseInt(t);e&&Number.isInteger(e)&&this.saleService.getSaleById(e).subscribe(l=>{l.success?(this.sale=l.data,this.tableHeader=this.translate.instant("ALL_SALE_RETURNS",{name:this.sale.barcode}),this.getSaleReturnsPage()):this.router.navigate(["/notfound"]),this.loading=!1})}else this.getSaleReturnsPage()}saleDetails(t){this.router.navigate(["sales/detail",t.saleId])}saleReturn(t){this.router.navigate(["sales/sale-return",t.saleId])}showDetails(t){this.router.navigate(["/sales/sale-return/detail",t.saleReturnId])}static \u0275fac=function(e){return new(e||n)(g(pe),g(U),g(G),g(Ie),g(ne),g(re),g(z))};static \u0275cmp=w({type:n,selectors:[["app-sale-return-list"]],decls:16,vars:20,consts:[["start",""],["end",""],["dt",""],["caption",""],["header",""],["body",""],["menu",""],["styleClass","mb-6"],["dataKey","saleId",3,"selectionChange","value","rows","columns","loading","globalFilterFields","tableStyle","selection","rowHover"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords}",3,"onPageChange","first","rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","showJumpToPageDropdown"],[1,"flex","items-center","gap-2"],["icon","pi pi-plus","severity","secondary",1,"mr-2",3,"label"],["severity","secondary","icon","pi pi-trash","outlined","",3,"label","disabled"],["icon","pi pi-upload","severity","secondary",3,"label"],[1,"flex","items-center","justify-between"],[1,"m-0"],["styleClass","pi pi-search"],["pInputText","","type","text",3,"input","placeholder"],[2,"width","3rem"],["pSortableColumn","returnDate"],["field","returnDate"],["pSortableColumn","sale.customer.fullName"],["field","sale.customer.fullName"],["pSortableColumn","subTotal"],["field","subTotal"],["pSortableColumn","feesAmount"],["field","feesAmount"],["pSortableColumn","totalAmount"],["field","totalAmount"],["pSortableColumn","returnedBy"],["field","returnedBy"],["pSortableColumn","sale.saleId"],["field","sale.saleId"],[3,"value"],[1,"text-primary","cursor-pointer","hover:underline",3,"click"],[1,"text-orange-500"],[1,"text-primary"],["appendTo","body",3,"popup","model"],["pButton","","icon","pi pi-ellipsis-v",1,"p-button-text",3,"click"]],template:function(e,l){if(e&1){let d=R();r(0,"p-toolbar",7),x(1,In,5,7,"ng-template",null,0,C)(3,hn,2,3,"ng-template",null,1,C),a(),r(5,"p-table",8,2),Q("selectionChange",function(b){return I(d),$(l.selectedSales,b)||(l.selectedSales=b),h(b)}),x(7,Cn,7,4,"ng-template",null,3,C)(9,bn,37,27,"ng-template",null,4,C)(11,yn,28,20,"ng-template",null,5,C),a(),r(13,"p-paginator",9),E("onPageChange",function(b){return I(d),h(l.onPageChange(b))}),a(),v(14,"p-confirmdialog")(15,"p-toast")}e&2&&(i(5),c("value",l.returnList)("rows",10)("columns",l.cols)("loading",l.loading)("globalFilterFields",S(16,_n))("tableStyle",S(17,Sn)),W("selection",l.selectedSales),c("rowHover",!0),i(8),c("first",l.pageReq.page*l.pageReq.size)("rows",l.pageReq.size)("totalRecords",(l.pageDetails==null?null:l.pageDetails.totalElements)||0)("rowsPerPageOptions",S(18,gn))("showCurrentPageReport",!0)("showJumpToPageDropdown",!1),i(),y(S(19,xn)))},dependencies:[T,Z,K,Ve,Ue,qe,je,P,L,Se,k,He,ee,M,_e,$e,We,Qe,se,B,D,fe,ve,Oe,ge,A,F,q],encapsulation:2})};var lt=class{sale;returnItems;subTotal;feesAmount;totalAmount;constructor(t){this.sale=t,this.feesAmount=0,this.subTotal=0,this.totalAmount=0,this.returnItems=t.saleItems.map(e=>new st(e,0))}fillCart(t){this.returnItems=t.saleItems.map(e=>new st(e,e.quantity-e.returnedQuantity)),this.updateAmount()}increaseItemQty(t){let e=this.returnItems.find(l=>l.saleItem.saleItemId==t.saleItem.saleItemId);e&&e.quantity<e.saleItem.quantity-e.saleItem.returnedQuantity&&(e.quantity++,this.updateAmount())}decreaseItemQty(t){let e=this.returnItems.find(l=>l.saleItem.saleItemId==t.saleItem.saleItemId);e&&e.quantity>0&&(e.quantity--,this.updateAmount())}updateAmount(){let t=0;this.returnItems.forEach(e=>{t+=e.quantity*e.saleItem.unitPrice}),this.subTotal=t,this.totalAmount=this.subTotal-this.feesAmount}},st=class{saleItem;quantity;constructor(t,e){this.saleItem=t,this.quantity=e}};var pt=class{saleId;returnItems;feesAmount;constructor(t){this.saleId=t.sale.saleId,this.feesAmount=t.feesAmount,this.returnItems=t.returnItems.filter(e=>e.quantity>0).map(e=>new _t(e))}},_t=class{saleItemId;quantity;constructor(t){this.saleItemId=t.saleItem.saleItemId,this.quantity=t.quantity}};var En=()=>({width:"450px"}),ei=()=>({"min-width":"50rem"}),Rn=()=>[1],Tn=()=>({width:"100%"}),wn=()=>({width:"30%"}),Pn=()=>({width:"20%"}),ti=()=>({width:"25%"}),Dn=()=>({width:"3rem"}),St=()=>({width:"50%"});function Bn(n,t){n&1&&(r(0,"div",6),v(1,"p-skeleton",7)(2,"p-skeleton",8)(3,"p-skeleton",9)(4,"p-skeleton",10)(5,"p-skeleton",11),a())}function Mn(n,t){n&1&&(r(0,"div",30)(1,"span"),o(2),s(3,"translate"),a(),o(4),s(5,"translate"),a()),n&2&&(i(2),m(p(3,2,"NAME")),i(2),f(": ",p(5,4,"NOT_REGISTERED_CUSTOMER")," "))}function An(n,t){if(n&1&&(r(0,"div",30)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"NAME")),i(2),f(": ",e.sale.customer.fullName," ")}}function Ln(n,t){if(n&1&&(r(0,"div",30)(1,"span"),o(2),s(3,"translate"),a(),o(4,": "),r(5,"span",20),o(6),a()()),n&2){let e=u(2);i(2),m(p(3,2,"PHONE")),i(4),m(e.sale.customer.phone)}}function Nn(n,t){if(n&1&&(r(0,"div",30)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"COUNTRY")),i(2),f(": ",e.sale.customer.country," ")}}function Fn(n,t){if(n&1&&(r(0,"div",30)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"ADDRESS")),i(2),f(": ",e.sale.customer.address," ")}}function On(n,t){if(n&1&&(r(0,"div",30)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"EMAIL")),i(2),f(": ",e.sale.customer.email," ")}}function kn(n,t){n&1&&(r(0,"tr")(1,"th"),o(2),s(3,"translate"),a(),r(4,"th"),o(5),s(6,"translate"),a(),r(7,"th"),o(8),s(9,"translate"),a(),r(10,"th"),o(11),s(12,"translate"),a()()),n&2&&(i(2),m(p(3,4,"PRODUCT")),i(3),m(p(6,6,"UNIT_PRICE")),i(3),m(p(9,8,"QUANTITY_TO_RETURN")),i(3),m(p(12,10,"SUB_TOTAL")))}function Vn(n,t){if(n&1){let e=R();r(0,"span",35),E("click",function(){I(e);let d=u().$implicit,_=u(2);return h(_.returnCart.increaseItemQty(d))}),v(1,"span",36),a()}}function Un(n,t){if(n&1){let e=R();r(0,"span",35),E("click",function(){I(e);let d=u().$implicit,_=u(2);return h(_.returnCart.decreaseItemQty(d))}),v(1,"span",37),a()}}function qn(n,t){if(n&1){let e=R();r(0,"tr")(1,"td",31)(2,"div",32),v(3,"img",33),r(4,"div"),o(5),s(6,"substring"),a()()(),r(7,"td"),o(8),s(9,"sCurrency"),a(),r(10,"td")(11,"p-inputnumber",34),Q("ngModelChange",function(d){let _=I(e).$implicit;return $(_.quantity,d)||(_.quantity=d),h(d)}),x(12,Vn,2,0,"ng-template",null,2,C)(14,Un,2,0,"ng-template",null,3,C),a()(),r(16,"td"),o(17),s(18,"sCurrency"),a()()}if(n&2){let e=t.$implicit,l=u(2);i(),y(S(24,wn)),i(2),c("src",l.getProductImageSrc(e.saleItem.product),H)("alt",e.saleItem.product.basicDetails==null?null:e.saleItem.product.basicDetails.productName),i(2),m(N(6,17,e.saleItem.product.basicDetails.productName,"medium")),i(2),y(S(25,Pn)),i(),m(p(9,20,e.saleItem.unitPrice)),i(2),y(S(26,ti)),i(),W("ngModel",e.quantity),c("max",e.saleItem.quantity-e.saleItem.returnedQuantity)("showButtons",!0)("inputStyle",S(27,Dn)),i(5),y(S(28,ti)),i(),m(p(18,22,e.quantity*e.saleItem.unitPrice))}}function jn(n,t){n&1&&v(0,"tr")}function Hn(n,t){if(n&1&&(r(0,"tr")(1,"td"),o(2),s(3,"translate"),a(),r(4,"td"),o(5),s(6,"sCurrency"),a()(),r(7,"tr")(8,"td"),o(9),s(10,"translate"),a(),r(11,"td"),o(12),s(13,"sCurrency"),a()(),r(14,"tr")(15,"td"),o(16),s(17,"translate"),a(),r(18,"td",20),o(19),s(20,"sCurrency"),a()()),n&2){let e=u(2);i(2),m(p(3,12,"SUB_TOTAL")),i(2),y(S(24,St)),i(),m(p(6,14,e.returnCart.subTotal)),i(4),m(p(10,16,"SALE_RETURN_FEES")),i(2),y(S(25,St)),i(),m(p(13,18,e.returnCart.feesAmount)),i(4),m(p(17,20,"TOTAL_REFUND")),i(2),y(S(26,St)),i(),m(p(20,22,e.returnCart.totalAmount))}}function Wn(n,t){if(n&1){let e=R();r(0,"div",12)(1,"div",13)(2,"div",14)(3,"span"),o(4),s(5,"translate"),a()(),r(6,"p-button",15),s(7,"translate"),E("onClick",function(){I(e);let d=u();return h(d.returnAll())}),bt(),r(8,"svg",16),v(9,"path",17),a()()(),yt(),r(10,"div",18)(11,"span",19),o(12),s(13,"translate"),a(),r(14,"span",20),o(15),a()(),r(16,"div",18)(17,"span",19),o(18),s(19,"translate"),a(),r(20,"span"),o(21),s(22,"dateFt"),a()(),r(23,"div",21)(24,"div",22),o(25),s(26,"translate"),a(),r(27,"div",23),x(28,Mn,6,6,"div",24)(29,An,5,4,"div",24)(30,Ln,7,4,"div",24)(31,Nn,5,4,"div",24)(32,Fn,5,4,"div",24)(33,On,5,4,"div",24),a()(),r(34,"div",18)(35,"span",19),o(36),s(37,"translate"),a(),r(38,"span"),o(39),a()(),r(40,"div",25)(41,"div",22),o(42),s(43,"translate"),a(),r(44,"p-table",26),x(45,kn,13,12,"ng-template",null,0,C)(47,qn,19,29,"ng-template",null,1,C),a(),r(49,"div",27)(50,"p-table",26),x(51,jn,1,0,"ng-template",null,0,C)(53,Hn,21,27,"ng-template",null,1,C),a()()(),r(55,"div",28)(56,"p-button",29),s(57,"translate"),E("onClick",function(){I(e);let d=u();return h(d.submitSaleReturn())}),a()()()}if(n&2){let e=u();i(4),m(p(5,26,"PRODUCTS_RETURN_REQUEST")),i(2),c("pTooltip",p(7,28,"RETURN_ALL"))("rounded",!0)("text",!0),i(6),m(p(13,30,"SALE")+": "),i(3),m(" "+e.sale.barcode+" "),i(3),m(p(19,32,"TIMESTAMP")+": "),i(3),m(N(22,34,e.sale.createdAt,"long")),i(4),f(" ",p(26,37,"CUSTOMER_DETAILS")," "),i(3),c("ngIf",!e.sale.customer),i(),c("ngIf",e.sale.customer),i(),c("ngIf",e.sale.customer),i(),c("ngIf",e.sale.customer&&e.sale.customer.country),i(),c("ngIf",e.sale.customer&&e.sale.customer.address),i(),c("ngIf",e.sale.customer&&e.sale.customer.email),i(3),m(p(37,39,"SOLD_BY")+": "),i(3),m(e.sale.createdBy),i(3),f(" ",p(43,41,"ORDER_DETAILS")," "),i(2),c("value",e.returnCart.returnItems)("tableStyle",S(45,ei)),i(6),c("value",S(46,Rn))("tableStyle",S(47,ei)),i(6),y(S(48,Tn)),c("loading",e.submitLoading)("label",p(57,43,"SUBMIT_RETURN_ORDER"))}}var mt=class n{constructor(t,e,l,d,_,b,ut){this.saleService=t;this.saleReturnService=e;this.route=l;this.toast=d;this.translate=_;this.confirmService=b;this.router=ut}sale;loading=!1;returnCart;submitLoading=!1;ngOnInit(){this.fetchSaleDetails()}fetchSaleDetails(){this.loading=!0;let t=this.route.snapshot.paramMap.get("saleId");if(t){let e=Number.parseInt(t);e&&Number.isInteger(e)&&this.saleService.getSaleById(e).subscribe(l=>{l.success?(this.sale=l.data,this.returnCart=new lt(this.sale),console.log(this.sale)):this.router.navigate(["/notfound"]),this.loading=!1})}}submitSaleReturn(){let t=new pt(this.returnCart);if(!t.returnItems||!t.returnItems.length){this.toast.showWarn(this.translate.instant("EMPTY_SALE_RETURN_WARN_MSG"));return}this.submitLoading=!0,this.saleReturnService.createSaleReturn(t).subscribe(e=>{e.success?(this.toast.showSuccess(this.translate.instant("SAVE_SUCCESS")),this.fetchSaleDetails()):this.toast.showWarn(e.message),this.submitLoading=!1})}returnAll(){let t=this.translate.instant("RETURN_ALL_ALERT_MSG");this.confirmService.dialogAlert(t,()=>{this.returnCart.fillCart(this.sale),this.submitSaleReturn()})}getProductImageSrc(t){return j.getFirstImageSrc(t)}static \u0275fac=function(e){return new(e||n)(g(U),g(pe),g(re),g(ne),g(G),g(Ie),g(z))};static \u0275cmp=w({type:n,selectors:[["app-sale-return-create"]],decls:5,vars:5,consts:[["header",""],["body",""],["incrementbuttonicon",""],["decrementbuttonicon",""],["class","loading",4,"ngIf"],["class","details",4,"ngIf"],[1,"loading"],["styleClass","mb-2"],["width","10rem","styleClass","mb-2"],["width","5rem","styleClass","mb-2"],["height","2rem","styleClass","mb-2"],["width","10rem","height","4rem"],[1,"details"],[1,"font-bold","text-lg","mb-4","flex","justify-between"],[1,"header"],["tooltipPosition","top","severity","success",3,"onClick","pTooltip","rounded","text"],["xmlns","http://www.w3.org/2000/svg","width","1em","height","1em","viewBox","0 0 14 14"],["fill","currentColor","fill-rule","evenodd","d","M6.545.998a1 1 0 0 0 0 2h2.728a2.638 2.638 0 0 1 0 5.275H4.817V6.545a1 1 0 0 0-1.707-.707L.384 8.564a1 1 0 0 0-.22 1.09q.073.18.218.327l2.728 2.728a1 1 0 0 0 1.707-.707v-1.729h4.456a4.638 4.638 0 1 0 0-9.275z","clip-rule","evenodd"],[1,"mb-4"],[1,"font-md","text-surface-400"],[1,"text-primary"],[1,"sale-customer","mb-4"],[1,"font-md","mb-2","text-surface-400"],[1,"ml-2","text-sm"],["class","mb-1",4,"ngIf"],[1,"order-summary","mb-4"],[3,"value","tableStyle"],[1,"mt-6"],[1,"flex","justify-center","w-full"],[3,"onClick","loading","label"],[1,"mb-1"],[1,"dark:text-primary-200"],[1,"flex","items-center","gap-2"],[1,"rounded","w-full",2,"width","3rem","height","3rem","object-fit","cover",3,"src","alt"],["readonly","true","min","0","buttonLayout","horizontal","spinnerMode","horizontal",3,"ngModelChange","ngModel","max","showButtons","inputStyle"],[1,"w-full","h-full","flex","items-center","justify-center",3,"click"],[1,"pi","pi-plus"],[1,"pi","pi-minus"]],template:function(e,l){e&1&&(r(0,"p-card"),x(1,Bn,6,0,"div",4)(2,Wn,58,49,"div",5),a(),v(3,"p-toast")(4,"p-confirmdialog")),e&2&&(i(),c("ngIf",l.loading),i(),c("ngIf",!l.loading),i(2),y(S(4,En)))},dependencies:[L,k,T,O,P,ue,Ne,X,J,M,ie,te,A,he,B,D,Z,K,le,Y,xe,ke,ee,q,se],encapsulation:2})};var $n=n=>["/sales/detail",n],ii=()=>({"min-width":"50rem"}),Qn=()=>[1],zn=()=>({width:"30%"}),Yn=()=>({width:"20%"}),ni=()=>({width:"25%"}),gt=()=>({width:"50%"});function Gn(n,t){n&1&&(r(0,"div",4),v(1,"p-skeleton",5)(2,"p-skeleton",6)(3,"p-skeleton",7)(4,"p-skeleton",8)(5,"p-skeleton",9),a())}function Jn(n,t){n&1&&(r(0,"div",27)(1,"span"),o(2),s(3,"translate"),a(),o(4),s(5,"translate"),a()),n&2&&(i(2),m(p(3,2,"NAME")),i(2),f(": ",p(5,4,"NOT_REGISTERED_CUSTOMER")," "))}function Xn(n,t){if(n&1&&(r(0,"div",27)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"NAME")),i(2),f(": ",e.saleReturn.sale.customer.fullName," ")}}function Kn(n,t){if(n&1&&(r(0,"div",27)(1,"span"),o(2),s(3,"translate"),a(),o(4,": "),r(5,"span",13),o(6),a()()),n&2){let e=u(2);i(2),m(p(3,2,"PHONE")),i(4),m(e.saleReturn.sale.customer.phone)}}function Zn(n,t){if(n&1&&(r(0,"div",27)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"COUNTRY")),i(2),f(": ",e.saleReturn.sale.customer.country," ")}}function ea(n,t){if(n&1&&(r(0,"div",27)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"ADDRESS")),i(2),f(": ",e.saleReturn.sale.customer.address," ")}}function ta(n,t){if(n&1&&(r(0,"div",27)(1,"span"),o(2),s(3,"translate"),a(),o(4),a()),n&2){let e=u(2);i(2),m(p(3,2,"EMAIL")),i(2),f(": ",e.saleReturn.sale.customer.email," ")}}function ia(n,t){n&1&&(r(0,"tr")(1,"th"),o(2),s(3,"translate"),a(),r(4,"th"),o(5),s(6,"translate"),a(),r(7,"th"),o(8),s(9,"translate"),a(),r(10,"th"),o(11),s(12,"translate"),a()()),n&2&&(i(),y(S(20,zn)),i(),m(p(3,12,"PRODUCT")),i(2),y(S(21,Yn)),i(),m(p(6,14,"UNIT_PRICE")),i(2),y(S(22,ni)),i(),m(p(9,16,"RETURNED_QUANTITY")),i(2),y(S(23,ni)),i(),m(p(12,18,"SUB_TOTAL")))}function na(n,t){if(n&1&&(r(0,"tr")(1,"td",28),v(2,"img",29),o(3),s(4,"substring"),a(),r(5,"td"),o(6),s(7,"sCurrency"),a(),r(8,"td"),o(9),a(),r(10,"td"),o(11),s(12,"sCurrency"),a()()),n&2){let e=t.$implicit,l=u(2);i(2),c("src",l.getProductImageSrc(e.saleItem.product),H)("alt",e.saleItem.product.basicDetails==null?null:e.saleItem.product.basicDetails.productName),i(),f(" ",N(4,6,e.saleItem.product.basicDetails.productName,"medium")," "),i(3),m(p(7,9,e.saleItem.unitPrice)),i(3),m(e.quantity),i(2),m(p(12,11,e.subTotal))}}function aa(n,t){n&1&&v(0,"tr")}function ra(n,t){if(n&1&&(r(0,"tr")(1,"td"),o(2),s(3,"translate"),a(),r(4,"td"),o(5),s(6,"sCurrency"),a()(),r(7,"tr")(8,"td"),o(9),s(10,"translate"),a(),r(11,"td"),o(12),s(13,"sCurrency"),a()(),r(14,"tr")(15,"td"),o(16),s(17,"translate"),a(),r(18,"td",13),o(19),s(20,"sCurrency"),a()()),n&2){let e=u(2);i(2),m(p(3,12,"GRAND_TOTAL")),i(2),y(S(24,gt)),i(),m(p(6,14,e.saleReturn.subTotal)),i(4),m(p(10,16,"EXTRA_FEES")),i(2),y(S(25,gt)),i(),m(p(13,18,e.saleReturn.feesAmount)),i(4),m(p(17,20,"TOTAL_REFUND")),i(2),y(S(26,gt)),i(),m(p(20,22,e.saleReturn.totalAmount))}}function oa(n,t){if(n&1&&(r(0,"div",10)(1,"div",11)(2,"div",12)(3,"span"),o(4),s(5,"translate"),a(),o(6,": "),r(7,"span",13),o(8),a()(),v(9,"p-button",14),s(10,"translate"),a(),r(11,"div",15)(12,"span",16),o(13),s(14,"translate"),a(),r(15,"span"),o(16),s(17,"dateFt"),a()(),r(18,"div",15)(19,"span",16),o(20),s(21,"translate"),a(),r(22,"a",17),o(23),a()(),r(24,"div",18)(25,"div",19),o(26),s(27,"translate"),a(),r(28,"div",20),x(29,Jn,6,6,"div",21)(30,Xn,5,4,"div",21)(31,Kn,7,4,"div",21)(32,Zn,5,4,"div",21)(33,ea,5,4,"div",21)(34,ta,5,4,"div",21),a()(),r(35,"div",22)(36,"div",19),o(37),s(38,"translate"),a(),r(39,"p-table",23),x(40,ia,13,24,"ng-template",null,0,C)(42,na,13,13,"ng-template",null,1,C),a(),r(44,"div",24)(45,"p-table",23),x(46,aa,1,0,"ng-template",null,0,C)(48,ra,21,27,"ng-template",null,1,C),a()()(),r(50,"div",15)(51,"span",16),o(52),s(53,"translate"),a(),r(54,"span"),o(55),a()(),r(56,"div",25),v(57,"ngx-barcode6",26),a()()),n&2){let e=u();i(4),m(p(5,28,"SALE_RETURN_DETAILS")),i(4),m(" "+e.saleReturn.barcode+" "),i(),c("pTooltip",p(10,30,"PRINT_RECEIPT"))("rounded",!0)("text",!0),i(4),m(p(14,32,"TIMESTAMP")+": "),i(3),m(N(17,34,e.saleReturn.returnDate,"long")),i(4),m(p(21,37,"SALE")+": "),i(2),c("routerLink",ae(45,$n,e.saleReturn.sale.saleId)),i(),m(e.saleReturn.sale.barcode),i(3),f(" ",p(27,39,"CUSTOMER_DETAILS")," "),i(3),c("ngIf",!e.saleReturn.sale.customer),i(),c("ngIf",e.saleReturn.sale.customer),i(),c("ngIf",e.saleReturn.sale.customer),i(),c("ngIf",e.saleReturn.sale.customer&&e.saleReturn.sale.customer.country),i(),c("ngIf",e.saleReturn.sale.customer&&e.saleReturn.sale.customer.address),i(),c("ngIf",e.saleReturn.sale.customer&&e.saleReturn.sale.customer.email),i(3),f(" ",p(38,41,"ORDER_DETAILS")," "),i(2),c("value",e.saleReturn.returnItems)("tableStyle",S(47,ii)),i(6),c("value",S(48,Qn))("tableStyle",S(49,ii)),i(7),m(p(53,43,"RETURNED_BY")+": "),i(3),m(e.saleReturn.returnedBy),i(2),c("bc-width",3)("bc-format","CODE128")("bc-value",e.saleReturn.barcode)("bc-display-value",!0)}}var ct=class n{constructor(t,e,l){this.saleReturnService=t;this.route=e;this.router=l}saleReturn;loading=!1;ngOnInit(){this.fetchSaleDetails()}fetchSaleDetails(){this.loading=!0;let t=this.route.snapshot.paramMap.get("saleReturnId");if(t){let e=Number.parseInt(t);e&&Number.isInteger(e)&&this.saleReturnService.getSaleReturnById(e).subscribe(l=>{l.success?this.saleReturn=l.data:this.router.navigate(["/notfound"]),console.log(l),this.loading=!1})}}getProductImageSrc(t){return j.getFirstImageSrc(t)}static \u0275fac=function(e){return new(e||n)(g(pe),g(re),g(z))};static \u0275cmp=w({type:n,selectors:[["app-sale-return-details"]],decls:3,vars:2,consts:[["header",""],["body",""],["class","loading",4,"ngIf"],["class","details",4,"ngIf"],[1,"loading"],["styleClass","mb-2"],["width","10rem","styleClass","mb-2"],["width","5rem","styleClass","mb-2"],["height","2rem","styleClass","mb-2"],["width","10rem","height","4rem"],[1,"details"],[1,"font-bold","text-lg","mb-4","flex","justify-between"],[1,"header"],[1,"text-primary"],["tooltipPosition","top","icon","pi pi-print","severity","success",3,"pTooltip","rounded","text"],[1,"mb-4"],[1,"font-md","text-muted-color"],[1,"text-primary","hover:underline",3,"routerLink"],[1,"sale-customer","mb-4"],[1,"font-md","mb-2","text-muted-color"],[1,"ml-2","text-sm"],["class","mb-1",4,"ngIf"],[1,"order-summary","mb-4"],[3,"value","tableStyle"],[1,"mt-6"],[1,"flex","justify-center","w-full"],[3,"bc-width","bc-format","bc-value","bc-display-value"],[1,"mb-1"],[1,"dark:text-primary-200","flex","items-center","gap-2"],[1,"rounded","w-full",2,"width","3rem","height","3rem","object-fit","cover",3,"src","alt"]],template:function(e,l){e&1&&(r(0,"p-card"),x(1,Gn,6,0,"div",2)(2,oa,58,50,"div",3),a()),e&2&&(i(),c("ngIf",l.loading),i(),c("ngIf",!l.loading))},dependencies:[L,k,T,O,P,X,J,M,ie,te,A,he,Ye,B,D,Z,K,le,Y,xe,q,F,oe],encapsulation:2})};var la=[{path:"pos",component:nt},{path:"list",component:at},{path:"detail/:saleId",component:ot},{path:"sale-return",children:[{path:"list",component:Pe},{path:":saleId",component:Pe},{path:"create/:saleId",component:mt},{path:"detail/:saleReturnId",component:ct}]}],dt=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=Me({type:n});static \u0275inj=De({imports:[F.forChild(la),F]})};var ai=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=Me({type:n});static \u0275inj=De({imports:[T,dt]})};export{ai as SalesModule};
