import{a as d}from"./chunk-TGB364TN.js";import{g as u}from"./chunk-RL6IEZWP.js";import{b as p}from"./chunk-AQJP2JMO.js";import{U as c,Z as a}from"./chunk-HRECHPDI.js";var n=class extends Error{};n.prototype.name="InvalidTokenError";function g(r){return decodeURIComponent(atob(r).replace(/(.)/g,(e,t)=>{let o=t.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o}))}function f(r){let e=r.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return g(e)}catch{return atob(e)}}function l(r,e){if(typeof r!="string")throw new n("Invalid token specified: must be a string");e||(e={});let t=e.header===!0?0:1,o=r.split(".")[t];if(typeof o!="string")throw new n(`Invalid token specified: missing part #${t+1}`);let s;try{s=f(o)}catch(i){throw new n(`Invalid token specified: invalid base64 for part #${t+1} (${i.message})`)}try{return JSON.parse(s)}catch(i){throw new n(`Invalid token specified: invalid json for part #${t+1} (${i.message})`)}}var m=class r{constructor(e,t){this.router=e;this.http=t}baseUrl=d.apiBaseUrl+"/auth";getToken(){return sessionStorage.getItem("token")}signOut(){sessionStorage.removeItem("token"),this.redirectToLogin()}signIn(e){return this.http.post(`${this.baseUrl}/login`,e)}handleLoginSuccess(e){sessionStorage.setItem("token",e.token),this.router.navigate(["/"])}isLoggedIn(){return!!sessionStorage.getItem("token")}hasPermissions(e){let t=this.getToken();if(!t)return!1;try{let s=l(t)?.authorities?.split(",")||[];return e.every(i=>s.includes(i))}catch{return!1}}redirectToLogin(){this.router.navigate(["/auth/login"])}static \u0275fac=function(t){return new(t||r)(a(u),a(p))};static \u0275prov=c({token:r,factory:r.\u0275fac,providedIn:"root"})};export{m as a};
